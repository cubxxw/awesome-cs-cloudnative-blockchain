<template><div><h1 id="goè¯­è¨€ç²¾åº¦ä¸¢å¤±é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#goè¯­è¨€ç²¾åº¦ä¸¢å¤±é—®é¢˜" aria-hidden="true">#</a> Goè¯­è¨€ç²¾åº¦ä¸¢å¤±é—®é¢˜</h1>
<nav class="table-of-contents"><ul><li><router-link to="#é—®é¢˜æè¿°">é—®é¢˜æè¿°</router-link><ul><li><router-link to="#ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨-float64">ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨ float64ï¼Ÿ</router-link></li><li><router-link to="#ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨-big-rat">ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨ big.Ratï¼Ÿ</router-link></li><li><router-link to="#å‡ºç°åŸå› æ€»ç»“">å‡ºç°åŸå› æ€»ç»“</router-link></li></ul></li><li><router-link to="#è§£å†³æ–¹æ³•">è§£å†³æ–¹æ³•</router-link></li><li><router-link to="#å®Œç¾è§£å†³">å®Œç¾è§£å†³</router-link></li></ul></nav>
<p>[toc]</p>
<h2 id="é—®é¢˜æè¿°" tabindex="-1"><a class="header-anchor" href="#é—®é¢˜æè¿°" aria-hidden="true">#</a> é—®é¢˜æè¿°</h2>
<p><strong>åœ¨ä½¿ç”¨Goåšé¡¹ç›®çš„æ—¶å€™ï¼Œä¸€å®šè¦æ³¨æ„Goè¯­è¨€çš„ç²¾åº¦ä¸¢å¤±é—®é¢˜ï¼Œå¦‚ä¸‹ï¼š</strong></p>
<div class="language-go ext-go line-numbers-mode"><pre v-pre class="language-go"><code><span class="token punctuation">[</span>root@mail golang<span class="token punctuation">]</span># cat gofloat<span class="token punctuation">.</span><span class="token keyword">go</span> 
<span class="token comment">/*************************************************************************
    > File Name: gofloat.go
    > Author: smile
    > Mail: 3293172751nss@gmail.com 
    > Created Time: Wed 31 Aug 2022 05:43:18 PM CST
 ************************************************************************/</span>
<span class="token keyword">package</span> main
<span class="token keyword">import</span><span class="token punctuation">(</span>
    <span class="token string">"fmt"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token comment">//Goè¯­è¨€ç²¾åº¦ä¸¢å¤±é—®é¢˜</span>
    m1 <span class="token operator">:=</span> <span class="token number">8.3</span>
    m2 <span class="token operator">:=</span> <span class="token number">3.8</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"m1 - m2 = "</span><span class="token punctuation">,</span>m1 <span class="token operator">-</span> m2<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token punctuation">[</span>root@mail golang<span class="token punctuation">]</span># <span class="token keyword">go</span> run  gofloat<span class="token punctuation">.</span><span class="token keyword">go</span>
m1 <span class="token operator">-</span> m2 <span class="token operator">=</span>  <span class="token number">4.500000000000001</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p>å¯ä»¥çœ‹åˆ°è¾“å‡ºçš„<code v-pre>m1</code> - <code v-pre>m2</code> =  <code v-pre>4.500000000000001</code></p>
</blockquote>
<h3 id="ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨-float64" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨-float64" aria-hidden="true">#</a> ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨ float64ï¼Ÿ</h3>
<p>å› ä¸º float64ï¼ˆæˆ–ä»»ä½•äºŒè¿›åˆ¶æµ®ç‚¹ç±»å‹ï¼Œå®é™…ä¸Šï¼‰ä¸èƒ½<code v-pre>0.1</code>å‡†ç¡®åœ°è¡¨ç¤ºæ•°å­—ã€‚</p>
<p>è€ƒè™‘ä»¥ä¸‹ä»£ç ï¼šhttp://play.golang.org/p/TQBd4yJe6Bæ‚¨å¯èƒ½æœŸæœ›å®ƒæ‰“å°å‡ºæ¥<code v-pre>10</code>ï¼Œä½†å®é™…ä¸Šæ‰“å°å‡ºæ¥<code v-pre>9.999999999999831</code>ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œè¿™äº›å°é”™è¯¯çœŸçš„ä¼šåŠ èµ·æ¥ï¼</p>
<h3 id="ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨-big-rat" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨-big-rat" aria-hidden="true">#</a> ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨ big.Ratï¼Ÿ</h3>
<p>big.Rat é€‚åˆè¡¨ç¤ºæœ‰ç†æ•°ï¼Œä½† Decimal æ›´é€‚åˆè¡¨ç¤ºé‡‘é’±ã€‚ä¸ºä»€ä¹ˆï¼Ÿè¿™æ˜¯ä¸€ä¸ªï¼ˆäººä¸ºçš„ï¼‰ç¤ºä¾‹ï¼š</p>
<p>å‡è®¾ä½ ä½¿ç”¨ big.Ratï¼Œä½ æœ‰ä¸¤ä¸ªæ•°å­—ï¼Œx å’Œ yï¼Œéƒ½ä»£è¡¨ 1/3ï¼Œä½ æœ‰<code v-pre>z = 1 - x - y = 1/3</code>. å¦‚æœå°†æ¯ä¸€ä¸ªéƒ½æ‰“å°å‡ºæ¥ï¼Œåˆ™å­—ç¬¦ä¸²è¾“å‡ºå¿…é¡»åœ¨æŸå¤„åœæ­¢ï¼ˆä¸ºç®€å•èµ·è§ï¼Œå‡è®¾å®ƒåœæ­¢åœ¨ 3 ä¸ªåè¿›åˆ¶æ•°å­—å¤„ï¼‰ï¼Œå› æ­¤æ‚¨å°†å¾—åˆ° 0.333ã€0.333 å’Œ 0.333ã€‚ä½†æ˜¯å¦ä¸€ä¸ª 0.001 å»å“ªå„¿äº†ï¼Ÿ</p>
<p>è¿™æ˜¯ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼š<a href="http://play.golang.org/p/lCZZs0w9KE" target="_blank" rel="noopener noreferrer">http ğŸ˜•/play.golang.org/p/lCZZs0w9KE<ExternalLinkIcon/></a></p>
<p>ä½¿ç”¨ Decimalï¼Œæ‰“å°å‡ºæ¥çš„å­—ç¬¦ä¸²å‡†ç¡®åœ°è¡¨ç¤ºæ•°å­—ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ æœ‰<code v-pre>x = y = 1/3</code>ï¼ˆç²¾åº¦ä¸º 3ï¼‰ï¼Œå®ƒä»¬å®é™…ä¸Šå°†ç­‰äº 0.333ï¼Œå½“ä½ è¿™æ ·åšæ—¶<code v-pre>z = 1 - x - y</code>ï¼Œå®ƒä»¬<code v-pre>z</code>å°†ç­‰äº 0.334ã€‚æ²¡æœ‰é’±æ˜¯ä¸‹è½ä¸æ˜çš„ï¼</p>
<p>ä½ è¿˜æ˜¯è¦å°å¿ƒã€‚å¦‚æœæ‚¨æƒ³ä»¥<code v-pre>N</code>3 ç§æ–¹å¼æ‹†åˆ†æ•°å­—ï¼Œåˆ™ä¸èƒ½åªå‘é€<code v-pre>N/3</code>ç»™ä¸‰ä¸ªä¸åŒçš„äººã€‚ä½ å¿…é¡»é€‰æ‹©ä¸€ä¸ªå‘é€ <code v-pre>N - (2/3*N)</code>åˆ°ã€‚è¯¥äººå°†è·å¾—ä¸€åˆ†é’±çš„å‰©ä½™éƒ¨åˆ†ã€‚</p>
<p>ä½†æ˜¯ï¼Œä½¿ç”¨ Decimal æ¯”ä½¿ç”¨ big.Rat æ›´å®¹æ˜“å°å¿ƒã€‚</p>
<h3 id="å‡ºç°åŸå› æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#å‡ºç°åŸå› æ€»ç»“" aria-hidden="true">#</a> å‡ºç°åŸå› æ€»ç»“</h3>
<ul>
<li>
<p>å‡ºç°æµ®ç‚¹æ•°ä¸ç²¾ç¡®çš„åŸå› æ˜¯ï¼Œæµ®ç‚¹æ•°å‚¨å­˜è‡³å†…å­˜ä¸­æ—¶ï¼Œ2çš„-1ã€-2â€¦â€¦-næ¬¡æ–¹ä¸èƒ½ç²¾ç¡®è¡¨ç¤ºå°æ•°éƒ¨åˆ†ï¼Œæ‰€ä»¥å†æŠŠè¿™ä¸ªæ•°ä»åœ°å€ä¸­å–å‡ºæ¥è¿›è¡Œè®¡ç®—å°±å‡ºç°äº†åå·®ã€‚</p>
</li>
<li>
<p>ä¸æ˜¯æ‰€æœ‰çš„floatç›¸åŠ å‡ä¹˜é™¤éƒ½ä¸€å®šå‡ºç°åå·®ï¼Œå…·ä½“è¦æ ¹æ®golangå®ç°IEEE 754çš„æƒ…å†µå®šã€‚</p>
</li>
</ul>
<h2 id="è§£å†³æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#è§£å†³æ–¹æ³•" aria-hidden="true">#</a> è§£å†³æ–¹æ³•</h2>
<blockquote>
<p>ä½¿ç”¨ç¬¬ä¸‰æ–¹åŒ…æ¥è§£å†³ç²¾åº¦ä¸¢å¤±é—®é¢˜</p>
<ul>
<li><a href="https://github.com/shopspring/decimal" target="_blank" rel="noopener noreferrer">https://github.com/shopspring/decimal<ExternalLinkIcon/></a></li>
</ul>
</blockquote>
<p><strong>ç”¨æ³•</strong></p>
<div class="language-go ext-go line-numbers-mode"><pre v-pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"github.com/shopspring/decimal"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	price<span class="token punctuation">,</span> err <span class="token operator">:=</span> decimal<span class="token punctuation">.</span><span class="token function">NewFromString</span><span class="token punctuation">(</span><span class="token string">"136.02"</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	quantity <span class="token operator">:=</span> decimal<span class="token punctuation">.</span><span class="token function">NewFromInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>

	fee<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> decimal<span class="token punctuation">.</span><span class="token function">NewFromString</span><span class="token punctuation">(</span><span class="token string">".035"</span><span class="token punctuation">)</span>
	taxRate<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> decimal<span class="token punctuation">.</span><span class="token function">NewFromString</span><span class="token punctuation">(</span><span class="token string">".08875"</span><span class="token punctuation">)</span>

	subtotal <span class="token operator">:=</span> price<span class="token punctuation">.</span><span class="token function">Mul</span><span class="token punctuation">(</span>quantity<span class="token punctuation">)</span>

	preTax <span class="token operator">:=</span> subtotal<span class="token punctuation">.</span><span class="token function">Mul</span><span class="token punctuation">(</span>fee<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>decimal<span class="token punctuation">.</span><span class="token function">NewFromFloat</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

	total <span class="token operator">:=</span> preTax<span class="token punctuation">.</span><span class="token function">Mul</span><span class="token punctuation">(</span>taxRate<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>decimal<span class="token punctuation">.</span><span class="token function">NewFromFloat</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Subtotal:"</span><span class="token punctuation">,</span> subtotal<span class="token punctuation">)</span>                      <span class="token comment">// Subtotal: 408.06</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Pre-tax:"</span><span class="token punctuation">,</span> preTax<span class="token punctuation">)</span>                         <span class="token comment">// Pre-tax: 422.3421</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Taxes:"</span><span class="token punctuation">,</span> total<span class="token punctuation">.</span><span class="token function">Sub</span><span class="token punctuation">(</span>preTax<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token comment">// Taxes: 37.482861375</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Total:"</span><span class="token punctuation">,</span> total<span class="token punctuation">)</span>                            <span class="token comment">// Total: 459.824961375</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Tax rate:"</span><span class="token punctuation">,</span> total<span class="token punctuation">.</span><span class="token function">Sub</span><span class="token punctuation">(</span>preTax<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Div</span><span class="token punctuation">(</span>preTax<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Tax rate: 0.08875</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å®Œç¾è§£å†³" tabindex="-1"><a class="header-anchor" href="#å®Œç¾è§£å†³" aria-hidden="true">#</a> å®Œç¾è§£å†³</h2>
<div class="language-go ext-go line-numbers-mode"><pre v-pre class="language-go"><code><span class="token comment">/*
 * @Author: xiongxinwei 3293172751nss@gmail.com
 * @Date: 2022-08-31 17:58:18
 * @LastEditors: xiongxinwei 3293172751nss@gmail.com
 * @LastEditTime: 2022-08-31 17:58:35
 * @FilePath: \code\gofloat\gofloat.go
 * @Description: Goè¯­è¨€ç²¾åº¦ä¸¢å¤±é—®é¢˜
 */</span>
 <span class="token keyword">package</span> main

 <span class="token keyword">import</span> <span class="token punctuation">(</span>
	 <span class="token string">"fmt"</span>
 
	 <span class="token string">"github.com/shopspring/decimal"</span>
 <span class="token punctuation">)</span>
 
 <span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 
	 <span class="token comment">//Goè¯­è¨€ç²¾åº¦ä¸¢å¤±é—®é¢˜</span>
	 m1 <span class="token operator">:=</span> <span class="token number">8.3</span>
	 m2 <span class="token operator">:=</span> <span class="token number">3.8</span>
	 fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"m1 - m2 = "</span><span class="token punctuation">,</span> m1<span class="token operator">-</span>m2<span class="token punctuation">)</span>
 
	 <span class="token keyword">var</span> num1 <span class="token builtin">float64</span> <span class="token operator">=</span> <span class="token number">3.1</span>
	 <span class="token keyword">var</span> num2 <span class="token builtin">float64</span> <span class="token operator">=</span> <span class="token number">4.2</span>
	 d1 <span class="token operator">:=</span> decimal<span class="token punctuation">.</span><span class="token function">NewFromFloat</span><span class="token punctuation">(</span>num1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>decimal<span class="token punctuation">.</span><span class="token function">NewFromFloat</span><span class="token punctuation">(</span>num2<span class="token punctuation">)</span><span class="token punctuation">)</span>
	 fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"num1 - num2 = "</span><span class="token punctuation">,</span> d1<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç¼–è¯‘ï¼š</strong></p>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>PS D:\æ–‡æ¡£\git\Block_Chain\go-advancend\code\gofloat> go run .\gofloat.go
m1 - m2 =  4.500000000000001
num1 - num2 =  7.3
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></template>


