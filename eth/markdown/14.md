+ [author](http://nsddd.top)

# ç¬¬14èŠ‚ web3.js

<div><a href = '13.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—</a><a href = '15.md' style='float: right'>â¬‡ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div>
<br>

> â¤ï¸ğŸ’•ğŸ’•æ¬¢è¿æ¥åˆ°web3çš„æ•™ç¨‹ï¼Œåœ¨è¿™é‡Œï¼Œå°†ä¼šå­¦ä¹ åˆ°æ™ºèƒ½åˆçº¦ï¼ŒåŒºå—é“¾åº•å±‚åŸç†ï¼Œethå’Œbtcå­¦ä¹ ï¼Œweb3æˆ–å°†ä¼šé¢ è¦†ä¸–ç•ŒğŸ˜~Myblog:[http://nsddd.top](http://nsddd.top/)

---
[TOC]

## web3.js

`web3.js` æ˜¯ä¸€ç»„ä½¿ç”¨`HTTP`æˆ–`IPC`è¿æ¥æ¥å’Œæœ¬åœ°æˆ–è¿œç¨‹ä»¥å¤ªåŠèŠ‚ç‚¹è¿›è¡Œäº¤äº’çš„åº“ã€‚

 ğŸ’¡å¦‚æœæˆ‘ä»¬ä½¿ç”¨JavaScript æ¥å¼€å‘ `DApp`æ—¶ï¼Œå¾ˆå¤šæ—¶å€™éœ€è¦ä½¿ç”¨åˆ° `web3.js` ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨ [ethers.js](https://learnblockchain.cn/docs/ethers.js/) ï¼‰ã€‚

+ `web3.js`æ˜¯ä»¥å¤ªåŠå®˜æ–¹ç»´æŠ¤çš„
+ `ethers.js`æ˜¯æ°‘é—´å¼€å‘çš„



## Web3

Web3 æ˜¯ web3.js åº“çš„ä¸»ç±»ã€‚

```javascript
var Web3 = require('web3');

> Web3.utils
> Web3.version
> Web3.givenProvider
> Web3.providers
> Web3.modules
```



## Web3.modules

```javascript
Web3.modules
```

å°†è¿”å›æ‰€æœ‰ä¸»è¦å­æ¨¡å—ç±»çš„å¯¹è±¡ï¼Œä»¥ä¾¿èƒ½å¤Ÿæ‰‹åŠ¨å®ä¾‹åŒ–å®ƒä»¬ã€‚



### è¿”å›å€¼

+ `Object`: æ¨¡å—æ„é€ å‡½æ•°åˆ—è¡¨:

  `Eth` - `Constructor`: ä¸ä»¥å¤ªåŠç½‘ç»œäº¤äº’çš„ Eth æ¨¡å—ï¼ŒæŸ¥çœ‹ [web3.eth](https://learnblockchain.cn/docs/web3.js/web3-eth.html#eth) äº†è§£æ›´å¤šã€‚`Net` - `Constructor`: ä¸ç½‘ç»œå±æ€§è¿›è¡Œäº¤äº’çš„ Net æ¨¡å—ï¼ŒæŸ¥çœ‹ [web3.eth.net](https://learnblockchain.cn/docs/web3.js/web3-eth-net.html#eth-net) äº†è§£æ›´å¤šã€‚`Personal` - `Constructor`: ä¸ä»¥å¤ªåŠè´¦æˆ·äº¤äº’çš„ Personal æ¨¡å—ï¼ŒæŸ¥çœ‹ [web3.eth.personal](https://learnblockchain.cn/docs/web3.js/web3-eth-personal.html#eth-personal) äº†è§£æ›´å¤šã€‚`Shh` - `Constructor`: ä¸whisperåè®®äº¤äº’çš„ Shh æ¨¡å—ï¼ŒæŸ¥çœ‹ [web3.shh](https://learnblockchain.cn/docs/web3.js/web3-shh.html#shh) äº†è§£æ›´å¤šã€‚`Bzz` - `Constructor`: ä¸swarmç½‘ç»œäº¤äº’çš„ Bzz æ¨¡å—ï¼ŒæŸ¥çœ‹ [web3.bzz](https://learnblockchain.cn/docs/web3.js/web3-bzz.html#bzz) äº†è§£æ›´å¤šã€‚

  

### ä¾‹å­

```javascript
Web3.modules
> {
    Eth: Eth(provider),
    Net: Net(provider),
    Personal: Personal(provider),
    Shh: Shh(provider),
    Bzz: Bzz(provider),
}
```



## Web3 å®ä¾‹

Web3ç±»æ˜¯ä¸€ä¸ªâ€œä¼â€åŒ…ï¼Œåœ¨Web3ç±»ä¸‹åŒ…å«æ‰€æœ‰ä¸ä»¥å¤ªåŠç›¸å…³çš„æ¨¡å—ã€‚

```javascript
var Web3 = require('web3');

// åˆ›å»ºå®ä¾‹ï¼Œå¦‚æœåœ¨æ”¯æŒä»¥å¤ªåŠçš„æµè§ˆå™¨ "Web3.providers.givenProvider" ä¼šè¢«è®¾ç½®ã€‚
var web3 = new Web3(Web3.givenProvider || 'ws://some.local-or-remote.node:8546');

> web3.eth
> web3.shh
> web3.bzz
> web3.utils
> web3.version
```



## æ¡ˆä¾‹

```javascript
// ä¸‹é¢æ˜¯è°ƒç”¨åˆçº¦çš„æ–¹å¼:
var abi = /* abiæ˜¯ç”±ç¼–è¯‘å™¨ç”Ÿæˆçš„ */
var ZombieFactoryContract = web3.eth.contract(abi)
var contractAddress = /* å‘å¸ƒä¹‹ååœ¨ä»¥å¤ªåŠä¸Šç”Ÿæˆçš„åˆçº¦åœ°å€ */
var ZombieFactory = ZombieFactoryContract.at(contractAddress)
// `ZombieFactory` èƒ½è®¿é—®å…¬å…±çš„å‡½æ•°ä»¥åŠäº‹ä»¶

// æŸä¸ªç›‘å¬æ–‡æœ¬è¾“å…¥çš„ç›‘å¬å™¨:
$("#ourButton").click(function(e) {
  var name = $("#nameInput").val()
  //è°ƒç”¨åˆçº¦çš„ `createRandomZombie` å‡½æ•°:
  ZombieFactory.createRandomZombie(name)
})

// ç›‘å¬ `NewZombie` äº‹ä»¶, å¹¶ä¸”æ›´æ–°UI
var event = ZombieFactory.NewZombie(function(error, result) {
  if (error) return
  generateZombie(result.zombieId, result.name, result.dna)
})

// è·å– Zombie çš„ dna, æ›´æ–°å›¾åƒ
function generateZombie(id, name, dna) {
  let dnaStr = String(dna)
  // å¦‚æœdnaå°‘äº16ä½,åœ¨å®ƒå‰é¢ç”¨0è¡¥ä¸Š
  while (dnaStr.length < 16)
    dnaStr = "0" + dnaStr

  let zombieDetails = {
    // å‰ä¸¤ä½æ•°æ„æˆå¤´éƒ¨.æˆ‘ä»¬å¯èƒ½æœ‰7ç§å¤´éƒ¨, æ‰€ä»¥ % 7
    // å¾—åˆ°çš„æ•°åœ¨0-6,å†åŠ ä¸Š1,æ•°çš„èŒƒå›´å˜æˆ1-7
    // é€šè¿‡è¿™æ ·è®¡ç®—ï¼š
    headChoice: dnaStr.substring(0, 2) % 7 + 1ï¼Œ
    // æˆ‘ä»¬å¾—åˆ°çš„å›¾ç‰‡åç§°ä»head1.png åˆ° head7.png

    // æ¥ä¸‹æ¥çš„ä¸¤ä½æ•°æ„æˆçœ¼ç›, çœ¼ç›å˜åŒ–å°±å¯¹11å–æ¨¡:
    eyeChoice: dnaStr.substring(2, 4) % 11 + 1,
    // å†æ¥ä¸‹æ¥çš„ä¸¤ä½æ•°æ„æˆè¡£æœï¼Œè¡£æœå˜åŒ–å°±å¯¹6å–æ¨¡:
    shirtChoice: dnaStr.substring(4, 6) % 6 + 1,
    //æœ€å6ä½æ§åˆ¶é¢œè‰². ç”¨cssé€‰æ‹©å™¨: hue-rotateæ¥æ›´æ–°
    // 360åº¦:
    skinColorChoice: parseInt(dnaStr.substring(6, 8) / 100 * 360),
    eyeColorChoice: parseInt(dnaStr.substring(8, 10) / 100 * 360),
    clothesColorChoice: parseInt(dnaStr.substring(10, 12) / 100 * 360),
    zombieName: name,
    zombieDescription: "A Level 1 CryptoZombie",
  }
  return zombieDetails
}
```

> æˆ‘ä»¬çš„ JavaScript æ‰€åšçš„å°±æ˜¯è·å–ç”±`zombieDetails` äº§ç”Ÿçš„æ•°æ®, å¹¶ä¸”åˆ©ç”¨æµè§ˆå™¨é‡Œçš„ JavaScript ç¥å¥‡åŠŸèƒ½ (æˆ‘ä»¬ç”¨ Vue.js)ï¼Œç½®æ¢å‡ºå›¾åƒä»¥åŠä½¿ç”¨CSSè¿‡æ»¤å™¨ã€‚åœ¨åé¢çš„è¯¾ç¨‹ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°å…¨éƒ¨çš„ä»£ç ã€‚



## END é“¾æ¥
<ul><li><div><a href = '13.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—</a><a href = '15.md' style='float: right'>â¬‡ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div></li></ul>

+ [â“‚ï¸å›åˆ°ç›®å½•ğŸ ](../README.md)

+ [**ğŸ«µå‚ä¸è´¡çŒ®ğŸ’â¤ï¸â€ğŸ”¥ğŸ’–**](https://nsddd.top/archives/contributors))

+ âœ´ï¸ç‰ˆæƒå£°æ˜ &copy; :æœ¬ä¹¦æ‰€æœ‰å†…å®¹éµå¾ª[CC-BY-SA 3.0åè®®ï¼ˆç½²å-ç›¸åŒæ–¹å¼å…±äº«ï¼‰&copy;](http://zh.wikipedia.org/wiki/Wikipedia:CC-by-sa-3.0åè®®æ–‡æœ¬) 

