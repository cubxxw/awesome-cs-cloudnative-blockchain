+ [author](http://nsddd.top)

# ç¬¬6èŠ‚ sealosæ­å»ºk8s

<div><a href = '5.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—  </a><a href = '7.md' style='float: right'>  â¬‡ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div>
<br>

> â¤ï¸ğŸ’•ğŸ’•æ–°æ—¶ä»£æ‹¥æŠ±äº‘åŸç”Ÿï¼Œäº‘åŸç”Ÿå…·æœ‰ç¯å¢ƒç»Ÿä¸€ã€æŒ‰éœ€ä»˜è´¹ã€å³å¼€å³ç”¨ã€ç¨³å®šæ€§å¼ºç‰¹ç‚¹ã€‚Myblog:[http://nsddd.top](http://nsddd.top/)

---
[[toc]]

[TOC]

## å¼€å§‹

### ä»€ä¹ˆæ˜¯sealos?

> ğŸ’¡ æ ‡å‡†è‡ªå·±ä»¥k8sä¸ºå†…æ ¸çš„æ“ä½œç³»ç»Ÿã€‚

sealosæ˜¯ä¸€ä¸ªGoè¯­è¨€å¼€å‘çš„ç®€å•å¹²å‡€ä¸”KUbernetesé›†ç¾¤éƒ¨ç½²å·¥å…·ã€‚

sealosæ˜¯èƒ½å¤Ÿå¾ˆå¥½çš„æ”¯æŒï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­éƒ¨ç½²é«˜å¯ç”¨çš„kubernetesé›†ç¾¤ã€‚



## Sealos ç‰¹æ€§ä¸ä¼˜åŠ¿

1. æ”¯æŒç¦»çº¿å®‰è£…ï¼Œå·¥å…·ä¸éƒ¨ç½²èµ„æºåŒ…åˆ†ç¦»ï¼Œæ–¹ä¾¿ä¸åŒç‰ˆæœ¬é—´å¿«é€Ÿå‡çº§ã€‚
2. 100å¹´è¯ä¹¦ã€‚
3. å·¥å…·ä½¿ç”¨éå¸¸ç®€å•ã€‚
4. æ”¯æŒä½¿ç”¨è‡ªå®šä¹‰é…ç½®æ–‡ä»¶ï¼Œå¯çµæ´»å®Œæˆé›†ç¾¤ç¯å¢ƒå®šåˆ¶ã€‚
5. ä½¿ç”¨å†…æ ¸è¿›è¡Œæœ¬åœ°è´Ÿè½½ï¼Œç¨³å®šæ€§æé«˜ï¼Œæ•…éšœæ’æŸ¥ä¹Ÿæå…¶ç®€å•ã€‚
6. æœ€ä¸»è¦çš„ä¼˜åŠ¿æ˜¯ä¸éœ€è¦ç¿»å¢™å‡ºå»



## é€‰æ‹©rancherè¿˜æ˜¯sealos

+ [x] [rancher](https://www.rancher.cn/)
+ [x] [GitHubé¡¹ç›®åœ°å€](https://github.com/rancher/rancher)

> åŒæ ·çš„è¿˜æœ‰ [kubekey](https://kubesphere.com.cn/docs/v3.3/installing-on-linux/introduction/kubekey/) ï¼Œsealosæ˜¯äºŒæ¬¡ä¼˜åŒ–

[KubeKey](https://github.com/kubesphere/kubekey)ï¼ˆç”± Go è¯­è¨€å¼€å‘ï¼‰æ˜¯ä¸€ç§å…¨æ–°çš„å®‰è£…å·¥å…·ï¼Œæ›¿ä»£äº†ä»¥å‰ä½¿ç”¨çš„åŸºäº ansible çš„å®‰è£…ç¨‹åºã€‚KubeKey ä¸ºæ‚¨æä¾›çµæ´»çš„å®‰è£…é€‰æ‹©ï¼Œæ‚¨å¯ä»¥ä»…å®‰è£… Kubernetesï¼Œä¹Ÿå¯ä»¥åŒæ—¶å®‰è£… Kubernetes å’Œ KubeSphereã€‚



### ä¸ºä»€ä¹ˆä¸ç”¨ KeepAlived å’Œ HAProxy å®ç°é›†ç¾¤é«˜å¯ç”¨

æ— è®ºæ˜¯é€šè¿‡ KeepAlived è¿˜æ˜¯ HAProxy è¿›è¡Œé«˜å¯ç”¨é›†ç¾¤è°ƒåº¦éƒ½ä¼šå­˜åœ¨ä»¥ä¸‹ä¸€äº›åŠ£åŠ¿ã€‚

1. è½¯ä»¶æºä¸ä¸€è‡´å¯èƒ½å¯¼è‡´å®¹å™¨ä¸­å®‰è£…çš„è½¯ä»¶ç‰ˆæœ¬ä¹Ÿä¸ä¸€è‡´ï¼Œè¿›è€Œä¼šå¼•èµ·ç›¸åº”æ£€æŸ¥è„šæœ¬ä¸ç”Ÿæ•ˆç­‰æ•…éšœã€‚
2. å¯èƒ½å› ä¸ºç³»ç»Ÿä¾èµ–åº“é—®é¢˜ï¼Œåœ¨æŸäº›ç‰¹å®šç¯å¢ƒä¸‹å°±ç›´æ¥æ— æ³•å®Œæˆå®‰è£…ã€‚
3. åªä¾é æ£€æµ‹ HAProxy è¿›ç¨‹æ˜¯å¦å­˜æ´»æ˜¯æ— æ³•ä¿è¯é›†ç¾¤é«˜å¯ç”¨çš„ï¼Œæ­£ç¡®çš„æ£€æµ‹æ–¹å¼åº”è¯¥æ˜¯åˆ¤æ–­ApiServer æ˜¯å¦ healthz çŠ¶æ€ã€‚
4. Keepalived å¯èƒ½å­˜åœ¨ Cpu å æ»¡çš„æƒ…å†µã€‚



## ä½¿ç”¨ sealos å¿«é€Ÿæ„å»º kubernetes

+ [x] [å¿«é€Ÿæ­å»ºæŒ‡å—](https://github.com/labring/sealos#quickstart)

sealosç°åœ¨åªæ”¯æŒlinuxï¼Œéœ€è¦linuxæœåŠ¡å™¨æ¥æµ‹è¯•ã€‚

ä¸€äº›å·¥å…·å¯ä»¥éå¸¸æ–¹ä¾¿åœ°å¸®åŠ©æ‚¨å¯åŠ¨è™šæ‹Ÿæœºï¼Œä¾‹å¦‚[multipass](https://multipass.run/)

### æ„å»ºé¡¹ç›®

```bash
mkdir /sealos && cd /sealos && git clone https://github.com/labring/sealos && cd sealos && ls && make build  # å¤§æ¦‚å¯èƒ½å› ä¸ºç½‘ç»œåŸå› éœ€è¦ç­‰ä¸€æ®µæ—¶é—´~
```

æ‚¨å¯ä»¥å°† `bin` æ–‡ä»¶ `scp` åˆ°æ‚¨çš„ `linux` ä¸»æœºã€‚

å¦‚æœä½ ä½¿ç”¨ `multipaas`ï¼Œä½ å¯ä»¥å°† `bin` ç›®å½•æŒ‚è½½åˆ° `vm`ï¼š

```bash
multipass mount /your-bin-dir <name>[:<path>]
```

ç„¶ååœ¨æœ¬åœ°æµ‹è¯•ã€‚

> **âš ï¸ æ³¨æ„ï¼š**
>
> æ‰€æœ‰äºŒè¿›åˆ¶æ–‡ä»¶éƒ½`sealos`å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹æ„å»ºï¼Œå› ä¸ºå®ƒä»¬æœ‰`CGO_ENABLED=0`. ä½†æ˜¯ï¼Œåœ¨è¿è¡Œä¸€äº›ä¾èµ–äº CGO çš„`sealos`å­å‘½ä»¤æ—¶ï¼Œéœ€è¦æ”¯æŒè¦†ç›–é©±åŠ¨ç¨‹åºã€‚`images`å› æ­¤ï¼Œåœ¨æ„å»ºæ—¶ä¼šæ‰“å¼€ CGO `sealos`ï¼Œä»è€Œæ— æ³•`sealos`åœ¨ Linux ä»¥å¤–çš„å¹³å°ä¸Šæ„å»ºäºŒè¿›åˆ¶æ–‡ä»¶ã€‚
>
> + æœ¬é¡¹ç›®ä¸­çš„ `Makefile` å’Œ `GoReleaser` éƒ½æœ‰è¿™ä¸ªè®¾ç½®ã€‚

---

ğŸ˜‚ è®©æˆ‘å¾ˆå–œæ¬¢çš„ä¸€ç‚¹æ˜¯ï¼š`sealos`èƒ½ä¸€æ¬¡æ€§æŠŠç¯å¢ƒæ­å»ºå¥½ï¼Œæƒ³å½“å¹´ï¼Œæˆ‘çœŸæ˜¯åºŸäº†ä¹ç‰›äºŒè™ä¹‹åŠ›æ‰æ­å»º~å¤±è´¥çš„ã€‚

![image-20221019194939030](http://sm.nsddd.top/smimage-20221019194939030.png)



## æ ¸å¿ƒæœåŠ¡å¿«é€Ÿå¯åŠ¨

**ğŸ’¡ é‡æ–°æŠŠæ˜¨å¤©é›†ç¾¤å…¨éƒ¨åˆ é™¤ï¼Œæ–°å¼€ä¸‰å°æœåŠ¡å™¨ï¼Œçº¯æ–°~**

![image-20221020103019907](https://sm.nsddd.top/smimage-20221020103019907.png)



### ç¯å¢ƒå‡†å¤‡

> âš ï¸ æ³¨æ„ï¼šç¯å¢ƒä¸€å®šå¾ˆé‡è¦ï¼Œä¸ç„¶éƒ½è·‘ä¸èµ·æ¥~

```bash
hostnamectl set-hostname k8s-master01
hostnamectl set-hostname k8s-master02
hostnamectl set-hostname k8s-master03
```

> **è™šæ‹Ÿæœºéœ€è¦é…ç½®é™æ€IP**



### æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬

```bash
# ä¸‹è½½å¹¶å®‰è£… sealos, sealos æ˜¯ä¸ª golang çš„äºŒè¿›åˆ¶å·¥å…·ï¼Œç›´æ¥ä¸‹è½½æ‹·è´åˆ° bin ç›®å½•å³å¯, release é¡µé¢ä¹Ÿå¯ä¸‹è½½ 
yum install wget && yum install tar &&\
wget  https://github.com/labring/sealos/releases/download/v4.1.3/sealos_4.1.3_linux_amd64.tar.gz  && \
tar -zxvf sealos_4.1.3_linux_amd64.tar.gz sealos &&  chmod +x sealos && mv sealos /usr/bin 
# åˆ›å»ºä¸€ä¸ªé›†ç¾¤
sealos run labring/kubernetes:v1.25.0 labring/helm:v3.8.2 labring/calico:v3.24.1 \
     --masters 192.168.0.2,192.168.0.3\
     --nodes 192.168.0.4 -p [your-ssh-passwd]
```

> `-p`ï¼špasswdå¯†ç 
>
> å¼€å¯sshå…å¯†ä¸éœ€è¦äº›å¯†ç äº†ï¼Œåœ¨è¿™é‡Œå°±å®ç°äº†ã€‚
>
> ![image-20221020111912006](https://sm.nsddd.top/smimage-20221020111912006.png)

![image-20221020105230320](https://sm.nsddd.top/smimage-20221020105230320.png)



**éªŒè¯é›†ç¾¤ï¼š**

```bash
kubectl get nodes
```

![image-20221020113615770](https://sm.nsddd.top/smimage-20221020113615770.png)



**æŸ¥çœ‹ç‰ˆæœ¬ï¼š**

```bash
[root@k8s-master01 ~]# sealos version
{"gitVersion":"4.1.3","gitCommit":"b2ba9705","buildDate":"2022-09-06T06:04:14Z","goVersion":"go1.19","compiler":"gc","platform":"linux/amd64"}
```



**ä½¿ç”¨ docker ä½œä¸º runtimeï¼š**

```shell
sealos run labring/kubernetes-docker:v1.20.5-4.1.3 labring/calico:v3.24.1 \
     --masters 192.168.64.2,192.168.64.22,192.168.64.20 \
     --nodes 192.168.64.21,192.168.64.19 -p [your-ssh-passwd]
```



+ å·²æ”¯æŒçš„ kubernetes ç‰ˆæœ¬åˆ—è¡¨: [kuberentes ä½¿ç”¨ containerd è¿è¡Œæ—¶](https://hub.docker.com/r/labring/kubernetes/tags) [kubernetes ä½¿ç”¨ cri-docker](https://hub.docker.com/r/labring/kubernetes-docker/tags)



## END é“¾æ¥

<ul><li><div><a href = '5.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—  </a><a href = '7.md' style='float: right'>  ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div></li></ul>

+ [â“‚ï¸å›åˆ°ç›®å½•ğŸ ](../README.md)

+ [**ğŸ«µå‚ä¸è´¡çŒ®ğŸ’â¤ï¸â€ğŸ”¥ğŸ’–**](https://nsddd.top/archives/contributors))

+ âœ´ï¸ç‰ˆæƒå£°æ˜ &copy; ï¼šæœ¬ä¹¦æ‰€æœ‰å†…å®¹éµå¾ª[CC-BY-SA 3.0åè®®ï¼ˆç½²å-ç›¸åŒæ–¹å¼å…±äº«ï¼‰&copy;](http://zh.wikipedia.org/wiki/Wikipedia:CC-by-sa-3.0åè®®æ–‡æœ¬) 

