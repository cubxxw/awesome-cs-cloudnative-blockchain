# 1. åŠ å¯†è§£å¯†

### 1.1.1. AES ç®€ä»‹

é«˜çº§åŠ å¯†æ ‡å‡†ï¼ˆè‹±è¯­Advanced Encryption Standardï¼Œç¼©å†™AESï¼‰åœ¨å¯†ç å­¦ä¸­åˆç§° Rijndael åŠ å¯†æ³•ï¼Œæ˜¯ç¾å›½è”é‚¦æ”¿åºœé‡‡ç”¨çš„ä¸€ç§åŒºå—åŠ å¯†æ ‡å‡†ã€‚è¿™ä¸ªæ ‡å‡†ç”¨æ¥æ›¿ä»£åŸå…ˆçš„ DESï¼Œå·²ç»è¢«å¤šæ–¹åˆ†æä¸”å¹¿ä¸ºå…¨ä¸–ç•Œæ‰€ä½¿ç”¨ã€‚ç»è¿‡äº”å¹´çš„ç”„é€‰æµç¨‹ï¼Œé«˜çº§åŠ å¯†æ ‡å‡†ç”±ç¾å›½å›½å®¶æ ‡å‡†ä¸æŠ€æœ¯ç ”ç©¶é™¢ï¼ˆNISTï¼‰äº 2001 å¹´ 11 æœˆ 26 æ—¥å‘å¸ƒäº FIPS PUB 197ï¼Œå¹¶åœ¨ 2002 å¹´ 5 æœˆ 26 æ—¥æˆä¸ºæœ‰æ•ˆçš„æ ‡å‡†ã€‚2006 å¹´ï¼Œé«˜çº§åŠ å¯†æ ‡å‡†å·²ç„¶æˆä¸ºå¯¹ç§°å¯†é’¥åŠ å¯†ä¸­æœ€æµè¡Œçš„ç®—æ³•ä¹‹ä¸€ã€‚

è¯¥ç®—æ³•ä¸ºæ¯”åˆ©æ—¶å¯†ç å­¦å®¶ Joan Daemen å’Œ Vincent Rijmen æ‰€è®¾è®¡ï¼Œç»“åˆä¸¤ä½ä½œè€…çš„åå­—ï¼Œä»¥ Rijndael ä¸ºåæŠ•ç¨¿é«˜çº§åŠ å¯†æ ‡å‡†çš„ç”„é€‰æµç¨‹ã€‚ï¼ˆRijndael çš„å‘éŸ³è¿‘äº "Rhine doll"ï¼‰

### 1.1.2. AES ç‰¹ç‚¹

| é¡¹ç›®             | è¯´æ˜                                                         | å¤‡æ³¨        |
| ---------------- | ------------------------------------------------------------ | ----------- |
| å¯†é’¥é•¿åº¦         | 128ä½ï¼ˆ16Byteï¼‰ã€192ä½ï¼ˆ24Byteï¼‰ã€256ä½ï¼ˆ32Byteï¼‰            | é»˜è®¤ï¼š128ä½ |
| åˆ†ç»„å¯†ç å·¥ä½œæ¨¡å¼ | ECB,CBC,PCBC,CTR,CTS,CFB,CFB8 è‡³ CFB128,OFB,OFB8 è‡³ OFB128   |             |
| å¡«å……æ–¹å¼         | NoPadding, ISO10126Padding, OAEPPadding, PKCS1Padding, PKCS5Padding, SSL3Padding |             |

é‡‡ç”¨ä¸åŒçš„å·¥ä½œæ¨¡å¼ï¼ˆåˆ†ç»„å¯†ç å·¥ä½œæ¨¡å¼ï¼‰ï¼Œå¯èƒ½ä¼šæ¶‰åŠåˆ° åˆå§‹åŒ–å‘é‡ï¼ˆIVï¼‰ å’Œ å¡«å……æ¨¡å¼ çš„é€‰æ‹©ã€‚

åœ¨å¯†ç å­¦ä¸­ï¼Œä¸€ä¸ªå¯†é’¥åªèƒ½åŠ å¯†é•¿åº¦ç­‰äºå¯†é’¥é•¿åº¦çš„æ•°æ®ã€‚

ä¸ºäº†åŠ å¯†æ›´å¤šçš„æ•°æ®ï¼Œéœ€è¦å¯¹æ•°æ®è¿›è¡Œåˆç†çš„åˆ†ç»„ã€‚

åˆ†ç»„å¯†ç å·¥ä½œæ¨¡å¼åˆ™æ˜¯æŒ‰ç…§ä¸åŒçš„å¯†ç è§„åˆ™è¿›è¡Œåˆ†ç»„ï¼ˆç”¨äºåŠ å¯†å’Œè®¤è¯ï¼‰ã€‚

æœ€åä¸€å—æ•°æ®é•¿åº¦ä¸è¶³å¯†é’¥é•¿åº¦æ—¶ï¼Œåˆ™éœ€è¦ä½¿ç”¨åˆé€‚çš„ å¡«å……æ¨¡å¼ è¿›è¡Œå¡«å……ï¼Œç„¶ååŠ å…¥å¤„ç†ã€‚

åˆ†ç»„è¿‡ç¨‹ä¸­é€šå¸¸è¿˜ä¼šåŠ å…¥åˆå§‹åŒ–å‘é‡è¿›è¡ŒéšæœºåŒ–ï¼Œä»¥ä¿è¯å®‰å…¨ã€‚

ç¤ºä¾‹ä»£ç ï¼š

```go
package main

import (
    "bytes"
    "crypto/aes"
    "crypto/cipher"
    "encoding/base64"
    "errors"
    "fmt"
)

//é«˜çº§åŠ å¯†æ ‡å‡†ï¼ˆAdevanced Encryption Standard ,AESï¼‰

//16,24,32ä½å­—ç¬¦ä¸²çš„è¯ï¼Œåˆ†åˆ«å¯¹åº”AES-128ï¼ŒAES-192ï¼ŒAES-256 åŠ å¯†æ–¹æ³•
//keyä¸èƒ½æ³„éœ²
var PwdKey = []byte("DIS**#KKKDJJSKDI")

//PKCS7 å¡«å……æ¨¡å¼
func PKCS7Padding(ciphertext []byte, blockSize int) []byte {
    padding := blockSize - len(ciphertext)%blockSize
    //Repeat()å‡½æ•°çš„åŠŸèƒ½æ˜¯æŠŠåˆ‡ç‰‡[]byte{byte(padding)}å¤åˆ¶paddingä¸ªï¼Œç„¶ååˆå¹¶æˆæ–°çš„å­—èŠ‚åˆ‡ç‰‡è¿”å›
    padtext := bytes.Repeat([]byte{byte(padding)}, padding)
    return append(ciphertext, padtext...)
}

//å¡«å……çš„åå‘æ“ä½œï¼Œåˆ é™¤å¡«å……å­—ç¬¦ä¸²
func PKCS7UnPadding(origData []byte) ([]byte, error) {
    //è·å–æ•°æ®é•¿åº¦
    length := len(origData)
    if length == 0 {
        return nil, errors.New("åŠ å¯†å­—ç¬¦ä¸²é”™è¯¯ï¼")
    } else {
        //è·å–å¡«å……å­—ç¬¦ä¸²é•¿åº¦
        unpadding := int(origData[length-1])
        //æˆªå–åˆ‡ç‰‡ï¼Œåˆ é™¤å¡«å……å­—èŠ‚ï¼Œå¹¶ä¸”è¿”å›æ˜æ–‡
        return origData[:(length - unpadding)], nil
    }
}

//å®ç°åŠ å¯†
func AesEcrypt(origData []byte, key []byte) ([]byte, error) {
    //åˆ›å»ºåŠ å¯†ç®—æ³•å®ä¾‹
    block, err := aes.NewCipher(key)
    if err != nil {
        return nil, err
    }
    //è·å–å—çš„å¤§å°
    blockSize := block.BlockSize()
    //å¯¹æ•°æ®è¿›è¡Œå¡«å……ï¼Œè®©æ•°æ®é•¿åº¦æ»¡è¶³éœ€æ±‚
    origData = PKCS7Padding(origData, blockSize)
    //é‡‡ç”¨AESåŠ å¯†æ–¹æ³•ä¸­CBCåŠ å¯†æ¨¡å¼
    blocMode := cipher.NewCBCEncrypter(block, key[:blockSize])
    crypted := make([]byte, len(origData))
    //æ‰§è¡ŒåŠ å¯†
    blocMode.CryptBlocks(crypted, origData)
    return crypted, nil
}

//å®ç°è§£å¯†
func AesDeCrypt(cypted []byte, key []byte) ([]byte, error) {
    //åˆ›å»ºåŠ å¯†ç®—æ³•å®ä¾‹
    block, err := aes.NewCipher(key)
    if err != nil {
        return nil, err
    }
    //è·å–å—å¤§å°
    blockSize := block.BlockSize()
    //åˆ›å»ºåŠ å¯†å®¢æˆ·ç«¯å®ä¾‹
    blockMode := cipher.NewCBCDecrypter(block, key[:blockSize])
    origData := make([]byte, len(cypted))
    //è¿™ä¸ªå‡½æ•°ä¹Ÿå¯ä»¥ç”¨æ¥è§£å¯†
    blockMode.CryptBlocks(origData, cypted)
    //å»é™¤å¡«å……å­—ç¬¦ä¸²
    origData, err = PKCS7UnPadding(origData)
    if err != nil {
        return nil, err
    }
    return origData, err
}

//åŠ å¯†base64
func EnPwdCode(pwd []byte) (string, error) {
    result, err := AesEcrypt(pwd, PwdKey)
    if err != nil {
        return "", err
    }
    return base64.StdEncoding.EncodeToString(result), err
}

//è§£å¯†
func DePwdCode(pwd string) ([]byte, error) {
    //è§£å¯†base64å­—ç¬¦ä¸²
    pwdByte, err := base64.StdEncoding.DecodeString(pwd)
    if err != nil {
        return nil, err
    }
    //æ‰§è¡ŒAESè§£å¯†
    return AesDeCrypt(pwdByte, PwdKey)

}
func main() {
    str := []byte("12fffæˆ‘æ˜¯ww.topgoer.comçš„ç«™é•¿æ¯è—¤")
    pwd, _ := EnPwdCode(str)
    bytes, _ := DePwdCode(pwd)
    fmt.Println(string(bytes))
}
```

## END é“¾æ¥
<ul><li><div><a href = '78.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—</a><a href = '80.md' style='float: right'>â¬‡ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div></li></ul>

+ [â“‚ï¸å›åˆ°é¦–é¡µğŸ ](../README.md)

+ [**ğŸ«µå‚ä¸è´¡çŒ®ğŸ’â¤ï¸â€ğŸ”¥ğŸ’–**](https://nsddd.top/archives/contributors))

+ âœ´ï¸ç‰ˆæƒå£°æ˜ &copy; :æœ¬ä¹¦æ‰€æœ‰å†…å®¹éµå¾ª[CC-BY-SA 3.0åè®®ï¼ˆç½²å-ç›¸åŒæ–¹å¼å…±äº«ï¼‰&copy;](http://zh.wikipedia.org/wiki/Wikipedia:CC-by-sa-3.0åè®®æ–‡æœ¬) 

