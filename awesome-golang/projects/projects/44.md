+ [ğŸ”¥ å¼€æºåœ°å€](https://github.com/cubxxw/iam)

# ç¬¬44èŠ‚ å¯ç›´æ¥å¥—ç”¨çš„ Go ç¼–ç è§„èŒƒ

<br>
<div><a href = '43.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—  </a><a href = '45.md' style='float: right'>  â¬‡ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div>
<br>

> â¤ï¸ğŸ’•ğŸ’•During the winter vacation, I followed up and learned two projects: tiktok project and IAM project, and summarized and practiced the CloudNative project and Go language. I learned a lot in the process.Myblog:[http://nsddd.top](http://nsddd.top/)

---
[[TOC]]
[TOC]

## Go ä»£ç å¼€å‘è§„èŒƒ
åœ¨Go é¡¹ç›®å¼€å‘ä¸­ï¼Œä¸€ä¸ªå¥½çš„ç¼–ç è§„èŒƒå¯ä»¥æå¤§çš„æé«˜ä»£ç è´¨é‡ã€‚ä¸ºäº†å¸®ä½ èŠ‚çœæ—¶é—´å’Œç²¾åŠ›ï¼Œè¿™é‡Œæˆ‘æ•´ç†äº†ä¸€ä»½æ¸…æ™°ã€å¯ç›´æ¥å¥—ç”¨çš„ Go ç¼–ç è§„èŒƒï¼Œä¾›ä½ å‚è€ƒã€‚

è¿™ä»½è§„èŒƒï¼Œæ˜¯æˆ‘å‚è€ƒäº† Go å®˜æ–¹æä¾›çš„ç¼–ç è§„èŒƒï¼Œä»¥åŠ Go ç¤¾åŒºæ²‰æ·€çš„ä¸€äº›æ¯”è¾ƒåˆç†çš„è§„èŒƒä¹‹åï¼ŒåŠ å…¥è‡ªå·±çš„ç†è§£æ€»ç»“å‡ºçš„ï¼Œå®ƒæ¯”å¾ˆå¤šå…¬å¸å†…éƒ¨çš„è§„èŒƒæ›´å…¨é¢ï¼Œä½ æŒæ¡äº†ï¼Œä»¥ååœ¨é¢è¯•å¤§å‚çš„æ—¶å€™ï¼Œæˆ–è€…åœ¨å¤§å‚é‡Œå†™ä»£ç çš„æ—¶å€™ï¼Œéƒ½ä¼šè®©äººé«˜çœ‹ä½ ä¸€çœ¼ï¼Œè§‰å¾—ä½ codeå¾ˆä¸“ä¸šã€‚

è¿™ä»½ç¼–ç è§„èŒƒä¸­åŒ…å«ä»£ç é£æ ¼ã€å‘½åè§„èŒƒã€æ³¨é‡Šè§„èŒƒã€ç±»å‹ã€æ§åˆ¶ç»“æ„ã€å‡½æ•°ã€GOPATH è®¾ç½®è§„èŒƒã€ä¾èµ–ç®¡ç†å’Œæœ€ä½³å®è·µä¹ç±»è§„èŒƒã€‚å¦‚æœä½ è§‰å¾—è¿™äº›è§„èŒƒå†…å®¹å¤ªå¤šäº†ï¼Œçœ‹å®Œä¸€éä¹Ÿè®°ä¸ä½ï¼Œè¿™å®Œå…¨æ²¡å…³ç³»ã€‚ä½ å¯ä»¥å¤šçœ‹å‡ éï¼Œä¹Ÿå¯ä»¥åœ¨ç”¨åˆ°æ—¶æŠŠå®ƒç¿»å‡ºæ¥ï¼Œåœ¨å®é™…åº”ç”¨ä¸­æŒæ¡ã€‚è¿™ç¯‡ç‰¹åˆ«æ”¾é€çš„å†…å®¹ï¼Œæ›´å¤šæ˜¯ä½œä¸ºå†™ä»£ç æ—¶å€™çš„ä¸€ä¸ªå‚è€ƒæ‰‹å†Œã€‚

## 1. ä»£ç é£æ ¼

### 1.1 ä»£ç æ ¼å¼

- ä»£ç éƒ½å¿…é¡»ç”¨ `gofmt` è¿›è¡Œæ ¼å¼åŒ–ã€‚
- è¿ç®—ç¬¦å’Œæ“ä½œæ•°ä¹‹é—´è¦ç•™ç©ºæ ¼ã€‚
- å»ºè®®ä¸€è¡Œä»£ç ä¸è¶…è¿‡120ä¸ªå­—ç¬¦ï¼Œè¶…è¿‡éƒ¨åˆ†ï¼Œè¯·é‡‡ç”¨åˆé€‚çš„æ¢è¡Œæ–¹å¼æ¢è¡Œã€‚ä½†ä¹Ÿæœ‰äº›ä¾‹å¤–åœºæ™¯ï¼Œä¾‹å¦‚importè¡Œã€å·¥å…·è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç ã€å¸¦tagçš„structå­—æ®µã€‚
- æ–‡ä»¶é•¿åº¦ä¸èƒ½è¶…è¿‡800è¡Œã€‚
- å‡½æ•°é•¿åº¦ä¸èƒ½è¶…è¿‡80è¡Œã€‚
- importè§„èŒƒ
	- ä»£ç éƒ½å¿…é¡»ç”¨`goimports`è¿›è¡Œæ ¼å¼åŒ–ï¼ˆå»ºè®®å°†ä»£ç Goä»£ç ç¼–è¾‘å™¨è®¾ç½®ä¸ºï¼šä¿å­˜æ—¶è¿è¡Œ `goimports`ï¼‰ã€‚
	- ä¸è¦ä½¿ç”¨ç›¸å¯¹è·¯å¾„å¼•å…¥åŒ…ï¼Œä¾‹å¦‚ `import ../util/net` ã€‚
	- åŒ…åç§°ä¸å¯¼å…¥è·¯å¾„çš„æœ€åä¸€ä¸ªç›®å½•åä¸åŒ¹é…æ—¶ï¼Œæˆ–è€…å¤šä¸ªç›¸åŒåŒ…åå†²çªæ—¶ï¼Œåˆ™å¿…é¡»ä½¿ç”¨å¯¼å…¥åˆ«åã€‚

```go
	// bad
	"github.com/dgrijalva/jwt-go/v4"

	//good
	jwt "github.com/dgrijalva/jwt-go/v4"
```
	- å¯¼å…¥çš„åŒ…å»ºè®®è¿›è¡Œåˆ†ç»„ï¼ŒåŒ¿ååŒ…çš„å¼•ç”¨ä½¿ç”¨ä¸€ä¸ªæ–°çš„åˆ†ç»„ï¼Œå¹¶å¯¹åŒ¿ååŒ…å¼•ç”¨è¿›è¡Œè¯´æ˜ã€‚

```go
	import (
		// go æ ‡å‡†åŒ…
		"fmt"

		// ç¬¬ä¸‰æ–¹åŒ…
	    "github.com/jinzhu/gorm"
	    "github.com/spf13/cobra"
	    "github.com/spf13/viper"

		// åŒ¿ååŒ…å•ç‹¬åˆ†ç»„ï¼Œå¹¶å¯¹åŒ¿ååŒ…å¼•ç”¨è¿›è¡Œè¯´æ˜
	    // import mysql driver
	    _ "github.com/jinzhu/gorm/dialects/mysql"

		// å†…éƒ¨åŒ…
	    v1 "github.com/marmotedu/api/apiserver/v1"
	    metav1 "github.com/marmotedu/apimachinery/pkg/meta/v1"
	    "github.com/marmotedu/iam/pkg/cli/genericclioptions"
	)
```

### 1.2 å£°æ˜ã€åˆå§‹åŒ–å’Œå®šä¹‰

å½“å‡½æ•°ä¸­éœ€è¦ä½¿ç”¨åˆ°å¤šä¸ªå˜é‡æ—¶ï¼Œå¯ä»¥åœ¨å‡½æ•°å¼€å§‹å¤„ä½¿ç”¨`var`å£°æ˜ã€‚åœ¨å‡½æ•°å¤–éƒ¨å£°æ˜å¿…é¡»ä½¿ç”¨ `var` ï¼Œä¸è¦é‡‡ç”¨ `:=` ï¼Œå®¹æ˜“è¸©åˆ°å˜é‡çš„ä½œç”¨åŸŸçš„é—®é¢˜ã€‚

```go
var (
	Width  int
	Height int
)
```

- åœ¨åˆå§‹åŒ–ç»“æ„å¼•ç”¨æ—¶ï¼Œè¯·ä½¿ç”¨`&T{}`ä»£æ›¿`new(T)`ï¼Œä»¥ä½¿å…¶ä¸ç»“æ„ä½“åˆå§‹åŒ–ä¸€è‡´ã€‚

```go
// bad
sptr := new(T)
sptr.Name = "bar"

// good
sptr := &T{Name: "bar"}
```

- struct å£°æ˜å’Œåˆå§‹åŒ–æ ¼å¼é‡‡ç”¨å¤šè¡Œï¼Œå®šä¹‰å¦‚ä¸‹ã€‚

```go
type User struct{
    Username  string
    Email     string
}

user := User{
	Username: "belm",
	Email: "nosbelm@qq.com",
}
```

- ç›¸ä¼¼çš„å£°æ˜æ”¾åœ¨ä¸€ç»„ï¼ŒåŒæ ·é€‚ç”¨äºå¸¸é‡ã€å˜é‡å’Œç±»å‹å£°æ˜ã€‚

```go
// bad
import "a"
import "b"

// good
import (
  "a"
  "b"
)
```

- å°½å¯èƒ½æŒ‡å®šå®¹å™¨å®¹é‡ï¼Œä»¥ä¾¿ä¸ºå®¹å™¨é¢„å…ˆåˆ†é…å†…å­˜ï¼Œä¾‹å¦‚ï¼š

```go
v := make(map[int]string, 4)
v := make([]string, 0, 4)
```

- åœ¨é¡¶å±‚ï¼Œä½¿ç”¨æ ‡å‡†varå…³é”®å­—ã€‚è¯·å‹¿æŒ‡å®šç±»å‹ï¼Œé™¤éå®ƒä¸è¡¨è¾¾å¼çš„ç±»å‹ä¸åŒã€‚

```go
// bad
var _s string = F()

func F() string { return "A" }

// good
var _s = F()
// ç”±äº F å·²ç»æ˜ç¡®äº†è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹ï¼Œå› æ­¤æˆ‘ä»¬æ²¡æœ‰å¿…è¦æ˜¾å¼æŒ‡å®š_s çš„ç±»å‹
// è¿˜æ˜¯é‚£ç§ç±»å‹

func F() string { return "A" }
```

- å¯¹äºæœªå¯¼å‡ºçš„é¡¶å±‚å¸¸é‡å’Œå˜é‡ï¼Œä½¿ç”¨`_`ä½œä¸ºå‰ç¼€ã€‚

```go
// bad
const (
  defaultHost = "127.0.0.1"
  defaultPort = 8080
)

// good
const (
  _defaultHost = "127.0.0.1"
  _defaultPort = 8080
)
```

- åµŒå…¥å¼ç±»å‹ï¼ˆä¾‹å¦‚ mutexï¼‰åº”ä½äºç»“æ„ä½“å†…çš„å­—æ®µåˆ—è¡¨çš„é¡¶éƒ¨ï¼Œå¹¶ä¸”å¿…é¡»æœ‰ä¸€ä¸ªç©ºè¡Œå°†åµŒå…¥å¼å­—æ®µä¸å¸¸è§„å­—æ®µåˆ†éš”å¼€ã€‚

```go
// bad
type Client struct {
  version int
  http.Client
}

// good
type Client struct {
  http.Client

  version int
}
```

### 1.3 é”™è¯¯å¤„ç†

- `error`ä½œä¸ºå‡½æ•°çš„å€¼è¿”å›ï¼Œå¿…é¡»å¯¹`error`è¿›è¡Œå¤„ç†ï¼Œæˆ–å°†è¿”å›å€¼èµ‹å€¼ç»™æ˜ç¡®å¿½ç•¥ã€‚å¯¹äº`defer xx.Close()`å¯ä»¥ä¸ç”¨æ˜¾å¼å¤„ç†ã€‚

```go
func load() error {
	// normal code
}

// bad
load()

// good
 _ = load()
```

- `error`ä½œä¸ºå‡½æ•°çš„å€¼è¿”å›ä¸”æœ‰å¤šä¸ªè¿”å›å€¼çš„æ—¶å€™ï¼Œ`error`å¿…é¡»æ˜¯æœ€åä¸€ä¸ªå‚æ•°ã€‚

```go
// bad
func load() (error, int) {
	// normal code
}

// good
func load() (int, error) {
	// normal code
}
```

- å°½æ—©è¿›è¡Œé”™è¯¯å¤„ç†ï¼Œå¹¶å°½æ—©è¿”å›ï¼Œå‡å°‘åµŒå¥—ã€‚

```go
// bad
if err != nil {
	// error code
} else {
	// normal code
}

// good
if err != nil {
	// error handling
	return err
}
// normal code
```

- å¦‚æœéœ€è¦åœ¨ if ä¹‹å¤–ä½¿ç”¨å‡½æ•°è°ƒç”¨çš„ç»“æœï¼Œåˆ™åº”é‡‡ç”¨ä¸‹é¢çš„æ–¹å¼ã€‚

```go
// bad
if v, err := foo(); err != nil {
	// error handling
}

// good
v, err := foo()
if err != nil {
	// error handling
}
```

- é”™è¯¯è¦å•ç‹¬åˆ¤æ–­ï¼Œä¸ä¸å…¶ä»–é€»è¾‘ç»„åˆåˆ¤æ–­ã€‚

```go
// bad
v, err := foo()
if err != nil || v  == nil {
	// error handling
	return err
}

// good
v, err := foo()
if err != nil {
	// error handling
	return err
}

if v == nil {
	// error handling
	return errors.New("invalid value v")
}
```

- å¦‚æœè¿”å›å€¼éœ€è¦åˆå§‹åŒ–ï¼Œåˆ™é‡‡ç”¨ä¸‹é¢çš„æ–¹å¼ã€‚

```go
v, err := f()
if err != nil {
    // error handling
    return // or continue.
}
// use v
```

**é”™è¯¯æè¿°å»ºè®® :**

- å‘Šè¯‰ç”¨æˆ·ä»–ä»¬å¯ä»¥åšä»€ä¹ˆï¼Œè€Œä¸æ˜¯å‘Šè¯‰ä»–ä»¬ä¸èƒ½åšä»€ä¹ˆã€‚

- å½“å£°æ˜ä¸€ä¸ªéœ€æ±‚æ—¶ï¼Œç”¨must è€Œä¸æ˜¯shouldã€‚ä¾‹å¦‚ï¼Œ`must be greater than 0ã€must match regex '[a-z]+'`ã€‚
- å½“å£°æ˜ä¸€ä¸ªæ ¼å¼ä¸å¯¹æ—¶ï¼Œç”¨must notã€‚ä¾‹å¦‚ï¼Œ`must not contain`ã€‚
- å½“å£°æ˜ä¸€ä¸ªåŠ¨ä½œæ—¶ç”¨may notã€‚ä¾‹å¦‚ï¼Œ`may not be specified when otherField is emptyã€only name may be specified`ã€‚
- å¼•ç”¨æ–‡å­—å­—ç¬¦ä¸²å€¼æ—¶ï¼Œè¯·åœ¨å•å¼•å·ä¸­æŒ‡ç¤ºæ–‡å­—ã€‚ä¾‹å¦‚ï¼Œ`ust not contain '..'`ã€‚
- å½“å¼•ç”¨å¦ä¸€ä¸ªå­—æ®µåç§°æ—¶ï¼Œè¯·åœ¨åå¼•å·ä¸­æŒ‡å®šè¯¥åç§°ã€‚ä¾‹å¦‚ï¼Œmust be greater than `request`ã€‚
- æŒ‡å®šä¸ç­‰æ—¶ï¼Œè¯·ä½¿ç”¨å•è¯è€Œä¸æ˜¯ç¬¦å·ã€‚ä¾‹å¦‚ï¼Œ`must be less than 256ã€must be greater than or equal to 0 (ä¸è¦ç”¨ larger thanã€bigger thanã€more thanã€higher than)`ã€‚
- æŒ‡å®šæ•°å­—èŒƒå›´æ—¶ï¼Œè¯·å°½å¯èƒ½ä½¿ç”¨åŒ…å«èŒƒå›´ã€‚
- å»ºè®® Go 1.13 ä»¥ä¸Šï¼Œerror ç”Ÿæˆæ–¹å¼ä¸º `fmt.Errorf("module xxx: %w", err)`ã€‚
- é”™è¯¯æè¿°ç”¨å°å†™å­—æ¯å¼€å¤´ï¼Œç»“å°¾ä¸è¦åŠ æ ‡ç‚¹ç¬¦å·ï¼Œä¾‹å¦‚ï¼š

```bash
// bad
errors.New("Redis connection failed")
errors.New("redis connection failed.")

// good
errors.New("redis connection failed")
```



### 1.4 panicå¤„ç†

- åœ¨ä¸šåŠ¡é€»è¾‘å¤„ç†ä¸­ç¦æ­¢ä½¿ç”¨panicã€‚
- åœ¨mainåŒ…ä¸­ï¼Œåªæœ‰å½“ç¨‹åºå®Œå…¨ä¸å¯è¿è¡Œæ—¶ä½¿ç”¨panicï¼Œä¾‹å¦‚æ— æ³•æ‰“å¼€æ–‡ä»¶ã€æ— æ³•è¿æ¥æ•°æ®åº“å¯¼è‡´ç¨‹åºæ— æ³•æ­£å¸¸è¿è¡Œã€‚
- åœ¨mainåŒ…ä¸­ï¼Œä½¿ç”¨ `log.Fatal` æ¥è®°å½•é”™è¯¯ï¼Œè¿™æ ·å°±å¯ä»¥ç”±logæ¥ç»“æŸç¨‹åºï¼Œæˆ–è€…å°†panicæŠ›å‡ºçš„å¼‚å¸¸è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œæ–¹ä¾¿æ’æŸ¥é—®é¢˜ã€‚
- å¯å¯¼å‡ºçš„æ¥å£ä¸€å®šä¸èƒ½æœ‰panicã€‚
- åŒ…å†…å»ºè®®é‡‡ç”¨errorè€Œä¸æ˜¯panicæ¥ä¼ é€’é”™è¯¯ã€‚

### 1.5 å•å…ƒæµ‹è¯•

- å•å…ƒæµ‹è¯•æ–‡ä»¶åå‘½åè§„èŒƒä¸º `example_test.go`ã€‚
- æ¯ä¸ªé‡è¦çš„å¯å¯¼å‡ºå‡½æ•°éƒ½è¦ç¼–å†™æµ‹è¯•ç”¨ä¾‹ã€‚
- å› ä¸ºå•å…ƒæµ‹è¯•æ–‡ä»¶å†…çš„å‡½æ•°éƒ½æ˜¯ä¸å¯¹å¤–çš„ï¼Œæ‰€ä»¥å¯å¯¼å‡ºçš„ç»“æ„ä½“ã€å‡½æ•°ç­‰å¯ä»¥ä¸å¸¦æ³¨é‡Šã€‚
- å¦‚æœå­˜åœ¨ `func (b *Bar) Foo` ï¼Œå•æµ‹å‡½æ•°å¯ä»¥ä¸º `func TestBar_Foo`ã€‚

### 1.6 ç±»å‹æ–­è¨€å¤±è´¥å¤„ç†

- type assertion çš„å•ä¸ªè¿”å›å€¼é’ˆå¯¹ä¸æ­£ç¡®çš„ç±»å‹å°†äº§ç”Ÿ panicã€‚è¯·å§‹ç»ˆä½¿ç”¨ â€œcomma okâ€çš„æƒ¯ç”¨æ³•ã€‚

```go
// bad
t := n.(int)

// good
t, ok := n.(int)
if !ok {
	// error handling
}
```

## 2. å‘½åè§„èŒƒ

å‘½åè§„èŒƒæ˜¯ä»£ç è§„èŒƒä¸­éå¸¸é‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œä¸€ä¸ªç»Ÿä¸€çš„ã€çŸ­å°çš„ã€ç²¾ç¡®çš„å‘½åè§„èŒƒå¯ä»¥å¤§å¤§æé«˜ä»£ç çš„å¯è¯»æ€§ï¼Œä¹Ÿå¯ä»¥å€Ÿæ­¤è§„é¿ä¸€äº›ä¸å¿…è¦çš„Bugã€‚

### 2.1 åŒ…å‘½å

- åŒ…åå¿…é¡»å’Œç›®å½•åä¸€è‡´ï¼Œå°½é‡é‡‡å–æœ‰æ„ä¹‰ã€ç®€çŸ­çš„åŒ…åï¼Œä¸è¦å’Œæ ‡å‡†åº“å†²çªã€‚
- åŒ…åå…¨éƒ¨å°å†™ï¼Œæ²¡æœ‰å¤§å†™æˆ–ä¸‹åˆ’çº¿ï¼Œä½¿ç”¨å¤šçº§ç›®å½•æ¥åˆ’åˆ†å±‚çº§ã€‚
- é¡¹ç›®åå¯ä»¥é€šè¿‡ä¸­åˆ’çº¿æ¥è¿æ¥å¤šä¸ªå•è¯ã€‚
- åŒ…åä»¥åŠåŒ…æ‰€åœ¨çš„ç›®å½•åï¼Œä¸è¦ä½¿ç”¨å¤æ•°ï¼Œä¾‹å¦‚ï¼Œæ˜¯`net/url`ï¼Œè€Œä¸æ˜¯`net/urls`ã€‚
- ä¸è¦ç”¨ commonã€utilã€shared æˆ–è€… lib è¿™ç±»å®½æ³›çš„ã€æ— æ„ä¹‰çš„åŒ…åã€‚
- åŒ…åè¦ç®€å•æ˜äº†ï¼Œä¾‹å¦‚ netã€timeã€logã€‚

### 2.2 å‡½æ•°å‘½å

- å‡½æ•°åé‡‡ç”¨é©¼å³°å¼ï¼Œé¦–å­—æ¯æ ¹æ®è®¿é—®æ§åˆ¶å†³å®šä½¿ç”¨å¤§å†™æˆ–å°å†™ï¼Œä¾‹å¦‚ï¼š`MixedCaps`æˆ–è€…`mixedCaps`ã€‚
- ä»£ç ç”Ÿæˆå·¥å…·è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç (å¦‚`xxxx.pb.go`)å’Œä¸ºäº†å¯¹ç›¸å…³æµ‹è¯•ç”¨ä¾‹è¿›è¡Œåˆ†ç»„ï¼Œè€Œé‡‡ç”¨çš„ä¸‹åˆ’çº¿(å¦‚`TestMyFunction_WhatIsBeingTested`)æ’é™¤æ­¤è§„åˆ™ã€‚

### 2.3 æ–‡ä»¶å‘½å

- æ–‡ä»¶åè¦ç®€çŸ­æœ‰æ„ä¹‰ã€‚
- æ–‡ä»¶ååº”å°å†™ï¼Œå¹¶ä½¿ç”¨ä¸‹åˆ’çº¿åˆ†å‰²å•è¯ã€‚

### 2.4 ç»“æ„ä½“å‘½å

- é‡‡ç”¨é©¼å³°å‘½åæ–¹å¼ï¼Œé¦–å­—æ¯æ ¹æ®è®¿é—®æ§åˆ¶å†³å®šä½¿ç”¨å¤§å†™æˆ–å°å†™ï¼Œä¾‹å¦‚`MixedCaps`æˆ–è€…`mixedCaps`ã€‚
- ç»“æ„ä½“åä¸åº”è¯¥æ˜¯åŠ¨è¯ï¼Œåº”è¯¥æ˜¯åè¯ï¼Œæ¯”å¦‚ `Node`ã€`NodeSpec`ã€‚
- é¿å…ä½¿ç”¨Dataã€Infoè¿™ç±»æ— æ„ä¹‰çš„ç»“æ„ä½“åã€‚
- ç»“æ„ä½“çš„å£°æ˜å’Œåˆå§‹åŒ–åº”é‡‡ç”¨å¤šè¡Œï¼Œä¾‹å¦‚ï¼š

```go
// User å¤šè¡Œå£°æ˜
type User struct {
    Name  string
    Email string
}

// å¤šè¡Œåˆå§‹åŒ–
u := User{
    UserName: "belm",
    Email:    "nosbelm@qq.com",
}
```

### 2.5 æ¥å£å‘½å

- æ¥å£å‘½åçš„è§„åˆ™ï¼ŒåŸºæœ¬å’Œç»“æ„ä½“å‘½åè§„åˆ™ä¿æŒä¸€è‡´ï¼š
	- å•ä¸ªå‡½æ•°çš„æ¥å£åä»¥ â€œer"â€ä½œä¸ºåç¼€ï¼ˆä¾‹å¦‚Readerï¼ŒWriterï¼‰ï¼Œæœ‰æ—¶å€™å¯èƒ½å¯¼è‡´è¹©è„šçš„è‹±æ–‡ï¼Œä½†æ˜¯æ²¡å…³ç³»ã€‚
	- ä¸¤ä¸ªå‡½æ•°çš„æ¥å£åä»¥ä¸¤ä¸ªå‡½æ•°åå‘½åï¼Œä¾‹å¦‚ReadWriterã€‚
	- ä¸‰ä¸ªä»¥ä¸Šå‡½æ•°çš„æ¥å£åï¼Œç±»ä¼¼äºç»“æ„ä½“åã€‚

**ä¾‹å¦‚**ï¼š

```go
// Seeking to an offset before the start of the file is an error.
// Seeking to any positive offset is legal, but the behavior of subsequent
// I/O operations on the underlying object is implementation-dependent.
type Seeker interface {
    Seek(offset int64, whence int) (int64, error)
}

// ReadWriter is the interface that groups the basic Read and Write methods.
type ReadWriter interface {
    Reader
    Writer
}
```

### 2.6 å˜é‡å‘½å

- å˜é‡åå¿…é¡»éµå¾ªé©¼å³°å¼ï¼Œé¦–å­—æ¯æ ¹æ®è®¿é—®æ§åˆ¶å†³å®šä½¿ç”¨å¤§å†™æˆ–å°å†™ã€‚
- åœ¨ç›¸å¯¹ç®€å•ï¼ˆå¯¹è±¡æ•°é‡å°‘ã€é’ˆå¯¹æ€§å¼ºï¼‰çš„ç¯å¢ƒä¸­ï¼Œå¯ä»¥å°†ä¸€äº›åç§°ç”±å®Œæ•´å•è¯ç®€å†™ä¸ºå•ä¸ªå­—æ¯ï¼Œä¾‹å¦‚ï¼š
	- user å¯ä»¥ç®€å†™ä¸º uï¼›
	- userID å¯ä»¥ç®€å†™ uidã€‚
- ç‰¹æœ‰åè¯æ—¶ï¼Œéœ€è¦éµå¾ªä»¥ä¸‹è§„åˆ™ï¼š
	- å¦‚æœå˜é‡ä¸ºç§æœ‰ï¼Œä¸”ç‰¹æœ‰åè¯ä¸ºé¦–ä¸ªå•è¯ï¼Œåˆ™ä½¿ç”¨å°å†™ï¼Œå¦‚ apiClientã€‚
	- å…¶ä»–æƒ…å†µéƒ½åº”å½“ä½¿ç”¨è¯¥åè¯åŸæœ‰çš„å†™æ³•ï¼Œå¦‚ APIClientã€repoIDã€UserIDã€‚

ä¸‹é¢åˆ—ä¸¾äº†ä¸€äº›å¸¸è§çš„ç‰¹æœ‰åè¯ã€‚

```bash
// A GonicMapper that contains a list of common initialisms taken from golang/lint
var LintGonicMapper = GonicMapper{
    "API":   true,
    "ASCII": true,
    "CPU":   true,
    "CSS":   true,
    "DNS":   true,
    "EOF":   true,
    "GUID":  true,
    "HTML":  true,
    "HTTP":  true,
    "HTTPS": true,
    "ID":    true,
    "IP":    true,
    "JSON":  true,
    "LHS":   true,
    "QPS":   true,
    "RAM":   true,
    "RHS":   true,
    "RPC":   true,
    "SLA":   true,
    "SMTP":  true,
    "SSH":   true,
    "TLS":   true,
    "TTL":   true,
    "UI":    true,
    "UID":   true,
    "UUID":  true,
    "URI":   true,
    "URL":   true,
    "UTF8":  true,
    "VM":    true,
    "XML":   true,
    "XSRF":  true,
    "XSS":   true,
}
```

- è‹¥å˜é‡ç±»å‹ä¸ºboolç±»å‹ï¼Œåˆ™åç§°åº”ä»¥Hasï¼ŒIsï¼ŒCanæˆ–Allowå¼€å¤´ï¼Œä¾‹å¦‚ï¼š

```go
var hasConflict bool
var isExist bool
var canManage bool
var allowGitHook bool
```

- å±€éƒ¨å˜é‡åº”å½“å°½å¯èƒ½çŸ­å°ï¼Œæ¯”å¦‚ä½¿ç”¨bufæŒ‡ä»£bufferï¼Œä½¿ç”¨iæŒ‡ä»£indexã€‚
- ä»£ç ç”Ÿæˆå·¥å…·è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç å¯æ’é™¤æ­¤è§„åˆ™(å¦‚`xxx.pb.go`é‡Œé¢çš„Id)

### 2.7 å¸¸é‡å‘½å

- å¸¸é‡åå¿…é¡»éµå¾ªé©¼å³°å¼ï¼Œé¦–å­—æ¯æ ¹æ®è®¿é—®æ§åˆ¶å†³å®šä½¿ç”¨å¤§å†™æˆ–å°å†™ã€‚
- å¦‚æœæ˜¯æšä¸¾ç±»å‹çš„å¸¸é‡ï¼Œéœ€è¦å…ˆåˆ›å»ºç›¸åº”ç±»å‹ï¼š

```go
// Code defines an error code type.
type Code int

// Internal errors.
const (
    // ErrUnknown - 0: An unknown error occurred.
    ErrUnknown Code = iota
    // ErrFatal - 1: An fatal error occurred.
    ErrFatal
)
```

### 2.8 Errorçš„å‘½å

- Errorç±»å‹åº”è¯¥å†™æˆFooErrorçš„å½¢å¼ã€‚

```go
type ExitError struct {
	// ....
}
```

- Errorå˜é‡å†™æˆErrFooçš„å½¢å¼ã€‚

```go
var ErrFormat = errors.New("unknown format")
```

## 3. æ³¨é‡Šè§„èŒƒ

- æ¯ä¸ªå¯å¯¼å‡ºçš„åå­—éƒ½è¦æœ‰æ³¨é‡Šï¼Œè¯¥æ³¨é‡Šå¯¹å¯¼å‡ºçš„å˜é‡ã€å‡½æ•°ã€ç»“æ„ä½“ã€æ¥å£ç­‰è¿›è¡Œç®€è¦ä»‹ç»ã€‚
- å…¨éƒ¨ä½¿ç”¨å•è¡Œæ³¨é‡Šï¼Œç¦æ­¢ä½¿ç”¨å¤šè¡Œæ³¨é‡Šã€‚
- å’Œä»£ç çš„è§„èŒƒä¸€æ ·ï¼Œå•è¡Œæ³¨é‡Šä¸è¦è¿‡é•¿ï¼Œç¦æ­¢è¶…è¿‡ 120 å­—ç¬¦ï¼Œè¶…è¿‡çš„è¯·ä½¿ç”¨æ¢è¡Œå±•ç¤ºï¼Œå°½é‡ä¿æŒæ ¼å¼ä¼˜é›…ã€‚
- æ³¨é‡Šå¿…é¡»æ˜¯å®Œæ•´çš„å¥å­ï¼Œä»¥éœ€è¦æ³¨é‡Šçš„å†…å®¹ä½œä¸ºå¼€å¤´ï¼Œå¥ç‚¹ä½œä¸ºç»“å°¾ï¼Œ`æ ¼å¼ä¸º // åç§° æè¿°.`ã€‚ä¾‹å¦‚ï¼š

```go
// bad
// logs the flags in the flagset.
func PrintFlags(flags *pflag.FlagSet) {
	// normal code
}

// good
// PrintFlags logs the flags in the flagset.
func PrintFlags(flags *pflag.FlagSet) {
	// normal code
}
```

- æ‰€æœ‰æ³¨é‡Šæ‰çš„ä»£ç åœ¨æäº¤code reviewå‰éƒ½åº”è¯¥è¢«åˆ é™¤ï¼Œå¦åˆ™åº”è¯¥è¯´æ˜ä¸ºä»€ä¹ˆä¸åˆ é™¤ï¼Œå¹¶ç»™å‡ºåç»­å¤„ç†å»ºè®®ã€‚

- åœ¨å¤šæ®µæ³¨é‡Šä¹‹é—´å¯ä»¥ä½¿ç”¨ç©ºè¡Œåˆ†éš”åŠ ä»¥åŒºåˆ†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```go
// Package superman implements methods for saving the world.
//
// Experience has shown that a small number of procedures can prove
// helpful when attempting to save the world.
package superman
```

### 3.1 åŒ…æ³¨é‡Š

- æ¯ä¸ªåŒ…éƒ½æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªåŒ…çº§åˆ«çš„æ³¨é‡Šã€‚
- åŒ…æ³¨é‡Šç»Ÿä¸€ç”¨ // è¿›è¡Œæ³¨é‡Šï¼Œæ ¼å¼ä¸º `// Package åŒ…å åŒ…æè¿°`ï¼Œä¾‹å¦‚ï¼š

```go
// Package genericclioptions contains flags which can be added to you command, bound, completed, and produce
// useful helper functions.
package genericclioptions
```

### 3.2 å˜é‡/å¸¸é‡æ³¨é‡Š

- æ¯ä¸ªå¯å¯¼å‡ºçš„å˜é‡/å¸¸é‡éƒ½å¿…é¡»æœ‰æ³¨é‡Šè¯´æ˜ï¼Œ`æ ¼å¼ä¸º// å˜é‡å å˜é‡æè¿°`ï¼Œä¾‹å¦‚ï¼š

```go
// ErrSigningMethod defines invalid signing method error.
var ErrSigningMethod = errors.New("Invalid signing method")
```
- å‡ºç°å¤§å—å¸¸é‡æˆ–å˜é‡å®šä¹‰æ—¶ï¼Œå¯åœ¨å‰é¢æ³¨é‡Šä¸€ä¸ªæ€»çš„è¯´æ˜ï¼Œç„¶ååœ¨æ¯ä¸€è¡Œå¸¸é‡çš„å‰ä¸€è¡Œæˆ–æœ«å°¾è¯¦ç»†æ³¨é‡Šè¯¥å¸¸é‡çš„å®šä¹‰ï¼Œä¾‹å¦‚ï¼š
```go
// Code must start with 1xxxxx.
const (
    // ErrSuccess - 200: OK.
    ErrSuccess int = iota + 100001

    // ErrUnknown - 500: Internal server error.
    ErrUnknown

    // ErrBind - 400: Error occurred while binding the request body to the struct.
    ErrBind

    // ErrValidation - 400: Validation failed.
    ErrValidation
)
```
### 3.3 ç»“æ„ä½“æ³¨é‡Š

- æ¯ä¸ªéœ€è¦å¯¼å‡ºçš„ç»“æ„ä½“æˆ–è€…æ¥å£éƒ½å¿…é¡»æœ‰æ³¨é‡Šè¯´æ˜ï¼Œæ ¼å¼ä¸º `// ç»“æ„ä½“å ç»“æ„ä½“æè¿°.`ã€‚
- ç»“æ„ä½“å†…çš„å¯å¯¼å‡ºæˆå‘˜å˜é‡åï¼Œå¦‚æœæ„ä¹‰ä¸æ˜ç¡®ï¼Œå¿…é¡»è¦ç»™å‡ºæ³¨é‡Šï¼Œæ”¾åœ¨æˆå‘˜å˜é‡çš„å‰ä¸€è¡Œæˆ–åŒä¸€è¡Œçš„æœ«å°¾ã€‚ä¾‹å¦‚ï¼š

```go
// User represents a user restful resource. It is also used as gorm model.
type User struct {
    // Standard object's metadata.
    metav1.ObjectMeta `json:"metadata,omitempty"`

    Nickname string `json:"nickname" gorm:"column:nickname"`
    Password string `json:"password" gorm:"column:password"`
    Email    string `json:"email" gorm:"column:email"`
    Phone    string `json:"phone" gorm:"column:phone"`
    IsAdmin  int    `json:"isAdmin,omitempty" gorm:"column:isAdmin"`
}
```

### 3.4 æ–¹æ³•æ³¨é‡Š

æ¯ä¸ªéœ€è¦å¯¼å‡ºçš„å‡½æ•°æˆ–è€…æ–¹æ³•éƒ½å¿…é¡»æœ‰æ³¨é‡Šï¼Œæ ¼å¼ä¸º// å‡½æ•°å å‡½æ•°æè¿°.ï¼Œä¾‹å¦‚ï¼š

```go
// BeforeUpdate run before update database record.
func (p *Policy) BeforeUpdate() (err error) {
	// normal code
	return nil
}
```

### 3.5 ç±»å‹æ³¨é‡Š

- æ¯ä¸ªéœ€è¦å¯¼å‡ºçš„ç±»å‹å®šä¹‰å’Œç±»å‹åˆ«åéƒ½å¿…é¡»æœ‰æ³¨é‡Šè¯´æ˜ï¼Œæ ¼å¼ä¸º `// ç±»å‹å ç±»å‹æè¿°.`ï¼Œä¾‹å¦‚ï¼š

```go
// Code defines an error code type.
type Code int
```

## 4. ç±»å‹

### 4.1 å­—ç¬¦ä¸²

- ç©ºå­—ç¬¦ä¸²åˆ¤æ–­ã€‚

```go
// bad
if s == "" {
    // normal code
}

// good
if len(s) == 0 {
    // normal code
}
```

- `[]byte`/`string`ç›¸ç­‰æ¯”è¾ƒã€‚

```go
// bad
var s1 []byte
var s2 []byte
...
bytes.Equal(s1, s2) == 0
bytes.Equal(s1, s2) != 0

// good
var s1 []byte
var s2 []byte
...
bytes.Compare(s1, s2) == 0
bytes.Compare(s1, s2) != 0
```

- å¤æ‚å­—ç¬¦ä¸²ä½¿ç”¨rawå­—ç¬¦ä¸²é¿å…å­—ç¬¦è½¬ä¹‰ã€‚

```go
// bad
regexp.MustCompile("\\.")

// good
regexp.MustCompile(`\.`)
```

### 4.2 åˆ‡ç‰‡

- ç©ºsliceåˆ¤æ–­ã€‚

```go
// bad
if len(slice) = 0 {
    // normal code
}

// good
if slice != nil && len(slice) == 0 {
    // normal code
}
```

ä¸Šé¢åˆ¤æ–­åŒæ ·é€‚ç”¨äºmapã€channelã€‚

- å£°æ˜sliceã€‚

```go
// bad
s := []string{}
s := make([]string, 0)

// good
var s []string
```

- sliceå¤åˆ¶ã€‚

```go
// bad
var b1, b2 []byte
for i, v := range b1 {
   b2[i] = v
}
for i := range b1 {
   b2[i] = b1[i]
}

// good
copy(b2, b1)
```

- sliceæ–°å¢ã€‚

```go
// bad
var a, b []int
for _, v := range a {
    b = append(b, v)
}

// good
var a, b []int
b = append(b, a...)
```

### 4.3 ç»“æ„ä½“

- structåˆå§‹åŒ–ã€‚

structä»¥å¤šè¡Œæ ¼å¼åˆå§‹åŒ–ã€‚

```go
type user struct {
	Id   int64
	Name string
}

u1 := user{100, "Colin"}

u2 := user{
    Id:   200,
    Name: "Lex",
}
```

## 5. æ§åˆ¶ç»“æ„

### 5.1 if

- if æ¥å—åˆå§‹åŒ–è¯­å¥ï¼Œçº¦å®šå¦‚ä¸‹æ–¹å¼å»ºç«‹å±€éƒ¨å˜é‡ã€‚

```go
if err := loadConfig(); err != nil {
	// error handling
	return err
}
```

- if å¯¹äºboolç±»å‹çš„å˜é‡ï¼Œåº”ç›´æ¥è¿›è¡ŒçœŸå‡åˆ¤æ–­ã€‚

```go
var isAllow bool
if isAllow {
	// normal code
}
```

### 5.2 for

- é‡‡ç”¨çŸ­å£°æ˜å»ºç«‹å±€éƒ¨å˜é‡ã€‚

```go
sum := 0
for i := 0; i < 10; i++ {
    sum += 1
}
```

- ä¸è¦åœ¨ for å¾ªç¯é‡Œé¢ä½¿ç”¨ deferï¼Œdeferåªæœ‰åœ¨å‡½æ•°é€€å‡ºæ—¶æ‰ä¼šæ‰§è¡Œã€‚

```go
// bad
for file := range files {
	fd, err := os.Open(file)
	if err != nil {
		return err
	}
	defer fd.Close()
	// normal code
}

// good
for file := range files {
	func() {
		fd, err := os.Open(file)
		if err != nil {
			return err
		}
		defer fd.Close()
		// normal code
	}()
}
```

### 5.3 range

- å¦‚æœåªéœ€è¦ç¬¬ä¸€é¡¹ï¼ˆkeyï¼‰ï¼Œå°±ä¸¢å¼ƒç¬¬äºŒä¸ªã€‚

```go
for key := range keys {
// normal code
}
```

- å¦‚æœåªéœ€è¦ç¬¬äºŒé¡¹ï¼Œåˆ™æŠŠç¬¬ä¸€é¡¹ç½®ä¸ºä¸‹åˆ’çº¿ã€‚

```go
sum := 0
for _, value := range array {
    sum += value
}
```

### 5.4 switch

- å¿…é¡»è¦æœ‰defaultã€‚

```go
switch os := runtime.GOOS; os {
    case "linux":
        fmt.Println("Linux.")
    case "darwin":
        fmt.Println("OS X.")
    default:
        fmt.Printf("%s.\n", os)
}
```

### 5.5 goto
- ä¸šåŠ¡ä»£ç ç¦æ­¢ä½¿ç”¨ goto ã€‚
- æ¡†æ¶æˆ–å…¶ä»–åº•å±‚æºç å°½é‡ä¸ç”¨ã€‚

## 6. å‡½æ•°

- ä¼ å…¥å˜é‡å’Œè¿”å›å˜é‡ä»¥å°å†™å­—æ¯å¼€å¤´ã€‚
- å‡½æ•°å‚æ•°ä¸ªæ•°ä¸èƒ½è¶…è¿‡5ä¸ªã€‚
- å‡½æ•°åˆ†ç»„ä¸é¡ºåº
- å‡½æ•°åº”æŒ‰ç²—ç•¥çš„è°ƒç”¨é¡ºåºæ’åºã€‚
- åŒä¸€æ–‡ä»¶ä¸­çš„å‡½æ•°åº”æŒ‰æ¥æ”¶è€…åˆ†ç»„ã€‚
- å°½é‡é‡‡ç”¨å€¼ä¼ é€’ï¼Œè€ŒéæŒ‡é’ˆä¼ é€’ã€‚
- ä¼ å…¥å‚æ•°æ˜¯ mapã€sliceã€chanã€interface ï¼Œä¸è¦ä¼ é€’æŒ‡é’ˆã€‚

### 6.1 å‡½æ•°å‚æ•°

- å¦‚æœå‡½æ•°è¿”å›ç›¸åŒç±»å‹çš„ä¸¤ä¸ªæˆ–ä¸‰ä¸ªå‚æ•°ï¼Œæˆ–è€…å¦‚æœä»ä¸Šä¸‹æ–‡ä¸­ä¸æ¸…æ¥šç»“æœçš„å«ä¹‰ï¼Œä½¿ç”¨å‘½åè¿”å›ï¼Œå…¶ä»–æƒ…å†µä¸å»ºè®®ä½¿ç”¨å‘½åè¿”å›ï¼Œä¾‹å¦‚ï¼š

```go
func coordinate() (x, y float64, err error) {
	// normal code
}
```
- ä¼ å…¥å˜é‡å’Œè¿”å›å˜é‡éƒ½ä»¥å°å†™å­—æ¯å¼€å¤´ã€‚
- å°½é‡ç”¨å€¼ä¼ é€’ï¼ŒéæŒ‡é’ˆä¼ é€’ã€‚
- å‚æ•°æ•°é‡å‡ä¸èƒ½è¶…è¿‡5ä¸ªã€‚
- å¤šè¿”å›å€¼æœ€å¤šè¿”å›ä¸‰ä¸ªï¼Œè¶…è¿‡ä¸‰ä¸ªè¯·ä½¿ç”¨ structã€‚

### 6.2 defer

- å½“å­˜åœ¨èµ„æºåˆ›å»ºæ—¶ï¼Œåº”ç´§è·Ÿdeferé‡Šæ”¾èµ„æº(å¯ä»¥å¤§èƒ†ä½¿ç”¨deferï¼Œdeferåœ¨Go1.14ç‰ˆæœ¬ä¸­ï¼Œæ€§èƒ½å¤§å¹…æå‡ï¼Œdeferçš„æ€§èƒ½æŸè€—å³ä½¿åœ¨æ€§èƒ½æ•æ„Ÿå‹çš„ä¸šåŠ¡ä¸­ï¼Œä¹Ÿå¯ä»¥å¿½ç•¥)ã€‚
- å…ˆåˆ¤æ–­æ˜¯å¦é”™è¯¯ï¼Œå†deferé‡Šæ”¾èµ„æºï¼Œä¾‹å¦‚ï¼š

```go
rep, err := http.Get(url)
if err != nil {
    return err
}

defer resp.Body.Close()
```

### 6.3 æ–¹æ³•çš„æ¥æ”¶å™¨

- æ¨èä»¥ç±»åç¬¬ä¸€ä¸ªè‹±æ–‡é¦–å­—æ¯çš„å°å†™ä½œä¸ºæ¥æ”¶å™¨çš„å‘½åã€‚
- æ¥æ”¶å™¨çš„å‘½ååœ¨å‡½æ•°è¶…è¿‡20è¡Œçš„æ—¶å€™ä¸è¦ç”¨å•å­—ç¬¦ã€‚
- æ¥æ”¶å™¨çš„å‘½åä¸èƒ½é‡‡ç”¨meã€thisã€selfè¿™ç±»æ˜“æ··æ·†åç§°ã€‚

### 6.4 åµŒå¥—
- åµŒå¥—æ·±åº¦ä¸èƒ½è¶…è¿‡4å±‚ã€‚

### 6.5 å˜é‡å‘½å
- å˜é‡å£°æ˜å°½é‡æ”¾åœ¨å˜é‡ç¬¬ä¸€æ¬¡ä½¿ç”¨çš„å‰é¢ï¼Œéµå¾ªå°±è¿‘åŸåˆ™ã€‚
- å¦‚æœé­”æ³•æ•°å­—å‡ºç°è¶…è¿‡ä¸¤æ¬¡ï¼Œåˆ™ç¦æ­¢ä½¿ç”¨ï¼Œæ”¹ç”¨ä¸€ä¸ªå¸¸é‡ä»£æ›¿ï¼Œä¾‹å¦‚ï¼š

```go
// PI ...
const Prise = 3.14

func getAppleCost(n float64) float64 {
	return Prise * n
}

func getOrangeCost(n float64) float64 {
	return Prise * n
}
```

## 7. GOPATH è®¾ç½®è§„èŒƒ
- Go 1.11 ä¹‹åï¼Œå¼±åŒ–äº† GOPATH è§„åˆ™ï¼Œå·²æœ‰ä»£ç ï¼ˆå¾ˆå¤šåº“è‚¯å®šæ˜¯åœ¨1.11ä¹‹å‰å»ºç«‹çš„ï¼‰è‚¯å®šç¬¦åˆè¿™ä¸ªè§„åˆ™ï¼Œå»ºè®®ä¿ç•™ GOPATH è§„åˆ™ï¼Œä¾¿äºç»´æŠ¤ä»£ç ã€‚
- å»ºè®®åªä½¿ç”¨ä¸€ä¸ª GOPATHï¼Œä¸å»ºè®®ä½¿ç”¨å¤šä¸ª GOPATHã€‚å¦‚æœä½¿ç”¨å¤šä¸ªGOPATHï¼Œç¼–è¯‘ç”Ÿæ•ˆçš„ bin ç›®å½•æ˜¯åœ¨ç¬¬ä¸€ä¸ª GOPATH ä¸‹ã€‚

## 8. ä¾èµ–ç®¡ç†

- Go 1.11 ä»¥ä¸Šå¿…é¡»ä½¿ç”¨ Go Modulesã€‚
- ä½¿ç”¨Go Modulesä½œä¸ºä¾èµ–ç®¡ç†çš„é¡¹ç›®æ—¶ï¼Œä¸å»ºè®®æäº¤vendorç›®å½•ã€‚
- ä½¿ç”¨Go Modulesä½œä¸ºä¾èµ–ç®¡ç†çš„é¡¹ç›®æ—¶ï¼Œå¿…é¡»æäº¤go.sumæ–‡ä»¶ã€‚

### 9. æœ€ä½³å®è·µ

- å°½é‡å°‘ç”¨å…¨å±€å˜é‡ï¼Œè€Œæ˜¯é€šè¿‡å‚æ•°ä¼ é€’ï¼Œä½¿æ¯ä¸ªå‡½æ•°éƒ½æ˜¯â€œæ— çŠ¶æ€â€çš„ã€‚è¿™æ ·å¯ä»¥å‡å°‘è€¦åˆï¼Œä¹Ÿæ–¹ä¾¿åˆ†å·¥å’Œå•å…ƒæµ‹è¯•ã€‚
- åœ¨ç¼–è¯‘æ—¶éªŒè¯æ¥å£çš„ç¬¦åˆæ€§ï¼Œä¾‹å¦‚ï¼š

```go
type LogHandler struct {
  h   http.Handler
  log *zap.Logger
}
var _ http.Handler = LogHandler{}
```
- æœåŠ¡å™¨å¤„ç†è¯·æ±‚æ—¶ï¼Œåº”è¯¥åˆ›å»ºä¸€ä¸ªcontextï¼Œä¿å­˜è¯¥è¯·æ±‚çš„ç›¸å…³ä¿¡æ¯ï¼ˆå¦‚requestIDï¼‰ï¼Œå¹¶åœ¨å‡½æ•°è°ƒç”¨é“¾ä¸­ä¼ é€’ã€‚

### 9.1 æ€§èƒ½
- string è¡¨ç¤ºçš„æ˜¯ä¸å¯å˜çš„å­—ç¬¦ä¸²å˜é‡ï¼Œå¯¹ string çš„ä¿®æ”¹æ˜¯æ¯”è¾ƒé‡çš„æ“ä½œï¼ŒåŸºæœ¬ä¸Šéƒ½éœ€è¦é‡æ–°ç”³è¯·å†…å­˜ã€‚æ‰€ä»¥ï¼Œå¦‚æœæ²¡æœ‰ç‰¹æ®Šéœ€è¦ï¼Œéœ€è¦ä¿®æ”¹æ—¶å¤šä½¿ç”¨ []byteã€‚
- ä¼˜å…ˆä½¿ç”¨ strconv è€Œä¸æ˜¯ fmtã€‚

### 9.2 æ³¨æ„äº‹é¡¹

- append è¦å°å¿ƒè‡ªåŠ¨åˆ†é…å†…å­˜ï¼Œappend è¿”å›çš„å¯èƒ½æ˜¯æ–°åˆ†é…çš„åœ°å€ã€‚
- å¦‚æœè¦ç›´æ¥ä¿®æ”¹ map çš„ value å€¼ï¼Œåˆ™ value åªèƒ½æ˜¯æŒ‡é’ˆï¼Œå¦åˆ™è¦è¦†ç›–åŸæ¥çš„å€¼ã€‚
- map åœ¨å¹¶å‘ä¸­éœ€è¦åŠ é”ã€‚
- ç¼–è¯‘è¿‡ç¨‹æ— æ³•æ£€æŸ¥ interface{} çš„è½¬æ¢ï¼Œåªèƒ½åœ¨è¿è¡Œæ—¶æ£€æŸ¥ï¼Œå°å¿ƒå¼•èµ· panicã€‚

## æ€»ç»“

è¿™é‡Œå‘ä½ ä»‹ç»äº†ä¹ç±»å¸¸ç”¨çš„ç¼–ç è§„èŒƒã€‚ä½†ä»Šå¤©çš„æœ€åï¼Œæˆ‘è¦åœ¨è¿™é‡Œæé†’ä½ ä¸€å¥ï¼šè§„èŒƒæ˜¯äººå®šçš„ï¼Œä½ ä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦ï¼Œåˆ¶å®šç¬¦åˆä½ é¡¹ç›®çš„è§„èŒƒï¼Œä½†åŒæ—¶æˆ‘ä¹Ÿå»ºè®®ä½ é‡‡çº³è¿™äº›ä¸šç•Œæ²‰æ·€ä¸‹æ¥çš„è§„èŒƒï¼Œå¹¶é€šè¿‡å·¥å…·æ¥ç¡®ä¿è§„èŒƒçš„æ‰§è¡Œã€‚



## æ€»ç»“

è¿™ä¸€è®²ï¼Œæˆ‘å‘ä½ ä»‹ç»äº†ä¹ç±»å¸¸ç”¨çš„ç¼–ç è§„èŒƒã€‚ä½†ä»Šå¤©çš„æœ€åï¼Œæˆ‘è¦åœ¨è¿™é‡Œæé†’ä½ ä¸€å¥ï¼šè§„èŒƒæ˜¯äººå®šçš„ï¼Œä½ ä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦ï¼Œåˆ¶å®šç¬¦åˆä½ é¡¹ç›®çš„è§„èŒƒã€‚è¿™ä¹Ÿæ˜¯æˆ‘åœ¨ä¹‹å‰çš„è¯¾ç¨‹é‡Œä¸€ç›´å¼ºè°ƒçš„æ€è·¯ã€‚ä½†åŒæ—¶æˆ‘ä¹Ÿå»ºè®®ä½ é‡‡çº³è¿™äº›ä¸šç•Œæ²‰æ·€ä¸‹æ¥çš„è§„èŒƒï¼Œå¹¶é€šè¿‡å·¥å…·æ¥ç¡®ä¿è§„èŒƒçš„æ‰§è¡Œã€‚



## END é“¾æ¥
<ul><li><div><a href = '43.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—  </a><a href = '45.md' style='float: right'>  ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div></li></ul>

+ [â“‚ï¸å›åˆ°ç›®å½•ğŸ ](../README.md)

+ [**ğŸ«µå‚ä¸è´¡çŒ®ğŸ’â¤ï¸â€ğŸ”¥ğŸ’–**](https://nsddd.top/archives/contributors))

+ âœ´ï¸ç‰ˆæƒå£°æ˜ &copy; ï¼šæœ¬ä¹¦æ‰€æœ‰å†…å®¹éµå¾ª[CC-BY-SA 3.0åè®®ï¼ˆç½²å-ç›¸åŒæ–¹å¼å…±äº«ï¼‰&copy;](http://zh.wikipedia.org/wiki/Wikipedia:CC-by-sa-3.0åè®®æ–‡æœ¬) 

