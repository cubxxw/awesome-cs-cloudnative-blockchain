[toc]

ğŸ˜¶â€ğŸŒ«ï¸goè¯­è¨€å®˜æ–¹ç¼–ç¨‹æŒ‡å—ï¼š[https://golang.org/#](https://golang.org/#)  

>   goè¯­è¨€çš„å®˜æ–¹æ–‡æ¡£å­¦ä¹ ç¬”è®°å¾ˆå…¨ï¼Œæ¨èå»å®˜ç½‘å­¦ä¹ 

ğŸ˜¶â€ğŸŒ«ï¸æˆ‘çš„å­¦ä¹ ç¬”è®°ï¼šgithub: [https://github.com/3293172751/golang-rearn](https://github.com/3293172751/golang-rearn)

---

**åŒºå—é“¾æŠ€æœ¯ï¼ˆä¹Ÿç§°ä¹‹ä¸ºåˆ†å¸ƒå¼è´¦æœ¬æŠ€æœ¯ï¼‰**ï¼Œæ˜¯ä¸€ç§äº’è”ç½‘æ•°æ®åº“æŠ€æœ¯ï¼Œå…¶ç‰¹ç‚¹æ˜¯å»ä¸­å¿ƒåŒ–ï¼Œå…¬å¼€é€æ˜ï¼Œè®©æ¯ä¸€ä¸ªäººå‡å¯å‚ä¸çš„æ•°æ®åº“è®°å½•

>   â¤ï¸ğŸ’•ğŸ’•å…³äºåŒºå—é“¾æŠ€æœ¯ï¼Œå¯ä»¥å…³æ³¨æˆ‘ï¼Œå…±åŒå­¦ä¹ æ›´å¤šçš„åŒºå—é“¾æŠ€æœ¯ã€‚åšå®¢[http://nsddd.top](http://nsddd.top)

---

## 45å¤©å­¦ä¼šgo --ç¬¬åå…« Goè¯­è¨€åå°„

> æ¯”å¦‚åœ¨å†™é€‚é…å™¨å‡½æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ­¤æ—¶å°±éœ€è¦ç”¨åˆ°åå°„æ ‡è®°

### åå°„çš„åŸºæœ¬ä»‹ç»

1. **åå°„å¯ä»¥åœ¨è¿è¡Œçš„æ—¶å€™åŠ¨æ€è·å–å˜é‡çš„å„ç§ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´å˜é‡çš„ç±»å‹ï¼ˆtype),ç±»åˆ«(kind)**
2. **å¦‚æœæ˜¯ç»“æ„ä½“å˜é‡ï¼Œè¿˜å¯ä»¥è·å–åˆ°ç»“æ„ä½“æœ¬èº«çš„ä¿¡æ¯ï¼ˆåŒ…æ‹¬ç»“æ„ä½“çš„å­—æ®µï¼Œæ–¹æ³•ï¼‰**
3. **é€šè¿‡åå°„ï¼Œå¯ä»¥ä¿®æ”¹å˜é‡çš„å€¼ï¼Œå¯ä»¥è°ƒç”¨å…³è”çš„æ–¹æ³•**
4. **ä½¿ç”¨åå°„ï¼Œéœ€è¦ç”¨åˆ°ä¸€ä¸ªåŒ…import(â€œreflectâ€)**

---

**[ğŸ–±ï¸ æ‰“å¼€åŒ…ç½‘é¡µ](https://pkg.go.dev/std)**

`package reflect`**åŒ…**

> ==åŒ…åå°„å®ç°è¿è¡Œæ—¶åå°„==ï¼Œå…è®¸ç¨‹åºæ“ä½œä»»æ„ç±»å‹çš„å¯¹è±¡ã€‚å…¸å‹çš„ç”¨æ³•æ˜¯å–ä¸€ä¸ªé™æ€ç±»å‹ interface{} çš„å€¼ï¼Œé€šè¿‡è°ƒç”¨ TypeOf æå–å…¶åŠ¨æ€ç±»å‹ä¿¡æ¯ï¼Œè¿”å›ä¸€ä¸ª Typeã€‚
>
> å¯¹ ValueOf çš„è°ƒç”¨ä¼šè¿”å›ä¸€ä¸ªè¡¨ç¤ºè¿è¡Œæ—¶æ•°æ®çš„å€¼ã€‚Zero æ¥å—ä¸€ä¸ª Type å¹¶è¿”å›ä¸€ä¸ª Valueï¼Œè¡¨ç¤ºè¯¥ç±»å‹çš„é›¶å€¼ã€‚

**æ‰€ä»¥åå°„æˆ‘ä»¬å¯ä»¥å–å‡ºå€¼ä½†æ˜¯æ²¡æœ‰åŠæ³•è¿›è¡Œæ“ä½œï¼Œç¼–è¯‘å™¨é€šä¸è¿‡ï¼Œæ­¤æ—¶éœ€è¦è¿›è¡Œæ–­è¨€**

**æˆ‘ä»¬é€šè¿‡åå°„è·å–åˆ°type**

#### type [Type](https://cs.opensource.google/go/go/+/go1.18:src/reflect/type.go;l=39) [Â¶](https://pkg.go.dev/reflect@go1.18#Type)

```go
type Type interface {
    // Kindè¿”å›è¯¥æ¥å£çš„å…·ä½“åˆ†ç±»
    Kind() Kind
    // Nameè¿”å›è¯¥ç±»å‹åœ¨è‡ªèº«åŒ…å†…çš„ç±»å‹åï¼Œå¦‚æœæ˜¯æœªå‘½åç±»å‹ä¼šè¿”å›""
    Name() string
    // PkgPathè¿”å›ç±»å‹çš„åŒ…è·¯å¾„ï¼Œå³æ˜ç¡®æŒ‡å®šåŒ…çš„importè·¯å¾„ï¼Œå¦‚"encoding/base64"
    // å¦‚æœç±»å‹ä¸ºå†…å»ºç±»å‹(string, error)æˆ–æœªå‘½åç±»å‹(*T, struct{}, []int)ï¼Œä¼šè¿”å›""
    PkgPath() string
    // è¿”å›ç±»å‹çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚è¯¥å­—ç¬¦ä¸²å¯èƒ½ä¼šä½¿ç”¨çŸ­åŒ…åï¼ˆå¦‚ç”¨base64ä»£æ›¿"encoding/base64"ï¼‰
    // ä¹Ÿä¸ä¿è¯æ¯ä¸ªç±»å‹çš„å­—ç¬¦ä¸²è¡¨ç¤ºä¸åŒã€‚å¦‚æœè¦æ¯”è¾ƒä¸¤ä¸ªç±»å‹æ˜¯å¦ç›¸ç­‰ï¼Œè¯·ç›´æ¥ç”¨Typeç±»å‹æ¯”è¾ƒã€‚
    String() string
    // è¿”å›è¦ä¿å­˜ä¸€ä¸ªè¯¥ç±»å‹çš„å€¼éœ€è¦å¤šå°‘å­—èŠ‚ï¼›ç±»ä¼¼unsafe.Sizeof
    Size() uintptr
    // è¿”å›å½“ä»å†…å­˜ä¸­ç”³è¯·ä¸€ä¸ªè¯¥ç±»å‹å€¼æ—¶ï¼Œä¼šå¯¹é½çš„å­—èŠ‚æ•°
    Align() int
    // è¿”å›å½“è¯¥ç±»å‹ä½œä¸ºç»“æ„ä½“çš„å­—æ®µæ—¶ï¼Œä¼šå¯¹é½çš„å­—èŠ‚æ•°
    FieldAlign() int
    // å¦‚æœè¯¥ç±»å‹å®ç°äº†uä»£è¡¨çš„æ¥å£ï¼Œä¼šè¿”å›çœŸ
    Implements(u Type) bool
    // å¦‚æœè¯¥ç±»å‹çš„å€¼å¯ä»¥ç›´æ¥èµ‹å€¼ç»™uä»£è¡¨çš„ç±»å‹ï¼Œè¿”å›çœŸ
    AssignableTo(u Type) bool
    // å¦‚è¯¥ç±»å‹çš„å€¼å¯ä»¥è½¬æ¢ä¸ºuä»£è¡¨çš„ç±»å‹ï¼Œè¿”å›çœŸ
    ConvertibleTo(u Type) bool
    // è¿”å›è¯¥ç±»å‹çš„å­—ä½æ•°ã€‚å¦‚æœè¯¥ç±»å‹çš„Kindä¸æ˜¯Intã€Uintã€Floatæˆ–Complexï¼Œä¼španic
    Bits() int
    // è¿”å›arrayç±»å‹çš„é•¿åº¦ï¼Œå¦‚éæ•°ç»„ç±»å‹å°†panic
    Len() int
    // è¿”å›è¯¥ç±»å‹çš„å…ƒç´ ç±»å‹ï¼Œå¦‚æœè¯¥ç±»å‹çš„Kindä¸æ˜¯Arrayã€Chanã€Mapã€Ptræˆ–Sliceï¼Œä¼španic
    Elem() Type
    // è¿”å›mapç±»å‹çš„é”®çš„ç±»å‹ã€‚å¦‚éæ˜ å°„ç±»å‹å°†panic
    Key() Type
    // è¿”å›ä¸€ä¸ªchannelç±»å‹çš„æ–¹å‘ï¼Œå¦‚éé€šé“ç±»å‹å°†ä¼španic
    ChanDir() ChanDir
    // è¿”å›structç±»å‹çš„å­—æ®µæ•°ï¼ˆåŒ¿åå­—æ®µç®—ä½œä¸€ä¸ªå­—æ®µï¼‰ï¼Œå¦‚éç»“æ„ä½“ç±»å‹å°†panic
    NumField() int
    // è¿”å›structç±»å‹çš„ç¬¬iä¸ªå­—æ®µçš„ç±»å‹ï¼Œå¦‚éç»“æ„ä½“æˆ–è€…iä¸åœ¨[0, NumField())å†…å°†ä¼španic
    Field(i int) StructField
    // è¿”å›ç´¢å¼•åºåˆ—æŒ‡å®šçš„åµŒå¥—å­—æ®µçš„ç±»å‹ï¼Œ
    // ç­‰ä»·äºç”¨ç´¢å¼•ä¸­æ¯ä¸ªå€¼é“¾å¼è°ƒç”¨æœ¬æ–¹æ³•ï¼Œå¦‚éç»“æ„ä½“å°†ä¼španic
    FieldByIndex(index []int) StructField
    // è¿”å›è¯¥ç±»å‹åä¸ºnameçš„å­—æ®µï¼ˆä¼šæŸ¥æ‰¾åŒ¿åå­—æ®µåŠå…¶å­å­—æ®µï¼‰ï¼Œ
    // å¸ƒå°”å€¼è¯´æ˜æ˜¯å¦æ‰¾åˆ°ï¼Œå¦‚éç»“æ„ä½“å°†panic
    FieldByName(name string) (StructField, bool)
    // è¿”å›è¯¥ç±»å‹ç¬¬ä¸€ä¸ªå­—æ®µåæ»¡è¶³å‡½æ•°matchçš„å­—æ®µï¼Œå¸ƒå°”å€¼è¯´æ˜æ˜¯å¦æ‰¾åˆ°ï¼Œå¦‚éç»“æ„ä½“å°†ä¼španic
    FieldByNameFunc(match func(string) bool) (StructField, bool)
    // å¦‚æœå‡½æ•°ç±»å‹çš„æœ€åä¸€ä¸ªè¾“å…¥å‚æ•°æ˜¯"..."å½¢å¼çš„å‚æ•°ï¼ŒIsVariadicè¿”å›çœŸ
    // å¦‚æœè¿™æ ·ï¼Œt.In(t.NumIn() - 1)è¿”å›å‚æ•°çš„éšå¼çš„å®é™…ç±»å‹ï¼ˆå£°æ˜ç±»å‹çš„åˆ‡ç‰‡ï¼‰
    // å¦‚éå‡½æ•°ç±»å‹å°†panic
    IsVariadic() bool
    // è¿”å›funcç±»å‹çš„å‚æ•°ä¸ªæ•°ï¼Œå¦‚æœä¸æ˜¯å‡½æ•°ï¼Œå°†ä¼španic
    NumIn() int
    // è¿”å›funcç±»å‹çš„ç¬¬iä¸ªå‚æ•°çš„ç±»å‹ï¼Œå¦‚éå‡½æ•°æˆ–è€…iä¸åœ¨[0, NumIn())å†…å°†ä¼španic
    In(i int) Type
    // è¿”å›funcç±»å‹çš„è¿”å›å€¼ä¸ªæ•°ï¼Œå¦‚æœä¸æ˜¯å‡½æ•°ï¼Œå°†ä¼španic
    NumOut() int
    // è¿”å›funcç±»å‹çš„ç¬¬iä¸ªè¿”å›å€¼çš„ç±»å‹ï¼Œå¦‚éå‡½æ•°æˆ–è€…iä¸åœ¨[0, NumOut())å†…å°†ä¼španic
    Out(i int) Type
    // è¿”å›è¯¥ç±»å‹çš„æ–¹æ³•é›†ä¸­æ–¹æ³•çš„æ•°ç›®
    // åŒ¿åå­—æ®µçš„æ–¹æ³•ä¼šè¢«è®¡ç®—ï¼›ä¸»ä½“ç±»å‹çš„æ–¹æ³•ä¼šå±è”½åŒ¿åå­—æ®µçš„åŒåæ–¹æ³•ï¼›
    // åŒ¿åå­—æ®µå¯¼è‡´çš„æ­§ä¹‰æ–¹æ³•ä¼šæ»¤é™¤
    NumMethod() int
    // è¿”å›è¯¥ç±»å‹æ–¹æ³•é›†ä¸­çš„ç¬¬iä¸ªæ–¹æ³•ï¼Œiä¸åœ¨[0, NumMethod())èŒƒå›´å†…æ—¶ï¼Œå°†å¯¼è‡´panic
    // å¯¹éæ¥å£ç±»å‹Tæˆ–*Tï¼Œè¿”å›å€¼çš„Typeå­—æ®µå’ŒFuncå­—æ®µæè¿°æ–¹æ³•çš„æœªç»‘å®šå‡½æ•°çŠ¶æ€
    // å¯¹æ¥å£ç±»å‹ï¼Œè¿”å›å€¼çš„Typeå­—æ®µæè¿°æ–¹æ³•çš„ç­¾åï¼ŒFuncå­—æ®µä¸ºnil
    Method(int) Method
    // æ ¹æ®æ–¹æ³•åè¿”å›è¯¥ç±»å‹æ–¹æ³•é›†ä¸­çš„æ–¹æ³•ï¼Œä½¿ç”¨ä¸€ä¸ªå¸ƒå°”å€¼è¯´æ˜æ˜¯å¦å‘ç°è¯¥æ–¹æ³•
    // å¯¹éæ¥å£ç±»å‹Tæˆ–*Tï¼Œè¿”å›å€¼çš„Typeå­—æ®µå’ŒFuncå­—æ®µæè¿°æ–¹æ³•çš„æœªç»‘å®šå‡½æ•°çŠ¶æ€
    // å¯¹æ¥å£ç±»å‹ï¼Œè¿”å›å€¼çš„Typeå­—æ®µæè¿°æ–¹æ³•çš„ç­¾åï¼ŒFuncå­—æ®µä¸ºnil
    MethodByName(string) (Method, bool)
    // å†…å«éšè—æˆ–éå¯¼å‡ºæ–¹æ³•
}
```

> é€šè¿‡åå°„æˆ‘ä»¬è·å–åˆ°`reflect.Type`ç±»å‹ï¼Œé€šè¿‡è¿™ä¸ªç±»å‹æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ–¹æ³•åå‘æ“ä½œ



### åå°„åº”ç”¨åœºæ™¯

##### 1. ä¸çŸ¥é“æ¥å£è°ƒç”¨çš„æ˜¯å“ªä¸ªå‡½æ•°

**2. å¯¹ç»“æ„ä½“åºåˆ—åŒ–æ—¶ï¼Œå¦‚æœç»“æ„ä½“æœ‰æŒ‡å®štag,ä¹Ÿä¼šä½¿ç”¨åˆ°åå°„ç”Ÿæˆå¯¹åº”çš„å­—ç¬¦ä¸²**



----

### åå°„é‡è¦æ¦‚å¿µâ¤ï¸ 

   1 . **reflect.TypeOf(å˜é‡å),è·å–å˜é‡ç±»å‹ï¼Œè¿”å›çš„æ˜¯reflect.Typeç±»å‹**

2. **reflect.ValueOf(å˜é‡å),è·å–å˜é‡çš„å€¼ï¼Œè¿”å›reflect.Valueç±»å‹ï¼Œæ˜¯ä¸€ä¸ªç»“æ„ä½“ç±»å‹ï¼Œé€šè¿‡å®ƒå¯ä»¥è·å–åˆ°è¯¥å˜é‡çš„æ›´å¤šä¿¡æ¯**

3. **å˜é‡ã€interface{}ï¼ˆç©ºæ¥å£ï¼‰å’Œreflect.Valueæ˜¯å¯ä»¥ç›¸äº’è½¬æ¢çš„ï¼Œè¿™ç‚¹åœ¨å®é™…å¼€å‘ä¸­ç»å¸¸ç”¨åˆ°**

```go
var student Stu //ç»“æ„ä½“
var num int    //å˜é‡

//ä¸“é—¨ç”¨ä½œåå°„å‡½æ•°
func test(b interface{}){
    //å¦‚ä½•å°†interfaceè½¬åŒ–ä¸ºreflect.Value
    rVal := reflect.ValueOf(b)
    
    //å¦‚ä½•å°†reflect.Valueè½¬æˆç©ºæ¥å£ç±»å‹
    iVal := rVal.interface()
    
    //å¦‚ä½•å°†interfaceç©ºæ¥å£è½¬ä¸ºåŸå˜é‡ç±»å‹ - - ä½¿ç”¨ç±»å‹æ–­è¨€å³å¯
    v := iVal.(Stu)       //ç›´æ¥è½¬åŒ–ç±»å‹æ–­è¨€åˆ°å˜é‡
}
```





### åå°„å…¥é—¨æ¡ˆåˆ—

> æ¼”ç¤ºå¯¹åŸºæœ¬æ•°æ®ç±»å‹ï¼Œç©ºæ¥å£å’Œåå°„åŸºæœ¬æ“ä½œ

```go
/*************************************************************************
    > File Name: reflect.go
    > Author: smile
    > Mail: 3293172751nss@gmail.com 
    > Created Time: Wed 23 Mar 2022 04:19:19 PM CST
 ************************************************************************/

 package main
 import(
    "fmt"
    "reflect"
)

func reflectInterface(b interface{}){
    //é€šè¿‡åå°„ è·å–åˆ°ä¼ å…¥çš„å˜é‡çš„type kind value 
    //rType rå¼€å¤´çš„è¡¨ç¤ºè¿™ç§typeæ˜¯
    rType := reflect.TypeOf(b)
    fmt.Println("rType = ",rType) //æ‰“å°å‡ºint

    //è·å–åˆ°reflectç±»å‹
    rVal := reflect.ValueOf(b)
    fmt.Println("rVal = ",rVal) //æ‰“å°å‡ºæ•°å­—100ï¼Œè™½ç„¶æ˜¯100ä½†ä¸æ˜¯æ™®é€šçš„100,rval ä¸èƒ½è¿›è¡Œè®¡ç®—

    //æŸ¥çœ‹rValçš„çœŸæ­£ç±»å‹
    fmt.Printf("rVal = %v  rVal type = %T\n ",rVal,rVal) //æ‰“å°å‡ºint

    //æˆ‘ä»¬çœ‹ä¸‹æ–‡æ¡£ï¼Œå¯¹rValè¿›è¡Œè®¡ç®—
    // n1 := 12  //ä¸èƒ½ä½¿ç”¨n1å˜é‡è¿›è¡ŒåŠ å‡
    //å¦‚æœç±»å‹æ˜¯floatï¼Œé‚£ä¹ˆæ­¤æ—¶éœ€è¦ç”¨åˆ°æ–­è¨€
    n2 := 11 + rVal.Int()
    fmt.Println("n2 = ",n2)

    //æˆ‘ä»¬å·²ç»æŠŠå˜é‡äº¤ç»™æ¥å£ï¼Œè€Œä¸”æ‹¿åˆ°äº†åå°„çš„valueï¼Œé‚£ä¹ˆæ­¤æ—¶æ€ä¹ˆæŠŠå®ƒé‡æ–°è½¬åŒ–ä¸ºintterface{}
    iv := rVal.Interface()
    //å°†interfaceé€šè¿‡æ–­è¨€è½¬åŒ–ä¸ºéœ€è¦çš„ç±»å‹
    num2 := iv.(int)
    fmt.Println("num2 = ",num2)
    fmt.Println("iv = ",iv)
}

//ä¸“é—¨æ¼”ç¤ºåå°„ï¼Œå¯¹ç»“æ„ä½“çš„åæ€
func reflectTest(b interface{}){
    //rType rå¼€å¤´çš„è¡¨ç¤ºè¿™ç§typeæ˜¯
    rType := reflect.TypeOf(b)
    fmt.Println("rType = ",rType) //æ‰“å°å‡ºint

    //è·å–åˆ°reflectç±»å‹
    rVal := reflect.ValueOf(b)
    fmt.Println("rVal = ",rVal) //æ‰“å°å‡ºæ•°å­—100ï¼Œè™½ç„¶æ˜¯100ä½†ä¸æ˜¯æ™®é€šçš„100,rval ä¸èƒ½è¿›è¡Œè®¡ç®—


    //æˆ‘ä»¬å·²ç»æŠŠå˜é‡äº¤ç»™æ¥å£ï¼Œè€Œä¸”æ‹¿åˆ°äº†åå°„çš„valueï¼Œé‚£ä¹ˆæ­¤æ—¶æ€ä¹ˆæŠŠå®ƒé‡æ–°è½¬åŒ–ä¸ºintterface{}
    iv := rVal.Interface()

    fmt.Printf("iv = %v iv type = %T",iv,iv) 
    fmt.Println("")
    
    //é€šè¿‡æ–­è¨€è½¬åŒ–ä¸ºéœ€è¦çš„æ•°æ®ç±»å‹ï¼Œé€šè¿‡swichæˆ–è€…ä½¿ç”¨ç®€å•çš„ç±»å‹æ–­è¨€
    stu,ok := iv.(Student)
    if ok {
        fmt.Println("student.Name = ",stu.Name)
    }
    fmt.Println("student",b.(Student))
    fmt.Println("student.Name = ",b.(Student).Name)
}

type Student struct{
    Name string 
    Age int

}
func main(){
    //åŸºæœ¬æ“ä½œ

    var num int = 100

    reflectInterface(num)
    fmt.Println("åˆ†å‰²çº¿","---------------------------------------")
    stu := Student{
        Name : "tom",
        Age : 20,
    }

    reflectTest(stu)
}
```

**ç¼–è¯‘**

```shell
[root@mail golang]# go run  reflect.go
rType =  int
rVal =  100
rVal = 100  rVal type = reflect.Value
 n2 =  111
num2 =  100
iv =  100
åˆ†å‰²çº¿ ---------------------------------------
rType =  main.Student
rVal =  {tom 20}
iv = {tom 20} iv type = main.Student
student.Name =  tom
student {tom 20}
student.Name =  tom
```



**å¸¸é‡**

```
ä½¿ç”¨constä¿®é¥°
å®šä¹‰å¿…é¡»åˆå§‹åŒ–
ä¸èƒ½ä¿®æ”¹
åªèƒ½ä¿®é¥°bool string int floatç±»å‹
```

**ç®€ä»‹å†™æ³•**

```go
const(
    a = 1
    b = 2
)
```

**ä¸“ä¸šå†™æ³•**

```go
const(
    a = inta          //aç­‰äº0
    b 				  //bç­‰äº1
    c				  //cç­‰äº2
)
```

> ç±»ä¼¼äºæšä¸¾å“ˆå“ˆ



### åå°„æ³¨æ„äº‹é¡¹

**é€šè¿‡åå°„å¯ä»¥è®©å˜é‡åœ¨interface{}å’ŒReflect.Valueä¹‹é—´ç›¸äº’è½¬æ¢**

**å¦‚æœè¦é€šè¿‡åå°„æ¥ä¿®æ”¹å˜é‡ï¼Œæ³¨æ„å½“ä½¿ç”¨SetXxxæ–¹æ³•æ¥è®¾ç½®éœ€è¦é€šè¿‡å¯¹åº”çš„æŒ‡é’ˆç±»å‹æ¥å®Œæˆï¼Œè¿™æ ·æ‰èƒ½æ”¹å˜ä¼ å…¥çš„å˜é‡çš„å€¼ï¼ŒåŒæ—¶éœ€è¦ä½¿ç”¨åˆ°`redlect.Value.Elem()`æ–¹æ³•**

**æ³¨æ„ï¼šelme**

```go
func (Value) Elem
func (v Value) Elem() Value
```

**Elemè¿”å›væŒæœ‰çš„æ¥å£ä¿ç®¡çš„å€¼çš„Valueå°è£…ï¼Œæˆ–è€…væŒæœ‰çš„æŒ‡é’ˆæŒ‡å‘çš„å€¼çš„Valueå°è£…ã€‚å¦‚æœvçš„Kindä¸æ˜¯Interfaceæˆ–Pträ¼španicï¼›å¦‚æœvæŒæœ‰çš„å€¼ä¸ºnilï¼Œä¼šè¿”å›Valueé›¶å€¼ã€‚**

```go
package main
import(
	"redlect"
	"fmt"
)

func main(){
    var str string = "tom" 
    fs := reflect.ValueOf(&str)
    fs.Elem().SetString("jack")
    fmt.Printf("%v\n",str)          //jack
}
```



### åå°„æœ€ä½³æ¡ˆä¾‹

> 1. ä½¿ç”¨åå°„æ¥**éå†ç»“æ„ä½“å­—æ®µï¼Œè°ƒç”¨ç»“æ„ä½“çš„æ–¹æ³•ï¼Œå¹¶è·å–ç»“æ„ä½“æ ‡ç­¾çš„å€¼**

**æ–¹æ³•**

```go
func (v Value) Method(i int) Value
```

```go
func (v Value) Call(in []Value) []Value
```



**æ¡ˆä¾‹**

```go
package main
import (
	"fmt"
	"reflect"
)
//å®šä¹‰äº†ä¸€ä¸ªMonsterç»“æ„ä½“
type Monster struct {
	Name  string `json:"name"`
	Age   int `json:"monster_age"`
	Score float32 `json:"æˆç»©"`
	Sex   string
	
}

//æ–¹æ³•ï¼Œè¿”å›ä¸¤ä¸ªæ•°çš„å’Œ
func (s Monster) GetSum(n1, n2 int) int {
	return n1 + n2
}
//æ–¹æ³•ï¼Œ æ¥æ”¶å››ä¸ªå€¼ï¼Œç»™sèµ‹å€¼
func (s Monster) Set(name string, age int, score float32, sex string) {
	s.Name = name
	s.Age = age
	s.Score = score
	s.Sex = sex
}

//æ–¹æ³•ï¼Œæ˜¾ç¤ºsçš„å€¼
func (s Monster) Print() {
	fmt.Println("---start~----")
	fmt.Println(s)
	fmt.Println("---end~----")
}
func TestStruct(a interface{}) {
	//è·å–reflect.Type ç±»å‹
	typ := reflect.TypeOf(a)
    
	//è·å–reflect.Value ç±»å‹
	val := reflect.ValueOf(a)
    
	//è·å–åˆ°aå¯¹åº”çš„ç±»åˆ«
	kd := val.Kind()
	//å¦‚æœä¼ å…¥çš„ä¸æ˜¯structï¼Œå°±é€€å‡º     --  åˆ¤æ–­æ˜¯å¦æ˜¯ç»“æ„ä½“
	if kd !=  reflect.Struct {
		fmt.Println("expect struct")
		return
	}

	//è·å–åˆ°è¯¥ç»“æ„ä½“æœ‰å‡ ä¸ªå­—æ®µ
	num := val.NumField()

	fmt.Printf("struct has %d fields\n", num) //4
	//å˜é‡ç»“æ„ä½“çš„æ‰€æœ‰å­—æ®µ
	for i := 0; i < num; i++ {
		fmt.Printf("Field %d: å€¼ä¸º=%v\n", i, val.Field(i))
		//è·å–åˆ°structæ ‡ç­¾, æ³¨æ„éœ€è¦é€šè¿‡reflect.Typeæ¥è·å–tagæ ‡ç­¾çš„å€¼
		tagVal := typ.Field(i).Tag.Get("json")
        //typä¸­çš„fieldæ–¹æ³•ä¸­çš„tagæ–¹æ³•ä¸­çš„getæ–¹æ³•  -- è·å–åˆ°json 
		//å¦‚æœè¯¥å­—æ®µäºtagæ ‡ç­¾å°±æ˜¾ç¤ºï¼Œå¦åˆ™å°±ä¸æ˜¾ç¤º
		if tagVal != "" {
			fmt.Printf("Field %d: tagä¸º=%v\n", i, tagVal)
		}
	}
	
	//è·å–åˆ°è¯¥ç»“æ„ä½“æœ‰å¤šå°‘ä¸ªæ–¹æ³•
	numOfMethod := val.NumMethod()
	fmt.Printf("å­—æ®µstruct has %d methods\n", numOfMethod)
	
	//var params []reflect.Value
	//æ–¹æ³•çš„æ’åºé»˜è®¤æ˜¯æŒ‰ç…§ å‡½æ•°åçš„æ’åºï¼ˆASCIIç ï¼‰Â·
	val.Method(1).Call(nil) //è·å–åˆ°ç¬¬äºŒä¸ªæ–¹æ³•ã€‚è°ƒç”¨å®ƒ

	//è°ƒç”¨ç»“æ„ä½“çš„ç¬¬1ä¸ªæ–¹æ³•Method(0)
	var params []reflect.Value  //å£°æ˜äº† []reflect.Value
	params = append(params, reflect.ValueOf(10))
	params = append(params, reflect.ValueOf(40))
	res := val.Method(0).Call(params) //ä¼ å…¥çš„å‚æ•°æ˜¯ []reflect.Value, è¿”å›[]reflect.Value
	fmt.Println("res=", res[0].Int()) //è¿”å›ç»“æœ, è¿”å›çš„ç»“æœæ˜¯ []reflect.Value*/
}

func main() {
	//åˆ›å»ºäº†ä¸€ä¸ªMonsterå®ä¾‹
	var a Monster = Monster{
		Name:  "é»„é¼ ç‹¼ç²¾",
		Age:   400,
		Score: 30.8,
	}
	//å°†Monsterå®ä¾‹ä¼ é€’ç»™TestStructå‡½æ•°
	TestStruct(a)	
}
```

**ç¼–è¯‘**

```shell
[root@mail go-eth]# go run  reflect.go
struct has 4 fields
Field 0: å€¼ä¸º=é»„é¼ ç‹¼ç²¾
Field 0: tagä¸º=name
Field 1: å€¼ä¸º=400
Field 1: tagä¸º=monster_age
Field 2: å€¼ä¸º=30.8
Field 2: tagä¸º=æˆç»©
Field 3: å€¼ä¸º=
struct has 3 methods
---start~----
{é»„é¼ ç‹¼ç²¾ 400 30.8 }
---end~----
res= 50
```

