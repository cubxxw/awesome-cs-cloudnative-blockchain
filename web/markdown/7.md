+ [author](https://github.com/3293172751)

# ç¬¬7èŠ‚ DNSåè®® & Go å‘é€DNSè¯·æ±‚

+ [å›åˆ°ç›®å½•](../README.md)
+ [å›åˆ°é¡¹ç›®é¦–é¡µ](../../README.md)
+ [ä¸Šä¸€èŠ‚](6.md)
> â¤ï¸ğŸ’•ğŸ’•è®¡ç®—æœºç½‘ç»œ--TCP/IP å­¦ä¹ ã€‚Myblog:[http://nsddd.top](http://nsddd.top/)
---
[TOC]

## DNSåè®®

+ [åœ¨çº¿è§£æåœ°å€](https://tool.chinaz.com/dns/?type=1&host=wt.nsddd.top&ip=)

### æœ¯è¯­ä¸çº¦å®š

+ **åŸŸåç³»ç»Ÿ**ï¼ˆ**DNS**ï¼‰æ˜¯äº’è”ç½‘çš„ä¸€é¡¹æœåŠ¡ã€‚å®ƒä½œä¸ºå°†åŸŸåå’ŒIPåœ°å€ç›¸äº’æ˜ å°„çš„ä¸€ä¸ª**åˆ†å¸ƒå¼æ•°æ®åº“**ï¼Œèƒ½å¤Ÿä½¿äººæ›´æ–¹ä¾¿åœ°è®¿é—®äº’è”ç½‘ã€‚
+ DNSä½¿ç”¨TCPå’ŒUDPç«¯å£53ã€‚
+ DNSæ¯ä¸€çº§åŸŸåé•¿åº¦çš„é™åˆ¶æ˜¯63ä¸ªå­—ç¬¦ï¼ŒåŸŸåæ€»é•¿åº¦åˆ™ä¸èƒ½è¶…è¿‡253ä¸ªå­—ç¬¦ã€‚

### dnsæ¦‚è¿°

+ dnsç”¨äºè½¬æ¢ä¸»æœºåå’ŒIPåœ°å€ã€‚
+ å®ƒæ˜¯åº”ç”¨å±‚åè®®ï¼Œä½“ç°åœ¨ï¼š
  + æ˜¯C/Sæ¶æ„
  + ç«¯åˆ°ç«¯å‘é€dnsæŠ¥æ–‡
+ ä¸å…¶ä»–åº”ç”¨å±‚åè®®ä¸åŒçš„æ˜¯ï¼Œdnsä¸»è¦ä¸ºå…¶ä»–åº”ç”¨å±‚åè®®æœåŠ¡ï¼Œè€Œä¸æ˜¯ç›´æ¥é¢å‘ç”¨æˆ·ã€‚



### dnsè®°å½•äº†ä»€ä¹ˆ

+ ä¸»æœºè®°å½•ï¼ˆAè®°å½•ï¼‰ï¼šç”¨äºåç§°è§£æçš„é‡è¦è®°å½•ï¼Œå°†ç‰¹å®šçš„ä¸»æœºåæ˜ å°„åˆ°å¯¹åº”ä¸»æœºçš„IPåœ°å€ä¸Šã€‚
+ åˆ«åè®°å½•ï¼ˆCNAMEè®°å½•ï¼‰: å°†æŸä¸ªåˆ«åæŒ‡å‘åˆ°æŸä¸ªAè®°å½•ä¸Šï¼Œè¿™æ ·å°±ä¸éœ€è¦å†ä¸ºæŸä¸ªæ–°åå­—å¦å¤–åˆ›å»ºä¸€æ¡æ–°çš„Aè®°å½•ã€‚
+ IPv6ä¸»æœºè®°å½•ï¼ˆAAAAè®°å½•ï¼‰: ç”¨äºå°†ç‰¹å®šçš„ä¸»æœºåæ˜ å°„åˆ°ä¸€ä¸ªä¸»æœºçš„IPv6åœ°å€ã€‚
+ æœåŠ¡ä½ç½®è®°å½•ï¼ˆSRVè®°å½•ï¼‰: ç”¨äºå®šä¹‰æä¾›ç‰¹å®šæœåŠ¡çš„æœåŠ¡å™¨çš„ä½ç½®ï¼Œå¦‚ä¸»æœºï¼ˆhostnameï¼‰ï¼Œç«¯å£ï¼ˆport numberï¼‰ç­‰ã€‚
+ NAPTRè®°å½•ï¼šæä¾›äº†æ­£åˆ™è¡¨è¾¾å¼æ–¹å¼å»æ˜ å°„ä¸€ä¸ªåŸŸåã€‚NAPTRè®°å½•éå¸¸è‘—åçš„ä¸€ä¸ªåº”ç”¨æ˜¯ç”¨äº[ENUM](https://zh.wikipedia.org/w/index.php?title=ENUM&action=edit&redlink=1)æŸ¥è¯¢ã€‚
+ MXè®°å½•ï¼šè®°å½•é‚®ä»¶æœåŠ¡å™¨çš„åˆ«åã€‚æŸå…¬å¸çš„webæœåŠ¡å™¨å¯ä»¥å’Œé‚®ä»¶æœåŠ¡å™¨å…±äº«åˆ«åã€‚
+ NSè®°å½•ï¼šè®°å½•ä»å“ªä¸ªdnsæœåŠ¡å™¨å¯ä»¥è·å¾—æŸä¸ªåŸŸ(å¦‚foo.com)çš„dnsè®°å½•ï¼Œå³ç”¨äºè®°å½•æŸ¥è¯¢é“¾ã€‚

### dnsæä¾›çš„æœåŠ¡

+ æ˜ å°„åŸŸåä¸IPåœ°å€ï¼Œå¹¶æä¾›åˆ«å
+ ä¸ºé‚®ä»¶æœåŠ¡å™¨æä¾›åˆ«å
+ è´Ÿè½½åˆ†é…(ä¸€ä¸ªåŸŸåå¤šä¸ªIPçš„æ—¶å€™)

### dnsåŸŸåè§£æè¯¦è§£

> dnsæ•´ä½“çš„å·¥ä½œä¸»è¦å›´ç»•åœ¨ä¸»æœºå’ŒIPåœ°å€æ˜ å°„ä¸Šé¢

DNSæŸ¥è¯¢æœ‰ä¸¤ç§æ–¹å¼ï¼š**é€’å½’**å’Œ**è¿­ä»£**ã€‚DNSå®¢æˆ·ç«¯è®¾ç½®ä½¿ç”¨çš„DNSæœåŠ¡å™¨ä¸€èˆ¬éƒ½æ˜¯é€’å½’æœåŠ¡å™¨ï¼Œå®ƒè´Ÿè´£å…¨æƒå¤„ç†å®¢æˆ·ç«¯çš„DNSæŸ¥è¯¢è¯·æ±‚ï¼Œç›´åˆ°è¿”å›æœ€ç»ˆç»“æœã€‚è€ŒDNSæœåŠ¡å™¨ä¹‹é—´ä¸€èˆ¬é‡‡ç”¨è¿­ä»£æŸ¥è¯¢æ–¹å¼ã€‚

+ ä»è¯·æ±‚ä¸»æœºåˆ° `DNS` æœåŠ¡å™¨æ˜¯é€’å½’æŸ¥è¯¢
+ é™¤æ­¤ä¹‹å¤–ï¼Œå…¶ä½™çš„æŸ¥è¯¢éƒ½æ˜¯è¿­ä»£æŸ¥è¯¢

ä»¥æŸ¥è¯¢zh.wikipedia.orgä¸ºä¾‹ï¼š

- å®¢æˆ·ç«¯å‘é€æŸ¥è¯¢æŠ¥æ–‡"query zh.wikipedia.org"è‡³DNSæœåŠ¡å™¨ï¼ŒDNSæœåŠ¡å™¨é¦–å…ˆæ£€æŸ¥è‡ªèº«ç¼“å­˜ï¼Œå¦‚æœå­˜åœ¨è®°å½•åˆ™ç›´æ¥è¿”å›ç»“æœã€‚
- å¦‚æœè®°å½•è€åŒ–æˆ–ä¸å­˜åœ¨ï¼Œåˆ™
  1. DNSæœåŠ¡å™¨å‘[æ ¹åŸŸåæœåŠ¡å™¨](https://zh.wikipedia.org/wiki/%E6%A0%B9%E5%9F%9F%E5%90%8D%E4%BC%BA%E6%9C%8D%E5%99%A8)å‘é€æŸ¥è¯¢æŠ¥æ–‡"query zh.wikipedia.org"ï¼Œæ ¹åŸŸåæœåŠ¡å™¨è¿”å›.orgåŸŸçš„æƒå¨åŸŸåæœåŠ¡å™¨åœ°å€ï¼Œè¿™ä¸€çº§é¦–å…ˆä¼šè¿”å›çš„æ˜¯[é¡¶çº§åŸŸå](https://zh.wikipedia.org/wiki/%E9%A1%B6%E7%BA%A7%E5%9F%9F%E5%90%8D)çš„æƒå¨åŸŸåæœåŠ¡å™¨ã€‚
  2. DNSæœåŠ¡å™¨å‘.orgåŸŸçš„æƒå¨åŸŸåæœåŠ¡å™¨å‘é€æŸ¥è¯¢æŠ¥æ–‡"query zh.wikipedia.org"ï¼Œå¾—åˆ°.wikipedia.orgåŸŸçš„æƒå¨åŸŸåæœåŠ¡å™¨åœ°å€ã€‚
  3. DNSæœåŠ¡å™¨å‘.wikipedia.orgåŸŸçš„æƒå¨åŸŸåæœåŠ¡å™¨å‘é€æŸ¥è¯¢æŠ¥æ–‡"query zh.wikipedia.org"ï¼Œå¾—åˆ°ä¸»æœºzhçš„Aè®°å½•ï¼Œå­˜å…¥è‡ªèº«ç¼“å­˜å¹¶è¿”å›ç»™å®¢æˆ·ç«¯ã€‚

> + åŸŸåçš„åˆ’åˆ†æ˜¯åœ¨é€»è¾‘ä¸Šçš„åˆ’åˆ†
>
> + ç½‘ç»œçš„åˆ’åˆ†åˆ™æ˜¯ç‰©ç†ä¸Šçš„åˆ’åˆ†

### dnså·¥ä½œæœºåˆ¶ç‰¹æ€§

**ä¸ºäº†è§£å†³æ‰©å±•æ€§é—®é¢˜ï¼ˆé›†ä¸­å¼æ¶æ„ä¸æ˜“æ‰©å±•ï¼‰ï¼ŒDNSä½¿ç”¨äº†å¤§é‡çš„DNSæœåŠ¡å™¨ï¼Œå®ƒä»¬ä»¥å±‚æ¬¡æ–¹å¼ç»„ç»‡ï¼ˆè§£å†³é‡åï¼‰ï¼Œå¹¶ä¸”åˆ†å¸ƒåœ¨å…¨ä¸–ç•Œçš„èŒƒå›´å†…ï¼Œæ²¡æœ‰ä¸€å°DNSæœåŠ¡å™¨æ‹¥æœ‰å› ç‰¹ç½‘ä¸Šæ‰€æœ‰ä¸»æœºçš„æ˜ å°„ã€‚**

+ dnså…·æœ‰åˆ†å¸ƒå¼åˆ†å±‚æ¬¡è§£æ„
+ dnsèƒ½å¤Ÿç¼“å­˜

### dnsè®°å½•ä¸æŠ¥æ–‡

#### dnsè®°å½•

dnsè®°å½•å¾€å¾€ç”±å››éƒ¨åˆ†ç»„æˆã€‚

1. Typeï¼šæ ‡å¿—è¿™æ˜¯ä¸€æ¡ä»€ä¹ˆè®°å½•ï¼Œè§[dnsè®°å½•äº†ä»€ä¹ˆ](#dnsè®°å½•äº†ä»€ä¹ˆ)
2. Valueï¼šNameçš„å¯¹åº”å€¼
3. Nameï¼šValueçš„å¯¹åº”å€¼
4. TTLï¼šæœ¬è®°å½•åº”è¯¥åœ¨ç¼“å­˜ä¸­å‘†å¤šä¹…

### dnsæŠ¥æ–‡

 ![dnsæŠ¥æ–‡æ ¼å¼](assets/dnsæŠ¥æ–‡æ ¼å¼.jpg)

1. å‰12å­—èŠ‚ä¸º**é¦–éƒ¨åŸŸ**åŒ…æ‹¬
   + æ ‡è¯†ç¬¦(16bitæ•°å­—)ï¼šæŸ¥è¯¢çš„å”¯ä¸€æ ‡è¯†
   + æ ‡å¿—(0 or 1)ï¼š0æ˜¯æŸ¥è¯¢ 1æ˜¯å›ç­”
2. æŸ¥è¯¢é—®é¢˜åŒºåŒ…æ‹¬
   + åå­—å­—æ®µï¼šä¸»æœºå
   + ç±»å‹ï¼šæƒ³æŸ¥ä»€ä¹ˆè®°å½•
3. å›ç­”åŒºï¼šæ ¹æ®é—®é¢˜æ¥å›ç­”ï¼Œå¯èƒ½ç”±å¤šä¸ªå›ç­”
4. æˆæƒåŒºå³æƒå¨åŒºï¼ŒåŒ…å«å…¶ä»–æƒå¨æœåŠ¡å™¨çš„è®°å½•
5. é™„åŠ åŒºæ˜¯ä¸€äº›å¤‡æ³¨ä¿¡æ¯

#### æ³¨å†Œdns 

æˆ‘ä»¬éœ€è¦å‘DNSæ•°æ®åº“ä¸­æ’å…¥æ•°æ®

åº”è¯¥å‘æ³¨å†Œç™»è®°æœºæ„æ³¨å†Œè‡ªå·±çš„ç½‘ç»œåŸŸåå’ŒIPåœ°å€ï¼Œæ‰èƒ½è¢«æŸ¥è¯¢åˆ°ã€‚

### dnsçš„å®‰å…¨æ€§

dnså¤§å¤šæ•°æƒ…å†µä¸‹æ˜¯å®‰å…¨çš„ã€‚

1. å¯¹äº`DDos`æ”»å‡»ï¼ŒDNSæœ‰åŒ…è¿‡æ»¤ç³»ç»Ÿå’Œç¼“å­˜æœåŠ¡ï¼Œä»…åœ¨`DDos`æ”»å‡»æŒ‡å‘é¡¶çº§æœåŠ¡å™¨çš„æ—¶å€™ç¨å¾®æœ‰äº›å›°æ‰°ã€‚
2. å¯ä»¥è¢«ä¸­é—´äººæ”»å‡»(ä¼ªé€ å›ç­”å“„éª—å®¢æˆ·ä¸»æœº)å’ŒDNSæ¯’å®³æ”»å‡»(ä¼ªé€ å›ç­”å“„éª—ä¸‹ä¸€çº§dnsæœåŠ¡å™¨æ¥ç¼“å­˜ï¼Œä»è€Œæ¬ºéª—å®¢æˆ·ä¸»æœº)ï¼Œä½†æ˜¯æŠ€æœ¯ä¸Šå¾ˆéš¾å®ç°ã€‚
3. dnsæœåŠ¡å™¨æœ¬èº«å¯è¢«åˆ©ç”¨äºæ”»å‡»å…¶ä»–æœåŠ¡å™¨ï¼Œä½†æ˜¯è‡³ä»Šä¸ºæ­¢åªæ˜¯ä¸ªä¾‹ã€‚



## dnsç¼–ç¨‹

![æŸ¥çœ‹æºå›¾åƒ](http://sm.nsddd.top/sma565e1fd2179204b5c040b5eda)

![image-20221122170030039](http://sm.nsddd.top/smimage-20221122170030039.png)



### dnsåŸŸåç³»ç»Ÿ

![image-20221122174044349](http://sm.nsddd.top/smimage-20221122174044349.png)

**domain name system åŸŸåç³»ç»Ÿ:**

> å­—æ®µå¯¹åº”çš„å­—èŠ‚æ•°ï¼š

![image-20221122175159200](http://sm.nsddd.top/smimage-20221122175159200.png)



::: tip
å½“ç„¶è¿™ä¸ªåªæ˜¯æŸ¥è¯¢é—®é¢˜ï¼Œè¿˜æœ‰å›ç­”ï¼š

![image-20221122175342979](http://sm.nsddd.top/smimage-20221122175342979.png)

**è¿™ä¸ªå°±å¤§å¾ˆå¤šäº†ï¼š**

![image-20221122175417503](http://sm.nsddd.top/smimage-20221122175417503.png)

:::



## ç¨‹åº

**dns ç›¸å…³çš„ç¨‹åºå’Œä»£ç ï¼š**

```bash
# nameserverç»“æ„ä½“
type NS struct {
    Host string
}


# srvè®°å½• æŒ‡å®šè¯¥åŸŸåç”±å“ªä¸ªDNSæœåŠ¡å™¨æ¥è¿›è¡Œè§£æ
type SRV struct {
    Target   string
    Port     uint16
    Priority uint16
    Weight   uint16
}


# dnsæ­£å‘è§£æ(åŸŸåè§£æåˆ°cnameæˆ–è€…å®é™…çš„ipåœ°å€)
## ä»…è¿”å›æŒ‡å®šåŸŸånameçš„cnameåœ°å€
func LookupCNAME(name string) (cname string, err error)

## ç›´æ¥è¿”å›åŸŸåè§£æåˆ°åœ°å€.
func LookupHost(host string) (addrs []string, err error)

## ç›´æ¥è¿”å›åŸŸåè§£æåˆ°åœ°å€,[]IPç»“æ„ä½“.å¯ä»¥å¯¹å…·ä½“ipè¿›è¡Œç›¸å…³æ“ä½œ(æ˜¯å¦å›ç¯åœ°å€,å­ç½‘,ç½‘ç»œå·ç­‰)
# type IP []byte
func LookupIP(host string) (addrs []IP, err error)

## DNSåå‘è§£æ(ipåœ°å€åå‘è§£ææŸ¥æ‰¾è§£æåˆ°çš„åŸŸå)
# æ ¹æ®ipåœ°å€æŸ¥æ‰¾ä¸»æœºååœ°å€(å¿…é¡»å¾—æ˜¯å¯ä»¥è§£æåˆ°çš„åŸŸå)[dig -x ipaddress]
func LookupAddr(addr string) (name []string, err error)
```









## END é“¾æ¥

+ [å›åˆ°ç›®å½•](../README.md)
+ [ä¸Šä¸€èŠ‚](6.md)
+ [ä¸‹ä¸€èŠ‚](8.md)
---
+ [å‚ä¸è´¡çŒ®â¤ï¸ğŸ’•ğŸ’•](https://github.com/3293172751/CS_COURSE/blob/master/Git/git-contributor.md)
