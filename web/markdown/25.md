+ [author](https://github.com/3293172751)

# ç¬¬25èŠ‚ WireSharkæŠ“åŒ…è§£å†³æœåŠ¡å™¨æ— æ³•ä¸Šç½‘

+ [å›åˆ°ç›®å½•](../README.md)
+ [å›åˆ°é¡¹ç›®é¦–é¡µ](../../README.md)
+ [ä¸Šä¸€èŠ‚](24.md)
> â¤ï¸ğŸ’•ğŸ’•è®¡ç®—æœºç½‘ç»œ--TCP/IP å­¦ä¹ ã€‚Myblog:[http://nsddd.top](http://nsddd.top/)
---
[TOC]

## WireSharkæŠ“åŒ…è§£å†³æœåŠ¡å™¨è¢«é»‘æ— æ³•ä¸Šç½‘

+ å¯ä»¥pingé€šï¼Œä½†æ˜¯ä¸èƒ½ä¸Šç½‘
+ TTLæ˜¯æ•°æ®æŠ¥æ–‡çš„ç”Ÿå­˜å‘¨æœŸ

**Linuxä¸Šé»˜è®¤TTLå€¼æ˜¯64ï¼Œæ¯ç»è¿‡ä¸€ä¸ªè·¯ç”±èŠ‚ç‚¹ï¼ŒTTLå€¼å‡1ï¼ŒTTLå€¼ä¸º0ï¼Œè¡¨ç¤ºç›®æ ‡åœ°å€ä¸å¯è¾¾ï¼Œè¿”å›Time to live exceeded**

**æˆ‘ä»¬ä¸´æ—¶ä¿®æ”¹ä¸º1**

```
echo "1" > /proc/sys/net/ipv4/ip_default_ttl
```

### æµ‹è¯•

> èƒ½pingé€šæœ¬åœ°ï¼Œä½†æ˜¯è¿œç¨‹æœåŠ¡å™¨`baidu.com`æ²¡æœ‰åŠæ³•é€šï¼Œæ˜¾ç¤ºTime to live exceeded

```
root@ubuntu:/home/smile# ping 127.5.2.0 -c 1
PING 127.5.2.0 (127.5.2.0) 56(84) bytes of data.
64 bytes from 127.5.2.0: icmp_seq=1 ttl=1 time=0.180 ms
--- 127.5.2.0 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.180/0.180/0.180/0.000 ms

root@ubuntu:/home/smile# ping baidu.com -c 1
PING baidu.com (110.242.68.66) 56(84) bytes of data.
From _gateway (192.168.137.2) icmp_seq=1 Time to live exceeded
--- baidu.com ping statistics ---
1 packets transmitted, 0 received, +1 errors, 100% packet loss, time 0ms
```

**æ­¤æ—¶åº”è¯¥æƒ³åˆ°ä¸€ä¸ªé—®é¢˜ï¼ŒTTLå€¼**



### éªŒè¯

**æˆ‘ä»¬æ¢å¤Linuxä¸‹çš„TTLå€¼ä¸º64æˆ–è€…255ï¼Œå¯ä»¥æ­£å¸¸è®¿é—®**

+ è€Œä¸”æˆ‘ä»¬å¯ä»¥åœ¨ä¸‹é¢çœ‹åˆ°å®ƒè¿”å›ç»™æˆ‘ä»¬çš„ttlå€¼ä¸º128ï¼Œæ„å‘³ç€æˆ‘ä»¬éœ€è¦`>127`æ‰èƒ½è®¿é—®
  $$
  TTL > 255 - 128 =  127
  $$

```
root@ubuntu:/home/smile# echo "255" > /proc/sys/net/ipv4/ip_default_ttl
root@ubuntu:/home/smile# ping baidu.com -c 1
PING baidu.com (39.156.66.10) 56(84) bytes of data.
64 bytes from 39.156.66.10 (39.156.66.10): icmp_seq=1 ttl=128 time=42.0 ms

--- baidu.com ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 42.024/42.024/42.024/0.000 ms
```



## WireSharkåˆ†æ

+ ç­›é€‰ICMPï¼ŒæŠ“å–é”™è¯¯
+ åˆ†åˆ«å¯¹åº”å¦‚ä¸‹ï¼Œè¯·æ±‚åŒ…å’Œç›¸åº”åŒ…

![image-20220724150754239](assets/image-20220724150754239.png)

**æ˜¾ç¤ºTime to live exceededè¯´æ˜è¯·æ±‚è¶…æ—¶ã€‚**



## MTR

**MTLå¯ä»¥æ£€æµ‹æˆ‘ä»¬åˆ°è¾¾ç›®æ ‡ç½‘ç»œä¹‹é—´çš„æ‰€æœ‰ç½‘ç»œè®¾å¤‡çš„ç½‘è·¯è´¨é‡**

### å®‰è£…MTR

```
sudo apt-get install mtr
mtr -v
```

### MTRæ£€æµ‹

```
mtr ip/åŸŸå
```



### æµ‹è¯•

```
mtr baidu.com
```

![image-20220724152736678](assets/image-20220724152736678.png)

## END é“¾æ¥

+ [å›åˆ°ç›®å½•](../README.md)
+ [ä¸Šä¸€èŠ‚](24.md)
+ [ä¸‹ä¸€èŠ‚](26.md)
---
+ [å‚ä¸è´¡çŒ®â¤ï¸ğŸ’•ğŸ’•](https://github.com/3293172751/CS_COURSE/blob/master/Git/git-contributor.md)
