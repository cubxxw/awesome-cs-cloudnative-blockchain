# 1. Flag

Goè¯­è¨€å†…ç½®çš„flagåŒ…å®ç°äº†å‘½ä»¤è¡Œå‚æ•°çš„è§£æï¼ŒflagåŒ…ä½¿å¾—å¼€å‘å‘½ä»¤è¡Œå·¥å…·æ›´ä¸ºç®€å•ã€‚

### 1.1.1. os.Args

å¦‚æœä½ åªæ˜¯ç®€å•çš„æƒ³è¦è·å–å‘½ä»¤è¡Œå‚æ•°ï¼Œå¯ä»¥åƒä¸‹é¢çš„ä»£ç ç¤ºä¾‹ä¸€æ ·ä½¿ç”¨os.Argsæ¥è·å–å‘½ä»¤è¡Œå‚æ•°ã€‚

```go
package main

import (
    "fmt"
    "os"
)

//os.Args demo
func main() {
    //os.Argsæ˜¯ä¸€ä¸ª[]string
    if len(os.Args) > 0 {
        for index, arg := range os.Args {
            fmt.Printf("args[%d]=%v\n", index, arg)
        }
    }
}
```

å°†ä¸Šé¢çš„ä»£ç æ‰§è¡Œgo build -o "args_demo"ç¼–è¯‘ä¹‹åï¼Œæ‰§è¡Œï¼š

```
    $ ./args_demo a b c d
    args[0]=./args_demo
    args[1]=a
    args[2]=b
    args[3]=c
    args[4]=d
```

os.Argsæ˜¯ä¸€ä¸ªå­˜å‚¨å‘½ä»¤è¡Œå‚æ•°çš„å­—ç¬¦ä¸²åˆ‡ç‰‡ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æ‰§è¡Œæ–‡ä»¶çš„åç§°ã€‚

### 1.1.2. flagåŒ…åŸºæœ¬ä½¿ç”¨

æœ¬æ–‡ä»‹ç»äº†flagåŒ…çš„å¸¸ç”¨å‡½æ•°å’ŒåŸºæœ¬ç”¨æ³•ï¼Œæ›´è¯¦ç»†çš„å†…å®¹è¯·æŸ¥çœ‹[å®˜æ–¹æ–‡æ¡£](https://studygolang.com/pkgdoc)ã€‚

#### å¯¼å…¥flagåŒ…

```
    import flag
```

#### flagå‚æ•°ç±»å‹

flagåŒ…æ”¯æŒçš„å‘½ä»¤è¡Œå‚æ•°ç±»å‹æœ‰boolã€intã€int64ã€uintã€uint64ã€float float64ã€stringã€durationã€‚

| flagå‚æ•°     | æœ‰æ•ˆå€¼                                                       |
| ------------ | ------------------------------------------------------------ |
| å­—ç¬¦ä¸²flag   | åˆæ³•å­—ç¬¦ä¸²                                                   |
| æ•´æ•°flag     | 1234ã€0664ã€0x1234ç­‰ç±»å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯è´Ÿæ•°ã€‚                     |
| æµ®ç‚¹æ•°flag   | åˆæ³•æµ®ç‚¹æ•°                                                   |
| boolç±»å‹flag | 1, 0, t, f, T, F, true, false, TRUE, FALSE, True, Falseã€‚    |
| æ—¶é—´æ®µflag   | ä»»ä½•åˆæ³•çš„æ—¶é—´æ®µå­—ç¬¦ä¸²ã€‚å¦‚â€300msâ€ã€â€-1.5hâ€ã€â€2h45mâ€ã€‚ åˆæ³•çš„å•ä½æœ‰â€nsâ€ã€â€usâ€ /â€œÂµsâ€ã€â€msâ€ã€â€sâ€ã€â€mâ€ã€â€hâ€ã€‚ |

### 1.1.3. å®šä¹‰å‘½ä»¤è¡Œflagå‚æ•°

æœ‰ä»¥ä¸‹ä¸¤ç§å¸¸ç”¨çš„å®šä¹‰å‘½ä»¤è¡Œflagå‚æ•°çš„æ–¹æ³•ã€‚

#### flag.Type()

åŸºæœ¬æ ¼å¼å¦‚ä¸‹ï¼š

`flag.Type(flagå, é»˜è®¤å€¼, å¸®åŠ©ä¿¡æ¯)*Type`ä¾‹å¦‚æˆ‘ä»¬è¦å®šä¹‰å§“åã€å¹´é¾„ã€å©šå¦ä¸‰ä¸ªå‘½ä»¤è¡Œå‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼å®šä¹‰ï¼š

```go
name := flag.String("name", "å¼ ä¸‰", "å§“å")
age := flag.Int("age", 18, "å¹´é¾„")
married := flag.Bool("married", false, "å©šå¦")
delay := flag.Duration("d", 0, "æ—¶é—´é—´éš”")
```

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤æ—¶nameã€ageã€marriedã€delayå‡ä¸ºå¯¹åº”ç±»å‹çš„æŒ‡é’ˆã€‚

#### flag.TypeVar()

åŸºæœ¬æ ¼å¼å¦‚ä¸‹ï¼š flag.TypeVar(TypeæŒ‡é’ˆ, flagå, é»˜è®¤å€¼, å¸®åŠ©ä¿¡æ¯) ä¾‹å¦‚æˆ‘ä»¬è¦å®šä¹‰å§“åã€å¹´é¾„ã€å©šå¦ä¸‰ä¸ªå‘½ä»¤è¡Œå‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼å®šä¹‰ï¼š

```go
var name string
var age int
var married bool
var delay time.Duration
flag.StringVar(&name, "name", "å¼ ä¸‰", "å§“å")
flag.IntVar(&age, "age", 18, "å¹´é¾„")
flag.BoolVar(&married, "married", false, "å©šå¦")
flag.DurationVar(&delay, "d", 0, "æ—¶é—´é—´éš”")
```

#### flag.Parse()

é€šè¿‡ä»¥ä¸Šä¸¤ç§æ–¹æ³•å®šä¹‰å¥½å‘½ä»¤è¡Œflagå‚æ•°åï¼Œéœ€è¦é€šè¿‡è°ƒç”¨flag.Parse()æ¥å¯¹å‘½ä»¤è¡Œå‚æ•°è¿›è¡Œè§£æã€‚

æ”¯æŒçš„å‘½ä»¤è¡Œå‚æ•°æ ¼å¼æœ‰ä»¥ä¸‹å‡ ç§ï¼š

- -flag xxx ï¼ˆä½¿ç”¨ç©ºæ ¼ï¼Œä¸€ä¸ª-ç¬¦å·ï¼‰
- --flag xxx ï¼ˆä½¿ç”¨ç©ºæ ¼ï¼Œä¸¤ä¸ª-ç¬¦å·ï¼‰
- -flag=xxx ï¼ˆä½¿ç”¨ç­‰å·ï¼Œä¸€ä¸ª-ç¬¦å·ï¼‰
- --flag=xxx ï¼ˆä½¿ç”¨ç­‰å·ï¼Œä¸¤ä¸ª-ç¬¦å·ï¼‰

å…¶ä¸­ï¼Œå¸ƒå°”ç±»å‹çš„å‚æ•°å¿…é¡»ä½¿ç”¨ç­‰å·çš„æ–¹å¼æŒ‡å®šã€‚

Flagè§£æåœ¨ç¬¬ä¸€ä¸ªéflagå‚æ•°ï¼ˆå•ä¸ªâ€-â€œä¸æ˜¯flagå‚æ•°ï¼‰ä¹‹å‰åœæ­¢ï¼Œæˆ–è€…åœ¨ç»ˆæ­¢ç¬¦â€â€“â€œä¹‹ååœæ­¢ã€‚

### 1.1.4. flagå…¶ä»–å‡½æ•°

- flag.Args() ////è¿”å›å‘½ä»¤è¡Œå‚æ•°åçš„å…¶ä»–å‚æ•°ï¼Œä»¥[]stringç±»å‹
- flag.NArg() //è¿”å›å‘½ä»¤è¡Œå‚æ•°åçš„å…¶ä»–å‚æ•°ä¸ªæ•°
- flag.NFlag() //è¿”å›ä½¿ç”¨çš„å‘½ä»¤è¡Œå‚æ•°ä¸ªæ•°

### 1.1.5. å®Œæ•´ç¤ºä¾‹

#### å®šä¹‰

```go
func main() {
    //å®šä¹‰å‘½ä»¤è¡Œå‚æ•°æ–¹å¼1
    var name string
    var age int
    var married bool
    var delay time.Duration
    flag.StringVar(&name, "name", "å¼ ä¸‰", "å§“å")
    flag.IntVar(&age, "age", 18, "å¹´é¾„")
    flag.BoolVar(&married, "married", false, "å©šå¦")
    flag.DurationVar(&delay, "d", 0, "å»¶è¿Ÿçš„æ—¶é—´é—´éš”")

    //è§£æå‘½ä»¤è¡Œå‚æ•°
    flag.Parse()
    fmt.Println(name, age, married, delay)
    //è¿”å›å‘½ä»¤è¡Œå‚æ•°åçš„å…¶ä»–å‚æ•°
    fmt.Println(flag.Args())
    //è¿”å›å‘½ä»¤è¡Œå‚æ•°åçš„å…¶ä»–å‚æ•°ä¸ªæ•°
    fmt.Println(flag.NArg())
    //è¿”å›ä½¿ç”¨çš„å‘½ä»¤è¡Œå‚æ•°ä¸ªæ•°
    fmt.Println(flag.NFlag())
}
```

### 1.1.6. ä½¿ç”¨

å‘½ä»¤è¡Œå‚æ•°ä½¿ç”¨æç¤ºï¼š

```
    $ ./flag_demo -help
    Usage of ./flag_demo:
      -age int
            å¹´é¾„ (default 18)
      -d duration
            æ—¶é—´é—´éš”
      -married
            å©šå¦
      -name string
            å§“å (default "å¼ ä¸‰")
```

æ­£å¸¸ä½¿ç”¨å‘½ä»¤è¡Œflagå‚æ•°ï¼š

```
    $ ./flag_demo -name pprof --age 28 -married=false -d=1h30m
    pprof 28 false 1h30m0s
    []
    0
    4
```

ä½¿ç”¨éflagå‘½ä»¤è¡Œå‚æ•°ï¼š

```
    $ ./flag_demo a b c
    å¼ ä¸‰ 18 false 0s
    [a b c]
    3
    0
```

## END é“¾æ¥
<ul><li><div><a href = '55.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—</a><a href = '57.md' style='float: right'>â¬‡ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div></li></ul>

+ [â“‚ï¸å›åˆ°é¦–é¡µğŸ ](../README.md)

+ [**ğŸ«µå‚ä¸è´¡çŒ®ğŸ’â¤ï¸â€ğŸ”¥ğŸ’–**](https://nsddd.top/archives/contributors))

+ âœ´ï¸ç‰ˆæƒå£°æ˜ &copy; :æœ¬ä¹¦æ‰€æœ‰å†…å®¹éµå¾ª[CC-BY-SA 3.0åè®®ï¼ˆç½²å-ç›¸åŒæ–¹å¼å…±äº«ï¼‰&copy;](http://zh.wikipedia.org/wiki/Wikipedia:CC-by-sa-3.0åè®®æ–‡æœ¬) 

