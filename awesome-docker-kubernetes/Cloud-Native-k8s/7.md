+ [author](http://nsddd.top)

# ç¬¬7èŠ‚ k8såœ¨çº¿å®éªŒå­¦ä¹ å¹³å°

<div><a href = '6.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—  </a><a href = '8.md' style='float: right'>  â¬‡ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div>
<br>

> â¤ï¸ğŸ’•ğŸ’•æ–°æ—¶ä»£æ‹¥æŠ±äº‘åŸç”Ÿï¼Œäº‘åŸç”Ÿå…·æœ‰ç¯å¢ƒç»Ÿä¸€ã€æŒ‰éœ€ä»˜è´¹ã€å³å¼€å³ç”¨ã€ç¨³å®šæ€§å¼ºç‰¹ç‚¹ã€‚Myblog:[http://nsddd.top](http://nsddd.top/)

---
[[toc]]

[TOC]

## Play with Kubernetes ä»‹ç»

ï¼ˆ1ï¼‰`Play with Kubernetes` ä¸€ä¸ªæä¾›äº†åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨å…è´¹ **CentOS Linux** è™šæ‹Ÿæœºçš„ä½“éªŒå¹³å°ï¼Œå…¶å†…éƒ¨å®é™…ä¸Šæ˜¯ **Docker-in-Docker**ï¼ˆ**DinD**ï¼‰æŠ€æœ¯æ¨¡æ‹Ÿäº†å¤šè™šæ‹Ÿæœº/**PC** çš„æ•ˆæœã€‚
ï¼ˆ2ï¼‰`Play with Kubernetes` å¹³å°æœ‰å¦‚ä¸‹å‡ ä¸ªç‰¹è‰²ï¼š

+ å…è®¸æˆ‘ä»¬ä½¿ç”¨ **github** æˆ– **dockerhub** è´¦å·ç™»å½•
+ åœ¨ç™»å½•åä¼šå¼€å§‹å€’è®¡æ—¶ï¼Œè®©æˆ‘ä»¬æœ‰ **4** å°æ—¶çš„æ—¶é—´å»å®è·µ
+ **K8s** ç¯å¢ƒä½¿ç”¨ **kubeadm** æ¥éƒ¨ç½²ï¼ˆä½¿ç”¨ç”¨ **weave** ç½‘ç»œï¼‰
+ å¹³å°å…±æä¾› **5** å° **centos7** è®¾å¤‡ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼ˆ**docker** ç‰ˆæœ¬ä¸º **17.09.0-ce**ï¼‰



##  æ­å»º Kubernetes é›†ç¾¤

ï¼ˆ1ï¼‰é¦–å…ˆè®¿é—®å…¶ç½‘ç«™ï¼Œå¹¶ä½¿ç”¨ **github** æˆ– **dockerhub** è´¦å·è¿›è¡Œç™»å½•ã€‚

+ **PWK** å®˜ç½‘åœ°å€ï¼šhttps://labs.play-with-k8s.com/

ï¼ˆ2ï¼‰ç™»å½•åç‚¹å‡»é¡µé¢ä¸Šçš„ **Start** æŒ‰é’®ï¼Œæˆ‘ä»¬ä¾¿æ‹¥æœ‰ä¸€ä¸ªè‡ªå·±çš„å®éªŒå®¤ç¯å¢ƒã€‚

![image-20221019215214900](http://sm.nsddd.top/smimage-20221019215214900.png)



ï¼ˆ3ï¼‰å•å‡»å·¦ä¾§çš„â€œ**Add New Instance**â€ æ¥åˆ›å»ºç¬¬ä¸€ä¸ª **Kubernetes** é›†ç¾¤èŠ‚ç‚¹ã€‚å®ƒä¼šè‡ªåŠ¨å°†å…¶å‘½åä¸ºâ€œ**node1**â€ï¼Œè¿™ä¸ªå°†ä½œä¸ºæˆ‘ä»¬ç¾¤é›†çš„ä¸»èŠ‚ç‚¹ã€‚

![image-20221019215413938](http://sm.nsddd.top/smimage-20221019215413938.png)



ï¼ˆ4ï¼‰ç”±äºåˆšåˆ›å»ºçš„ä¸»èŠ‚ç‚¹ **IP** æ˜¯ `192.168.0.5`ï¼Œå› æ­¤æˆ‘ä»¬æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è¿›è¡Œåˆå§‹åŒ–ï¼š

```bash
kubeadm init --apiserver-advertise-address 192.168.0.5 --pod-network-cidr=10.244.0.0/16
```



ï¼ˆ5ï¼‰åˆå§‹åŒ–å®Œæ¯•å®Œæˆä¹‹åï¼Œç•Œé¢ä¸Šä¼šæ˜¾ç¤º `kubeadm join` å‘½ä»¤ï¼Œè¿™ä¸ªç”¨äºåç»­ **node** èŠ‚ç‚¹åŠ å…¥é›†ç¾¤ä½¿ç”¨ï¼Œéœ€è¦ç‰¢è®°ã€‚

![image-20221019215641859](http://sm.nsddd.top/smimage-20221019215641859.png)



ï¼ˆ6ï¼‰æ¥ç€è¿˜éœ€è¦æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å®‰è£… `Pod` ç½‘ç»œï¼ˆè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ `flannel`ï¼‰ï¼Œå¦åˆ™ `Pod` ä¹‹é—´æ— æ³•é€šä¿¡ã€‚

```bash
kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml
```


ï¼ˆ7ï¼‰æœ€åæˆ‘ä»¬æ‰§è¡Œ `kubectl get nodes` æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°ç›®å‰åªæœ‰ä¸€ä¸ª **Master** èŠ‚ç‚¹ã€‚

```bash
kubectl get nodes
```

![image-20221019221408948](http://sm.nsddd.top/smimage-20221019221408948.png)


ï¼ˆ8ï¼‰æˆ‘ä»¬å•å‡»å·¦ä¾§çš„â€œ**Add New Instance**â€æŒ‰é’®ç»§ç»­åˆ›å»º **4** ä¸ªèŠ‚ç‚¹ä½œä¸º **node** èŠ‚ç‚¹

![image-20221019221428071](http://sm.nsddd.top/smimage-20221019221428071.png)


ï¼ˆ9ï¼‰è¿™ `4` ä¸ªèŠ‚ç‚¹éƒ½æ‰§è¡Œç±»ä¼¼å¦‚ä¸‹çš„ `kubeadm join` å‘½ä»¤åŠ å…¥é›†ç¾¤ï¼ˆå³ä¹‹å‰ `master` èŠ‚ç‚¹åˆå§‹åŒ–å®Œæˆåçº¢æ¡†éƒ¨åˆ†å†…å®¹ï¼‰

![image-20221019222217349](http://sm.nsddd.top/smimage-20221019222217349.png)

```bash
kubeadm join 192.168.0.18:6443 --token mb680t.mue309o4jo5gjfyb --discovery-token-ca-cert-hash sha256:714f1794efcf23flec7f2dc6eae029466022d7c74c991cf91decf8ff22be61ab
```

![image-20221019222531962](http://sm.nsddd.top/smimage-20221019222531962.png)



ï¼ˆ10ï¼‰æœ€åæˆ‘ä»¬åœ¨ä¸»èŠ‚ç‚¹æ‰§è¡Œ `kubectl get nodes` æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªåŒ…å«æœ‰ `5` ä¸ªèŠ‚ç‚¹é›†ç¾¤å·²ç»éƒ¨ç½²æˆåŠŸäº†ã€‚

![image-20221019222932955](http://sm.nsddd.top/smimage-20221019222932955.png)



## Kubernetes é›†ç¾¤çš„ä½¿ç”¨

ï¼ˆ1ï¼‰æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤é€šè¿‡ **yaml** æ–‡ä»¶éƒ¨ç½²è¿è¡Œ **nginx** æœåŠ¡ï¼ˆè¯¥ **yaml** æ–‡ä»¶ä¸­æŒ‡æ˜äº†å‰¯æœ¬æ•°é‡ä¸º **3**ï¼‰

```bash
kubectl apply -f https://raw.githubusercontent.com/kubernetes/website/master/content/en/examples/application/nginx-app.yaml
```



ï¼ˆ2ï¼‰æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹å‰¯æœ¬ï¼ˆ**pod**ï¼‰æƒ…å†µï¼Œå¯ä»¥çœ‹åˆ°ç¡®å®æœ‰ä¸‰ä¸ªå‰¯æœ¬åˆ†åˆ«éƒ¨ç½²åœ¨ä¸‰ä¸ª **node** èŠ‚ç‚¹ä¸Šã€‚

```
kubectl get pods -o wide
```

![image-20221020220601596](http://sm.nsddd.top/smimage-20221020220601596.png)



ï¼ˆ3ï¼‰æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤åˆ™å¯ä»¥æŸ¥çœ‹ **services** çŠ¶æ€ã€‚

```
kubectl get service
```

![image-20221020220633446](http://sm.nsddd.top/smimage-20221020220633446.png)



ï¼ˆ4ï¼‰å½“éƒ¨ç½²å®Œæ¯•åï¼Œé¡µé¢ä¸Šæ–¹ä¼šå‡ºç°ä¸€ä¸ªå¸¦æœ‰æ•°å­—çš„è“è‰²æŒ‰é’®ï¼ŒæŒ‰é’®æ•°å­—å³ä¸º **Services** éšæœºé…ç½®çš„å¤–éƒ¨ **port**ã€‚ç‚¹å‡»è“è‰²æŒ‰é’®ï¼Œå³å¯çœ‹åˆ° **Nginx** æœåŠ¡çš„æ¬¢è¿é¡µé¢ã€‚ï¼ˆä½†æˆ‘æµ‹è¯•æ—¶ä¸€ç›´æ²¡æœ‰å‡ºç°ï¼Œä¸æ¸…æ¥šæ˜¯ä»€ä¹ˆåŸå› ï¼Œä½ å¦‚æœæ¸…æ¥šå¯ä»¥`pr`ï¼‰





## END é“¾æ¥
<ul><li><div><a href = '6.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—  </a><a href = '8.md' style='float: right'>  ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div></li></ul>

+ [â“‚ï¸å›åˆ°ç›®å½•ğŸ ](../README.md)

+ [**ğŸ«µå‚ä¸è´¡çŒ®ğŸ’â¤ï¸â€ğŸ”¥ğŸ’–**](https://nsddd.top/archives/contributors))

+ âœ´ï¸ç‰ˆæƒå£°æ˜ &copy; ï¼šæœ¬ä¹¦æ‰€æœ‰å†…å®¹éµå¾ª[CC-BY-SA 3.0åè®®ï¼ˆç½²å-ç›¸åŒæ–¹å¼å…±äº«ï¼‰&copy;](http://zh.wikipedia.org/wiki/Wikipedia:CC-by-sa-3.0åè®®æ–‡æœ¬) 

