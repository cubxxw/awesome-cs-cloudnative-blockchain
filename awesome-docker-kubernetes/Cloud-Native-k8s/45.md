+ [author](http://nsddd.top)

# ç¬¬45èŠ‚ namespace é€šä¿¡é—®é¢˜

<div><a href = '44.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—  </a><a href = '46.md' style='float: right'>  â¬‡ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div>
<br>

> â¤ï¸ğŸ’•ğŸ’•æ–°æ—¶ä»£æ‹¥æŠ±äº‘åŸç”Ÿï¼Œäº‘åŸç”Ÿå…·æœ‰ç¯å¢ƒç»Ÿä¸€ã€æŒ‰éœ€ä»˜è´¹ã€å³å¼€å³ç”¨ã€ç¨³å®šæ€§å¼ºç‰¹ç‚¹ã€‚Myblog:[http://nsddd.top](http://nsddd.top/)

---
[TOC]

## Linux namesapce

å‘½åç©ºé—´æ˜¯ Linux å†…æ ¸çš„ä¸€é¡¹åŠŸèƒ½ï¼Œå®ƒå¯¹å†…æ ¸èµ„æºè¿›è¡Œåˆ†åŒºï¼Œä»¥ä¾¿ä¸€ç»„è¿›ç¨‹çœ‹åˆ°ä¸€ç»„èµ„æºï¼Œè€Œå¦ä¸€ç»„è¿›ç¨‹çœ‹åˆ°å¦ä¸€ç»„èµ„æºã€‚è¯¥åŠŸèƒ½é€šè¿‡ä¸ºä¸€ç»„èµ„æºå’Œè¿›ç¨‹ä½¿ç”¨ç›¸åŒçš„å‘½åç©ºé—´æ¥å·¥ä½œï¼Œä½†è¿™äº›å‘½åç©ºé—´å¼•ç”¨ä¸åŒçš„èµ„æºã€‚èµ„æºå¯èƒ½å­˜åœ¨äºå¤šä¸ªç©ºé—´ä¸­ã€‚æ­¤ç±»èµ„æºçš„ç¤ºä¾‹æœ‰è¿›ç¨‹ IDã€ä¸»æœºåã€ç”¨æˆ· IDã€æ–‡ä»¶åã€ä¸€äº›ä¸ç½‘ç»œè®¿é—®ç›¸å…³çš„åç§°ä»¥åŠè¿›ç¨‹é—´é€šä¿¡ã€‚

åœ¨åé¢çš„ docker ã€Kubernetes ä¸­ï¼Œå‘½åç©ºé—´æ˜¯ Linux ä¸­å®¹å™¨çš„ä¸€ä¸ªåŸºæœ¬æ–¹é¢ã€‚

æœ¯è¯­â€œå‘½åç©ºé—´â€é€šå¸¸ç”¨äºå‘½åç©ºé—´çš„ç±»å‹ï¼ˆä¾‹å¦‚è¿›ç¨‹ IDï¼‰ä»¥åŠç‰¹å®šçš„åç§°ç©ºé—´ã€‚

Linux ç³»ç»Ÿä»æ¯ç§ç±»å‹çš„å•ä¸ªåç§°ç©ºé—´å¼€å§‹ï¼Œä¾›æ‰€æœ‰è¿›ç¨‹ä½¿ç”¨ã€‚è¿›ç¨‹å¯ä»¥åˆ›å»ºé¢å¤–çš„å‘½åç©ºé—´ï¼Œä¹Ÿå¯ä»¥åŠ å…¥ä¸åŒçš„å‘½åç©ºé—´ã€‚

å¯¹äºå®¹å™¨æŠ€æœ¯è€Œè¨€ï¼Œå®ƒå®ç°èµ„æºå±‚é¢ä¸Šçš„é™åˆ¶å’Œéš”ç¦»ï¼Œä¾èµ–äº Linux å†…æ ¸æ‰€æä¾›çš„ cgroup å’Œ namespace æŠ€æœ¯ã€‚

æˆ‘ä»¬å…ˆå¯¹è¿™ä¸¤é¡¹æŠ€æœ¯çš„ä½œç”¨åšä¸ªæ¦‚æ‹¬ï¼š

+ cgroup çš„ä¸»è¦ä½œç”¨ï¼šç®¡ç†èµ„æºçš„åˆ†é…ã€é™åˆ¶ï¼›
+ namespace çš„ä¸»è¦ä½œç”¨ï¼šå°è£…æŠ½è±¡ï¼Œé™åˆ¶ï¼Œéš”ç¦»ï¼Œä½¿å‘½åç©ºé—´å†…çš„è¿›ç¨‹çœ‹èµ·æ¥æ‹¥æœ‰ä»–ä»¬è‡ªå·±çš„å…¨å±€èµ„æºï¼›



## namespace kind

ä»å†…æ ¸5.6ç‰ˆæœ¬å¼€å§‹ï¼Œæœ‰8ç§å‘½åç©ºé—´ã€‚æ‰€æœ‰ç±»å‹çš„å‘½åç©ºé—´åŠŸèƒ½éƒ½æ˜¯ç›¸åŒçš„ï¼šæ¯ä¸ªè¿›ç¨‹éƒ½ä¸ä¸€ä¸ªå‘½åç©ºé—´ç›¸å…³è”ï¼Œå¹¶ä¸”åªèƒ½æŸ¥çœ‹æˆ–ä½¿ç”¨ä¸è¯¥å‘½åç©ºé—´å…³è”çš„èµ„æºï¼Œä»¥åŠé€‚ç”¨çš„åä»£å‘½åç©ºé—´ã€‚è¿™æ ·æ¯ä¸ªè¿›ç¨‹ï¼ˆæˆ–å…¶è¿›ç¨‹ç»„ï¼‰éƒ½å¯ä»¥å¯¹èµ„æºæœ‰ç‹¬ç‰¹çš„çœ‹æ³•ã€‚éš”ç¦»å“ªä¸ªèµ„æºå–å†³äºä¸ºç»™å®šè¿›ç¨‹ç»„åˆ›å»ºçš„å‘½åç©ºé—´ç±»å‹ã€‚

| namespaceåç§° | ä½¿ç”¨çš„æ ‡è¯† - Flag | æ§åˆ¶å†…å®¹                                                     |
| ------------- | ----------------- | ------------------------------------------------------------ |
| Cgroup        | CLONE_NEWCGROUP   | Cgroup root directory cgroup æ ¹ç›®å½•                          |
| IPC           | CLONE_NEWIPC      | System V IPC, POSIX message queuesä¿¡å·é‡ï¼Œæ¶ˆæ¯é˜Ÿåˆ—           |
| Network       | CLONE_NEWNET      | Network devices, stacks, ports, etc.ç½‘ç»œè®¾å¤‡ï¼Œåè®®æ ˆï¼Œç«¯å£ç­‰ç­‰ |
| Mount         | CLONE_NEWNS       | Mount pointsæŒ‚è½½ç‚¹                                           |
| PID           | CLONE_NEWPID      | Process IDsè¿›ç¨‹å·                                            |
| Time          | CLONE_NEWTIME     | æ—¶é’Ÿ                                                         |
| User          | CLONE_NEWUSER     | ç”¨æˆ·å’Œç»„ ID                                                  |
| UTS           | CLONE_NEWUTS      | ç³»ç»Ÿä¸»æœºåå’Œ NIS(Network Information Service) ä¸»æœºåï¼ˆæœ‰æ—¶ç§°ä¸ºåŸŸåï¼‰ |

### Mount (mnt)

æŒ‚è½½å‘½åç©ºé—´æ§åˆ¶æŒ‚è½½ç‚¹ã€‚åˆ›å»ºæ—¶ï¼Œå½“å‰æŒ‚è½½å‘½åç©ºé—´çš„æŒ‚è½½è¢«å¤åˆ¶åˆ°æ–°çš„å‘½åç©ºé—´ï¼Œä½†ä¹‹ååˆ›å»ºçš„æŒ‚è½½ç‚¹ä¸ä¼šåœ¨å‘½åç©ºé—´ä¹‹é—´ä¼ æ’­ï¼ˆä½¿ç”¨å…±äº«å­æ ‘ï¼Œå¯ä»¥åœ¨å‘½åç©ºé—´ [[4\]](https://en.wikipedia.org/wiki/Linux_namespaces#cite_note-shared_subtrees-4) ä¹‹é—´ä¼ æ’­æŒ‚è½½ç‚¹ï¼‰ã€‚

ç”¨äºåˆ›å»ºæ­¤ç±»æ–°åç§°ç©ºé—´çš„å…‹éš†æ ‡å¿—æ˜¯ CLONE_NEWNS - â€œNEW NameSpaceâ€çš„ç¼©å†™ã€‚è¿™ä¸ªæœ¯è¯­ä¸æ˜¯æè¿°æ€§çš„ï¼ˆå®ƒæ²¡æœ‰è¯´æ˜è¦åˆ›å»ºå“ªç§å‘½åç©ºé—´ï¼‰ï¼Œå› ä¸ºæŒ‚è½½å‘½åç©ºé—´æ˜¯ç¬¬ä¸€ç§å‘½åç©ºé—´ï¼Œè®¾è®¡è€…æ²¡æœ‰é¢„æ–™åˆ°è¿˜æœ‰å…¶ä»–å‘½åç©ºé—´ã€‚



### Process ID (pid)

PID å‘½åç©ºé—´ä¸ºè¿›ç¨‹æä¾›ä¸€ç»„ç‹¬ç«‹äºå…¶ä»–å‘½åç©ºé—´çš„è¿›ç¨‹ ID (PID)ã€‚ PID å‘½åç©ºé—´æ˜¯åµŒå¥—çš„ï¼Œè¿™æ„å‘³ç€å½“åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹æ—¶ï¼Œå®ƒå°†ä¸ºä»å½“å‰å‘½åç©ºé—´åˆ°åˆå§‹ PID å‘½åç©ºé—´çš„æ¯ä¸ªå‘½åç©ºé—´éƒ½æœ‰ä¸€ä¸ª PIDã€‚å› æ­¤ï¼Œåˆå§‹ PID å‘½åç©ºé—´èƒ½å¤Ÿçœ‹åˆ°æ‰€æœ‰è¿›ç¨‹ï¼Œå°½ç®¡ PID ä¸å…¶ä»–å‘½åç©ºé—´å°†çœ‹åˆ°çš„è¿›ç¨‹ä¸åŒã€‚

> å°±è·Ÿä½  fork åï¼Œä½ çš„çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹ä¹‹é—´çš„å…³ç³»ã€‚

åœ¨ PID å‘½åç©ºé—´ä¸­åˆ›å»ºçš„ç¬¬ä¸€ä¸ªè¿›ç¨‹è¢«åˆ†é…äº†è¿›ç¨‹ ID å· 1ï¼Œå¹¶è·å¾—ä¸æ™®é€š init è¿›ç¨‹ç›¸åŒçš„å¤§éƒ¨åˆ†ç‰¹æ®Šå¾…é‡ï¼Œæœ€å€¼å¾—æ³¨æ„çš„æ˜¯ **å‘½åç©ºé—´ä¸­çš„å­¤ç«‹è¿›ç¨‹é™„åŠ åˆ°å®ƒ**ã€‚è¿™ä¹Ÿæ„å‘³ç€ç»ˆæ­¢æ­¤ `PID 1` è¿›ç¨‹å°†ç«‹å³ç»ˆæ­¢å…¶ PID å‘½åç©ºé—´ä¸­çš„æ‰€æœ‰è¿›ç¨‹å’Œä»»ä½•åä»£ã€‚ 

> è¿™æ ·æˆ‘ä»¬ä¾¿æ˜¯å¯ä»¥ç†è§£äº†ä¸ºä»€ä¹ˆ docker ä¸­å®¹å™¨ **å•ä¸€åŸåˆ™**  å§ã€‚



### Network (net)

ç½‘ç»œå‘½åç©ºé—´è™šæ‹ŸåŒ–äº†ç½‘ç»œå †æ ˆã€‚åˆ›å»ºæ—¶ï¼Œç½‘ç»œåç§°ç©ºé—´ä»…åŒ…å«ä¸€ä¸ª**ç¯å›æ¥å£**ã€‚

> ç½‘ç»œçš„ç¯å›æ¥å£ï¼ˆLoopback Interfaceï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç½‘ç»œæ¥å£ï¼Œç”¨äºå°†ç½‘ç»œé€šä¿¡æ•°æ®åŒ…å‘é€å›åˆ°å‘é€æ–¹ï¼Œè€Œä¸æ˜¯é€šè¿‡å®é™…çš„ç‰©ç†ç½‘ç»œæ¥å£å‘é€å‡ºå»ã€‚
>
> ç¯å›æ¥å£é€šå¸¸ç”¨äºæœ¬åœ°ä¸»æœºçš„è‡ªæˆ‘æµ‹è¯•ï¼Œä»¥ç¡®ä¿ç½‘ç»œåè®®æ ˆå’Œåº”ç”¨ç¨‹åºæ˜¯å¦æ­£å¸¸å·¥ä½œã€‚ç¯å›æ¥å£çš„IPåœ°å€é€šå¸¸ä¸º127.0.0.1ï¼Œä¹Ÿç§°ä¸ºæœ¬åœ°å›ç¯åœ°å€ã€‚**å½“åº”ç”¨ç¨‹åºå°è¯•è¿æ¥æœ¬åœ°ä¸»æœºä¸Šçš„æœåŠ¡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æœ¬åœ°å›ç¯åœ°å€æ¥æµ‹è¯•è¯¥æœåŠ¡æ˜¯å¦æ­£åœ¨è¿è¡Œã€‚**
>
> ç¯å›æ¥å£è¿˜å¯ç”¨äºæ¨¡æ‹Ÿè¿œç¨‹ä¸»æœºï¼Œä½¿åº”ç”¨ç¨‹åºèƒ½å¤Ÿä»¥ä¸ä¸è¿œç¨‹ä¸»æœºé€šä¿¡ç›¸åŒçš„æ–¹å¼è¿›è¡Œæµ‹è¯•ï¼Œè€Œæ— éœ€å®é™…è¿æ¥åˆ°è¿œç¨‹ä¸»æœºã€‚
>
> éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºç¯å›æ¥å£å¹¶ä¸æ¶‰åŠå®é™…çš„ç½‘ç»œä¼ è¾“ï¼Œå› æ­¤å®ƒä¸é€‚ç”¨äºæµ‹è¯•ä¸ç½‘ç»œä¼ è¾“ç›¸å…³çš„é—®é¢˜ï¼Œä¾‹å¦‚å»¶è¿Ÿå’Œååé‡ã€‚
>
> ```bash
> # æµ‹è¯• SMTP æœåŠ¡
> telnet 127.0.0.1 25
> ```

æ¯ä¸ªç½‘ç»œæ¥å£ï¼ˆç‰©ç†æˆ–è™šæ‹Ÿï¼‰åªå­˜åœ¨äº 1 ä¸ªå‘½åç©ºé—´ä¸­ï¼Œå¹¶ä¸”å¯ä»¥åœ¨å‘½åç©ºé—´ä¹‹é—´ç§»åŠ¨ã€‚

> æ¯ä¸ªç½‘ç»œæ¥å£åªèƒ½å­˜åœ¨äºä¸€ä¸ªå‘½åç©ºé—´ä¸­ï¼Œä½†å¯ä»¥åœ¨å‘½åç©ºé—´ä¹‹é—´ç§»åŠ¨ã€‚è¿™æ„å‘³ç€ï¼Œä¸€ä¸ªç½‘ç»œæ¥å£å¯ä»¥ä»ä¸€ä¸ªå‘½åç©ºé—´ä¸­ç§»åŠ¨åˆ°å¦ä¸€ä¸ªå‘½åç©ºé—´ä¸­ï¼Œä»è€Œä½¿ä¸åŒçš„å‘½åç©ºé—´å…±äº«åŒä¸€ç½‘ç»œæ¥å£ã€‚è¿™ç§æ–¹å¼å¯ä»¥å®ç°ç½‘ç»œæ¥å£èµ„æºçš„å…±äº«å’Œé‡ç”¨ï¼Œæé«˜ç³»ç»Ÿçš„èµ„æºåˆ©ç”¨ç‡ã€‚
>
> ä¾‹å¦‚ï¼Œåœ¨å®¹å™¨æŠ€æœ¯ä¸­ï¼Œæ¯ä¸ªå®¹å™¨éƒ½å¯ä»¥æ‹¥æœ‰è‡ªå·±çš„ç½‘ç»œå‘½åç©ºé—´ï¼Œè€Œå®¹å™¨ä¹‹é—´å…±äº«å®¿ä¸»æœºçš„ç‰©ç†ç½‘ç»œæ¥å£ã€‚å½“ä¸€ä¸ªæ–°å®¹å™¨åˆ›å»ºæ—¶ï¼Œå¯ä»¥é€šè¿‡å°†ä¸€ä¸ªç°æœ‰çš„ç½‘ç»œæ¥å£ç§»åŠ¨åˆ°æ–°çš„å‘½åç©ºé—´ä¸­ï¼Œä»è€Œåœ¨æ–°çš„å‘½åç©ºé—´ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„è™šæ‹Ÿç½‘ç»œæ¥å£ã€‚è¿™ä½¿å¾—å®¹å™¨å¯ä»¥æ‹¥æœ‰ç‹¬ç«‹çš„IPåœ°å€å’Œç½‘ç»œåè®®æ ˆï¼Œè€Œä¸ä¼šä¸å…¶ä»–å®¹å™¨å‘ç”Ÿå†²çªã€‚åŒæ—¶ï¼Œå®ƒä»¬ä¹Ÿå¯ä»¥ä¸å®¿ä¸»æœºå’Œå…¶ä»–å®¹å™¨è¿›è¡Œé€šä¿¡ï¼Œå®ç°ç½‘ç»œäº’è¿ã€‚

æ¯ä¸ªåç§°ç©ºé—´éƒ½æœ‰ä¸€ç»„ç§æœ‰ IP åœ°å€ã€è‡ªå·±çš„è·¯ç”±è¡¨ã€å¥—æ¥å­—åˆ—è¡¨ã€è¿æ¥è·Ÿè¸ªè¡¨ã€é˜²ç«å¢™å’Œå…¶ä»–ä¸ç½‘ç»œç›¸å…³çš„èµ„æºã€‚

é”€æ¯ç½‘ç»œåç§°ç©ºé—´ä¼šé”€æ¯å…¶ä¸­çš„ä»»ä½•è™šæ‹Ÿæ¥å£ï¼Œå¹¶å°†å…¶ä¸­çš„ä»»ä½•ç‰©ç†æ¥å£ç§»å›åˆå§‹ç½‘ç»œåç§°ç©ºé—´ã€‚



### Inter-process Communication (ipcï¼‰

IPC å‘½åç©ºé—´å°†è¿›ç¨‹ä¸ SysV é£æ ¼çš„è¿›ç¨‹é—´é€šä¿¡éš”ç¦»å¼€æ¥ã€‚è¿™å¯ä»¥é˜²æ­¢ä¸åŒ IPC å‘½åç©ºé—´ä¸­çš„è¿›ç¨‹ä½¿ç”¨ SHM å‡½æ•°æ—ç­‰åœ¨ä¸¤ä¸ªè¿›ç¨‹ä¹‹é—´å»ºç«‹å…±äº«å†…å­˜èŒƒå›´ã€‚ç›¸åï¼Œæ¯ä¸ªè¿›ç¨‹å°†èƒ½å¤Ÿä¸ºå…±äº«å†…å­˜åŒºåŸŸä½¿ç”¨ç›¸åŒçš„æ ‡è¯†ç¬¦ï¼Œå¹¶ç”Ÿæˆä¸¤ä¸ªè¿™æ ·çš„ä¸åŒåŒºåŸŸã€‚



### UTS

UTSï¼ˆUNIX åˆ†æ—¶ï¼‰å‘½åç©ºé—´å…è®¸å•ä¸ªç³»ç»Ÿå¯¹ä¸åŒçš„è¿›ç¨‹æ˜¾ç¤ºä¸ºå…·æœ‰ä¸åŒçš„ä¸»æœºåå’ŒåŸŸåã€‚ â€œå½“ä¸€ä¸ªè¿›ç¨‹åˆ›å»ºä¸€ä¸ªæ–°çš„ UTS å‘½åç©ºé—´æ—¶......æ–° UTS å‘½åç©ºé—´çš„ä¸»æœºåå’ŒåŸŸæ˜¯ä»è°ƒç”¨è€…çš„ UTS å‘½åç©ºé—´ä¸­çš„ç›¸åº”å€¼å¤åˆ¶çš„ã€‚â€ 



### User ID (user)

ç”¨æˆ·å‘½åç©ºé—´æ˜¯ä¸€é¡¹åŠŸèƒ½ï¼Œå¯åœ¨è‡ªå†…æ ¸ 3.8 èµ·å¯ç”¨çš„å¤šç»„è¿›ç¨‹ä¹‹é—´æä¾›æƒé™éš”ç¦»å’Œç”¨æˆ·èº«ä»½éš”ç¦»ã€‚ åœ¨ç®¡ç†ååŠ©ä¸‹ï¼Œå¯ä»¥æ„å»ºä¸€ä¸ªçœ‹ä¼¼å…·æœ‰ç®¡ç†æƒé™çš„å®¹å™¨ï¼Œè€Œæ— éœ€å®é™…ä¸ºç”¨æˆ·è¿›ç¨‹æä¾›æ›´é«˜çš„æƒé™ã€‚ä¸ PID å‘½åç©ºé—´ä¸€æ ·ï¼Œç”¨æˆ·å‘½åç©ºé—´æ˜¯åµŒå¥—çš„ï¼Œæ¯ä¸ªæ–°çš„ç”¨æˆ·å‘½åç©ºé—´éƒ½è¢«è§†ä¸ºåˆ›å»ºå®ƒçš„ç”¨æˆ·å‘½åç©ºé—´çš„å­çº§ã€‚

ç”¨æˆ·å‘½åç©ºé—´åŒ…å«ä¸€ä¸ªæ˜ å°„è¡¨ï¼Œå°†ç”¨æˆ· ID ä»å®¹å™¨çš„è§’åº¦è½¬æ¢ä¸ºç³»ç»Ÿçš„è§’åº¦ã€‚ä¾‹å¦‚ï¼Œè¿™å…è®¸ root ç”¨æˆ·åœ¨å®¹å™¨ä¸­æ‹¥æœ‰ç”¨æˆ· ID 0ï¼Œä½†å®é™…ä¸Šè¢«ç³»ç»Ÿè§†ä¸ºç”¨æˆ· ID 1,400,000 ä»¥è¿›è¡Œæ‰€æœ‰æƒæ£€æŸ¥ã€‚ä¸€ä¸ªç±»ä¼¼çš„è¡¨ç”¨äºç»„ ID æ˜ å°„å’Œæ‰€æœ‰æƒæ£€æŸ¥ã€‚

ä¸ºäº†ä¿ƒè¿›ç®¡ç†æ“ä½œçš„ç‰¹æƒéš”ç¦»ï¼Œæ¯ä¸ªå‘½åç©ºé—´ç±»å‹åœ¨åˆ›å»ºæ—¶éƒ½è¢«è®¤ä¸ºå±äºåŸºäºæ´»åŠ¨ç”¨æˆ·å‘½åç©ºé—´çš„ç”¨æˆ·å‘½åç©ºé—´ã€‚åœ¨é€‚å½“çš„ç”¨æˆ·å‘½åç©ºé—´ä¸­å…·æœ‰ç®¡ç†æƒé™çš„ç”¨æˆ·å°†è¢«å…è®¸åœ¨è¯¥å…¶ä»–å‘½åç©ºé—´ç±»å‹ä¸­æ‰§è¡Œç®¡ç†æ“ä½œã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªè¿›ç¨‹å…·æœ‰æ›´æ”¹ç½‘ç»œæ¥å£ IP åœ°å€çš„ç®¡ç†æƒé™ï¼Œåªè¦å®ƒè‡ªå·±çš„ç”¨æˆ·å‘½åç©ºé—´ä¸æ‹¥æœ‰ç½‘ç»œå‘½åç©ºé—´çš„ç”¨æˆ·å‘½åç©ºé—´ç›¸åŒï¼ˆæˆ–ç¥–å…ˆï¼‰ï¼Œå®ƒå°±å¯ä»¥è¿™æ ·åšã€‚å› æ­¤ï¼Œåˆå§‹ç”¨æˆ·å‘½åç©ºé—´å¯¹ç³»ç»Ÿä¸­çš„æ‰€æœ‰å‘½åç©ºé—´ç±»å‹å…·æœ‰ç®¡ç†æ§åˆ¶æƒã€‚ 



### Control group (cgroup) Namespace

cgroup å‘½åç©ºé—´ç±»å‹éšè—äº†è¿›ç¨‹æ‰€å±çš„æ§åˆ¶ç»„çš„èº«ä»½ã€‚è¿™æ ·ä¸€ä¸ªåç§°ç©ºé—´ä¸­çš„è¿›ç¨‹ï¼Œæ£€æŸ¥ä»»ä½•è¿›ç¨‹å±äºå“ªä¸ªæ§åˆ¶ç»„ï¼Œä¼šçœ‹åˆ°ä¸€æ¡å®é™…ä¸Šç›¸å¯¹äºåˆ›å»ºæ—¶è®¾ç½®çš„æ§åˆ¶ç»„çš„è·¯å¾„ï¼Œéšè—å…¶çœŸæ­£çš„æ§åˆ¶ç»„ä½ç½®å’Œèº«ä»½ã€‚è¿™ç§å‘½åç©ºé—´ç±»å‹è‡ª 2016 å¹´ 3 æœˆèµ·å°±å­˜åœ¨äº Linux 4.6 ä¸­ã€‚ ã€

**CGroup åœ¨ å®¹å™¨ä¸­å½±å“æ˜¯å¾ˆå¤§çš„Z~**

Cgroup namespace æ˜¯è¿›ç¨‹çš„ cgroups çš„è™šæ‹ŸåŒ–è§†å›¾ï¼Œé€šè¿‡ `/proc/[pid]/cgroup` å’Œ `/proc/[pid]/mountinfo` å±•ç¤ºã€‚

ä½¿ç”¨ cgroup namespace éœ€è¦å†…æ ¸å¼€å¯ `CONFIG_CGROUPS` é€‰é¡¹ã€‚å¯é€šè¿‡ä»¥ä¸‹æ–¹å¼éªŒè¯ï¼š

```bash
[root@VM-4-3-opencloudos ~]#  grep CONFIG_CGROUPS /boot/config-$(uname -r)
CONFIG_CGROUPS=y
```

cgroup namespace æä¾›çš„äº†ä¸€ç³»åˆ—çš„éš”ç¦»æ”¯æŒï¼š

+ é˜²æ­¢ä¿¡æ¯æ³„æ¼ï¼ˆå®¹å™¨ä¸åº”è¯¥çœ‹åˆ°å®¹å™¨å¤–çš„ä»»ä½•ä¿¡æ¯ï¼‰ã€‚
+ ç®€åŒ–äº†å®¹å™¨è¿ç§»ã€‚
+ é™åˆ¶å®¹å™¨è¿›ç¨‹èµ„æºï¼Œå› ä¸ºå®ƒä¼šæŠŠ cgroup æ–‡ä»¶ç³»ç»Ÿè¿›è¡ŒæŒ‚è½½ï¼Œä½¿å¾—å®¹å™¨è¿›ç¨‹æ— æ³•è·å–ä¸Šå±‚çš„è®¿é—®æƒé™ã€‚

æ¯ä¸ª cgroup namespace éƒ½æœ‰è‡ªå·±çš„ä¸€ç»„ cgroup æ ¹ç›®å½•ã€‚è¿™äº› cgroup çš„æ ¹ç›®å½•æ˜¯åœ¨ `/proc/[pid]/cgroup` æ–‡ä»¶ä¸­å¯¹åº”è®°å½•çš„ç›¸å¯¹ä½ç½®çš„åŸºç‚¹ã€‚å½“ä¸€ä¸ªè¿›ç¨‹ç”¨ `CLONE_NEWCGROUP`ï¼ˆclone(2) æˆ–è€… unshare(2)ï¼‰ åˆ›å»ºä¸€ä¸ªæ–°çš„ cgroup namespaceæ—¶ï¼Œå®ƒå½“å‰çš„ cgroups çš„ç›®å½•å°±å˜æˆäº†æ–° namespace çš„ cgroup æ ¹ç›®å½•ã€‚

```bash
[root@VM-4-3-opencloudos ~] cat /proc/self/cgroup 
0::/user.slice/user-1000.slice/session-2.scope
```

å½“ä¸€ä¸ªç›®æ ‡è¿›ç¨‹ä» `/proc/[pid]/cgroup` ä¸­è¯»å– cgroup å…³ç³»æ—¶ï¼Œæ¯ä¸ªè®°å½•çš„è·¯å¾„åä¼šåœ¨ç¬¬ä¸‰å­—æ®µä¸­å±•ç¤ºï¼Œä¼šå…³è”åˆ°æ­£åœ¨è¯»å–çš„è¿›ç¨‹çš„ç›¸å…³ cgroup åˆ†å±‚ç»“æ„çš„æ ¹ç›®å½•ã€‚å¦‚æœç›®æ ‡è¿›ç¨‹çš„ cgroup ç›®å½•ä½äºæ­£åœ¨è¯»å–çš„è¿›ç¨‹çš„ cgroup namespace æ ¹ç›®å½•ä¹‹å¤–æ—¶ï¼Œé‚£ä¹ˆï¼Œè·¯å¾„åç§°å°†ä¼šå¯¹æ¯ä¸ª cgroup å±‚æ¬¡ä¸­çš„ä¸Šå±‚èŠ‚ç‚¹æ˜¾ç¤º `../` ã€‚

æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‹é¢çš„ç¤ºä¾‹ï¼ˆè¿™é‡Œä»¥ cgroup v1 ä¸ºä¾‹ï¼Œå¦‚æœä½ æƒ³çœ‹ v2 ç‰ˆæœ¬çš„ç¤ºä¾‹ï¼Œè¯·åœ¨ç•™è¨€ä¸­å‘Šè¯‰æˆ‘ï¼‰ï¼š

1. åœ¨åˆå§‹çš„ cgroup namespace ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ root ï¼ˆæˆ–è€…æœ‰ root æƒé™çš„ç”¨æˆ·ï¼‰ï¼Œåœ¨ freezer å±‚ä¸‹åˆ›å»ºä¸€ä¸ªå­ cgroup åä¸º `moelove-sub`ï¼ŒåŒæ—¶ï¼Œå°†è¿›ç¨‹æ”¾å…¥è¯¥ cgroup è¿›è¡Œé™åˆ¶ã€‚

```plain
[root@VM-4-3-opencloudos ~] mkdir -p /sys/fs/cgroup/freezer/moelove-sub
[root@VM-4-3-opencloudos ~] sleep 6666666 & 
[1] 1489125                  
[root@VM-4-3-opencloudos ~] echo 1489125 > /sys/fs/cgroup/freezer/moelove-sub/cgroup.procs
```

1. æˆ‘ä»¬åœ¨ freezer å±‚ä¸‹åˆ›å»ºå¦å¤–ä¸€ä¸ªå­ cgroupï¼Œåä¸º `moelove-sub2`ï¼Œ å¹¶ä¸”å†æ”¾å…¥æ‰§è¡Œè¿›ç¨‹å·ã€‚å¯ä»¥çœ‹åˆ°å½“å‰çš„è¿›ç¨‹å·²ç»çº³å…¥åˆ° `moelove-sub2`çš„ cgroup ä¸‹ç®¡ç†äº†ã€‚

```plain
[root@VM-4-3-opencloudos ~] mkdir -p /sys/fs/cgroup/freezer/moelove-sub2
[root@VM-4-3-opencloudos ~] echo $$
1488899
[root@VM-4-3-opencloudos ~] echo 1488899 > /sys/fs/cgroup/freezer/moelove-sub2/cgroup.procs 
[root@VM-4-3-opencloudos ~] cat /proc/self/cgroup |grep freezer
7:freezer:/moelove-sub2
```

1. æˆ‘ä»¬ä½¿ç”¨ `unshare(1)` åˆ›å»ºä¸€ä¸ªè¿›ç¨‹ï¼Œè¿™é‡Œä½¿ç”¨äº† `-C`å‚æ•°è¡¨ç¤ºæ˜¯æ–°çš„ cgroup namespaceï¼Œ ä½¿ç”¨äº† `-m`å‚æ•°è¡¨ç¤ºæ˜¯æ–°çš„ mount namespaceã€‚

```plain
[root@VM-4-3-opencloudos ~] unshare -Cm bash
root@moelove:~#
```

1. ä»ç”¨ unshare(1) å¯åŠ¨çš„æ–° shell ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ `/proc/[pid]/cgroup` æ–‡ä»¶ä¸­çœ‹åˆ°ï¼Œæ–° shell å’Œä»¥ä¸Šç¤ºä¾‹ä¸­çš„è¿›ç¨‹ï¼š

```bash
root@moelove:~# cat /proc/self/cgroup | grep freezer
7:freezer:/
root@moelove:~# cat /proc/1/cgroup | grep freezer
7:freezer:/..

# ç¬¬ä¸€ä¸ªç¤ºä¾‹è¿›ç¨‹
root@moelove:~# cat /proc/1489125/cgroup | grep freezer
7:freezer:/../moelove-sub
```

1. ä»ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ–° shell çš„ freezer cgroup å…³ç³»ä¸­ï¼Œå½“æ–°çš„ cgroup namespace åˆ›å»ºæ—¶ï¼Œfreezer cgroup çš„æ ¹ç›®å½•ä¸å®ƒçš„å…³ç³»ä¹Ÿå°±å»ºç«‹äº†ã€‚

```plain
root@moelove:~# cat /proc/self/mountinfo | grep freezer
1238 1230 0:37 /.. /sys/fs/cgroup/freezer rw,nosuid,nodev,noexec,relatime - cgroup cgroup rw,freezer
```

1. ç¬¬å››ä¸ªå­—æ®µ ( `/..`) æ˜¾ç¤ºäº†åœ¨ cgroup æ–‡ä»¶ç³»ç»Ÿä¸­çš„æŒ‚è½½ç›®å½•ã€‚ä» cgroup namespaces çš„å®šä¹‰ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œè¿›ç¨‹å½“å‰çš„ freezer cgroup ç›®å½•å˜æˆäº†å®ƒçš„æ ¹ç›®å½•ï¼Œæ‰€ä»¥è¿™ä¸ªå­—æ®µæ˜¾ç¤º `/..` ã€‚æˆ‘ä»¬å¯ä»¥é‡æ–°æŒ‚è½½æ¥å¤„ç†å®ƒã€‚

```plain
root@moelove:~# mount --make-rslave /
root@moelove:~# umount /sys/fs/cgroup/freezer
root@moelove:~# mount -t cgroup -o freezer freezer /sys/fs/cgroup/freezer
root@moelove:~# cat /proc/self/mountinfo | grep freezer
1238 1230 0:37 / /sys/fs/cgroup/freezer rw,relatime - cgroup freezer rw,freezer
root@moelove:~# mount |grep freezer
freezer on /sys/fs/cgroup/freezer type cgroup (rw,relatime,freezer)
```



### Time Namespace

æ—¶é—´å‘½åç©ºé—´å…è®¸è¿›ç¨‹ä»¥ç±»ä¼¼äº UTS å‘½åç©ºé—´çš„æ–¹å¼æŸ¥çœ‹ä¸åŒçš„ç³»ç»Ÿæ—¶é—´ã€‚ 2018å¹´æå‡ºï¼Œç™»é™†Linux 5.6ï¼Œ2020å¹´3æœˆå‘å¸ƒã€‚ 





## ä¸åŒå‘½åç©ºé—´çš„ç½‘ç»œå¦‚ä½•é€šä¿¡

ä¸è¿‡æˆ‘ä»¬ä¸åšé‚£ä¹ˆæ·±ç©¶çš„è®¨è®ºï¼Œç®€åŒ–é—®é¢˜ï¼ŒLinux ç³»ç»Ÿå®é™…ä¸Šæ²¡æœ‰å®ç°ç›¸å…³çš„è™šæ‹Ÿè·¯ç”±å™¨è®¾å¤‡ï¼Œè‡ªç„¶ä¹Ÿæ²¡æœ‰å·¥å…·å¯ä»¥æ“ä½œè·¯ç”±å™¨ï¼Œå› ä¸º **Linux æœ¬èº«å°±æ˜¯ä¸€å°è·¯ç”±å™¨**ã€‚

Linux æä¾›ä¸€ä¸ªå¼€å…³æ¥æ“ä½œè·¯ç”±åŠŸèƒ½ï¼Œå°±æ˜¯ `/proc/sys/net/ipv4/ip_forward`ï¼Œé»˜è®¤è¿™ä¸ªå¼€å…³æ˜¯å…³çš„ï¼Œæ‰“å¼€åªéœ€ï¼š

```javascript
echo 1 > /proc/sys/net/ipv4/ip_forward
```

ä½†è¿™ç§æ‰“å¼€æ–¹å¼åªæ˜¯ä¸´æ—¶çš„ï¼Œå¦‚æœè¦ä¸€åŠ³æ°¸é€¸ï¼Œå¯ä»¥ä¿®æ”¹é…ç½®æ–‡ä»¶ `/etc/sysctl.conf`ï¼Œæ·»åŠ æˆ–ä¿®æ”¹é¡¹ `net.ipv4.ip_forward` ä¸ºï¼š

```javascript
net.ipv4.ip_forward = 1
```



### å®è·µ

ä¸ºäº†é™ä½å¤§å®¶å®è·µçš„éš¾åº¦ï¼Œæˆ‘ä»¬å°±ä¸åˆ›å»ºè™šæ‹Ÿæœºäº†ï¼Œç›´æ¥ä½¿ç”¨ namespaceï¼Œä¸€æ¡ `ip` å‘½ä»¤å°±å¯ä»¥æå®šæ‰€æœ‰çš„æ“ä½œã€‚

![image-20230226115627130](http://sm.nsddd.top/sm202302261156342.png)



**åˆ›å»ºä¸¤ä¸ª namespaceï¼š**

```bash
ip netns add ns1
ip netns add ns2
```



**åˆ›å»ºä¸¤å¯¹ veth-pairï¼Œä¸€ç«¯åˆ†åˆ«æŒ‚åœ¨ä¸¤ä¸ª namespace ä¸­ï¼š**

```bash
ip link add v1 type veth peer name v1_r
ip link add v2 type veth peer name v2_r

ip link set v1 netns ns1
ip link set v2 netns ns2
```

> veth-pair æ˜¯ä¸€ç§ Linux å†…æ ¸ä¸­çš„è™šæ‹Ÿç½‘ç»œè®¾å¤‡ï¼Œå®ƒæ˜¯ç”±ä¸€å¯¹è™šæ‹Ÿç½‘ç»œæ¥å£ç»„æˆçš„ï¼Œä¸€ä¸ªæ˜¯ veth0ï¼Œå¦ä¸€ä¸ªæ˜¯ veth1ã€‚è¿™ä¸¤ä¸ªæ¥å£ä¹‹é—´é€šè¿‡è™šæ‹Ÿçº¿ç¼†è¿æ¥åœ¨ä¸€èµ·ï¼Œå½¢æˆäº†ä¸€æ¡è™šæ‹Ÿç½‘ç»œé“¾è·¯ã€‚
>
> **veth-pair é€šå¸¸è¢«ç”¨äºåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿçš„ç½‘ç»œå‘½åç©ºé—´**ï¼Œå¹¶å°† veth-pair çš„ä¸€ä¸ªç«¯å£è¿æ¥åˆ°è¯¥å‘½åç©ºé—´ä¸­ã€‚è¿™æ ·å°±å¯ä»¥åœ¨è¯¥å‘½åç©ºé—´å†…åˆ›å»ºè‡ªå·±ç‹¬ç«‹çš„ç½‘ç»œç¯å¢ƒï¼ŒåŒ…æ‹¬ IP åœ°å€ã€è·¯ç”±è¡¨ã€é˜²ç«å¢™è§„åˆ™ç­‰ç­‰ã€‚**å¦ä¸€ä¸ªç«¯å£åˆ™å¯ä»¥è¿æ¥åˆ°å®¿ä¸»æœºçš„ç½‘ç»œä¸­ï¼Œæˆ–è€…è¿æ¥åˆ°å…¶ä»–ç½‘ç»œè®¾å¤‡ä¸Šï¼Œå®ç°æ•°æ®ä¼ è¾“å’Œç½‘ç»œé€šä¿¡ã€‚**
>
> **veth-pair æœ‰å¾ˆå¤šç”¨é€”ï¼š**
>
> + å¯ä»¥ç”¨äºå®¹å™¨åŒ–æŠ€æœ¯ä¸­ï¼Œå°†å®¹å™¨ä¸å®¿ä¸»æœºéš”ç¦»ï¼Œåˆ›å»ºå®¹å™¨çš„ç½‘ç»œç¯å¢ƒï¼›
> + ä¹Ÿå¯ä»¥ç”¨äº VPN ç½‘ç»œä¸­ï¼Œé€šè¿‡åˆ›å»ºå¤šä¸ª veth-pair è¿æ¥åˆ°ä¸åŒçš„è™šæ‹Ÿç½‘ç»œå‘½åç©ºé—´ï¼Œå®ç°ç½‘ç»œéš”ç¦»å’Œå®‰å…¨é€šä¿¡ã€‚
> + veth-pair è¿˜å¯ä»¥ç”¨äºæµ‹è¯•å’Œæ¨¡æ‹Ÿç½‘ç»œç¯å¢ƒï¼Œæ–¹ä¾¿å¼€å‘äººå‘˜è¿›è¡Œç½‘ç»œè°ƒè¯•å’Œæ€§èƒ½æµ‹è¯•ã€‚



**åˆ†åˆ«ç»™ä¸¤å¯¹ veth-pair ç«¯ç‚¹é…ä¸Š IP å¹¶å¯ç”¨ï¼š**

```bash
ip a a 10.10.10.1/24 dev v1_r
ip l s v1_r up
ip a a 10.10.20.1/24 dev v2_r
ip l s v2_r up

ip netns exec ns1 ip a a 10.10.10.2/24 dev v1
ip netns exec ns1 ip l s v1 up
ip netns exec ns2 ip a a 10.10.20.2/24 dev v2
ip netns exec ns2 ip l s v2 up
```



**åœ¨ä¸€ä¸ªå‘½åç©ºé—´ä¸­ï¼Œä½¿ç”¨ ping å‘½ä»¤æµ‹è¯•å¦ä¸€ä¸ªå‘½åç©ºé—´ä¸­çš„ IP åœ°å€ï¼š**

éªŒè¯ä¸€ä¸‹ï¼š v1 ping v2ï¼Œç»“æœä¸é€šã€‚

```bash
[root@VM-4-3-opencloudos ~]# ip netns exec ns1 ping 10.10.20.2
PING 10.10.20.2 (10.10.20.2) 56(84) bytes of data.
```

çœ‹ä¸‹ `ip_forward` çš„å€¼ï¼š

```bash
[root@VM-4-3-opencloudos ~]# cat /proc/sys/net/ipv4/ip_forward
0
```

**è®¾ç½®ä¸º ï¼š1 ** è¿˜æ˜¯ä¸é€šã€‚

çœ‹ä¸‹ ns1 çš„è·¯ç”±è¡¨ï¼š

```bash
[root@VM-4-3-opencloudos ~]# ip netns exec ns1 route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
10.10.10.0      0.0.0.0         255.255.255.0   U     0      0        0 v1
```

åªæœ‰ä¸€æ¡ç›´è¿è·¯ç”±ï¼Œæ²¡æœ‰å»å¾€ `10.10.20.0/24` ç½‘æ®µçš„è·¯ç”±ï¼Œæ€ä¹ˆé€šï¼Ÿé‚£å°±ç»™å®ƒé…ä¸€æ¡ï¼š

```bash
[root@VM-4-3-opencloudos ~]# ip netns exec ns1 route add -net 10.10.20.0 netmask 255.255.255.0 gw 10.10.10.1

[root@VM-4-3-opencloudos ~]# ip netns exec ns1 route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
10.10.10.0      0.0.0.0         255.255.255.0   U     0      0        0 v1
10.10.20.0      10.10.10.1      255.255.255.0   UG    0      0        0 v1
```

åŒç†ä¹Ÿç»™ ns2 é…ä¸Šå»å¾€ `10.10.10.0/24` ç½‘æ®µçš„è·¯ç”±ã€‚

```bash
[root@VM-4-3-opencloudos ~]# ip netns exec ns2 route add -net 10.10.10.0 netmask 255.255.255.0 gw 10.10.20.1
```

æœ€åå† pingï¼ŒæˆåŠŸäº†ï¼

```bash
[root@VM-4-3-opencloudos ~]# ip netns exec ns1 ping 10.10.20.2
PING 10.10.20.2 (10.10.20.2) 56(84) bytes of data.
64 bytes from 10.10.20.2: icmp_seq=1 ttl=63 time=0.036 ms
64 bytes from 10.10.20.2: icmp_seq=2 ttl=63 time=0.040 ms
64 bytes from 10.10.20.2: icmp_seq=3 ttl=63 time=0.043 ms
64 bytes from 10.10.20.2: icmp_seq=4 ttl=63 time=0.052 ms
64 bytes from 10.10.20.2: icmp_seq=5 ttl=63 time=0.042 ms
^C
--- 10.10.20.2 ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 4129ms
rtt min/avg/max/mdev = 0.036/0.042/0.052/0.008 ms
```



## å®æˆ˜

è™šæ‹Ÿæœºåœ°å€192.168.232.133ï¼Œç½‘å…³ä¸º 192.168.232.10ï¼›ä¸»æœºåœ°å€ä¸º10.100.59.167ï¼Œç½‘å…³ä¸º 10.100.0.1ï¼›è®¾ç½®è·¯ç”±ï¼Œå®ç°é€šä¿¡

**è™šæ‹Ÿæœºï¼š**

éœ€è¦å°†é»˜è®¤ç½‘å…³è®¾ç½®ä¸º192.168.232.10ã€‚è¿™å°†å…è®¸è™šæ‹Ÿæœºè®¿é—®åœ¨è¯¥ç½‘å…³ä¸‹çš„ç½‘ç»œã€‚ç„¶åï¼Œæ‚¨éœ€è¦åœ¨192.168.232.10ç½‘å…³ä¸Šè®¾ç½®ä¸€æ¡è·¯ç”±ï¼Œä»¥æŒ‡å‘10.100.59.167çš„ç½‘ç»œã€‚

å…·ä½“æ¥è¯´ï¼Œåœ¨192.168.232.10ç½‘å…³ä¸Šè®¾ç½®ä»¥ä¸‹è·¯ç”±ï¼š

ç›®æ ‡ç½‘ç»œï¼š10.100.59.0/24 ä¸‹ä¸€è·³ï¼š192.168.232.133

è¿™å°†å‘Šè¯‰192.168.232.10ç½‘å…³å°†ç›®æ ‡ç½‘ç»œ10.100.59.0/24çš„æ‰€æœ‰æ•°æ®åŒ…å‘é€åˆ°è™šæ‹Ÿæœºçš„åœ°å€192.168.232.133ã€‚è¿™æ ·ï¼Œå½“æ‚¨åœ¨è™šæ‹Ÿæœºä¸Šå‘é€åˆ°10.100.59.0/24ç½‘ç»œçš„æ•°æ®åŒ…æ—¶ï¼Œå®ƒä»¬å°†é€šè¿‡é»˜è®¤ç½‘å…³192.168.232.10å‘é€åˆ°10.100.59.0/24ç½‘ç»œã€‚

```bas
sudo ip route add 10.100.0.0/16 via 192.168.232.10
```



**ä¸»æœºï¼š**

åœ¨ä¸»æœºä¸Šï¼Œéœ€è¦å°†é»˜è®¤ç½‘å…³è®¾ç½®ä¸º10.100.0.1ã€‚ç„¶åï¼Œæ‚¨éœ€è¦åœ¨10.100.0.1ç½‘å…³ä¸Šè®¾ç½®ä»¥ä¸‹è·¯ç”±ï¼š

ç›®æ ‡ç½‘ç»œï¼š192.168.232.0/24 ä¸‹ä¸€è·³ï¼š10.100.59.167

è¿™å°†å‘Šè¯‰10.100.0.1ç½‘å…³å°†ç›®æ ‡ç½‘ç»œ192.168.232.0/24çš„æ‰€æœ‰æ•°æ®åŒ…å‘é€åˆ°ä¸»æœºçš„åœ°å€10.100.59.167ã€‚è¿™æ ·ï¼Œå½“æ‚¨åœ¨ä¸»æœºä¸Šå‘é€åˆ°192.168.232.0/24ç½‘ç»œçš„æ•°æ®åŒ…æ—¶ï¼Œå®ƒä»¬å°†é€šè¿‡é»˜è®¤ç½‘å…³10.100.0.1å‘é€åˆ°192.168.232.0/24ç½‘ç»œã€‚

```bash
route add 192.168.232.0 mask 255.255.255.0 10.100.59.167
```



## END é“¾æ¥

<ul><li><div><a href = '44.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—  </a><a href = '46.md' style='float: right'>  ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div></li></ul>

+ [â“‚ï¸å›åˆ°ç›®å½•ğŸ ](../README.md)

+ [**ğŸ«µå‚ä¸è´¡çŒ®ğŸ’â¤ï¸â€ğŸ”¥ğŸ’–**](https://nsddd.top/archives/contributors))

+ âœ´ï¸ç‰ˆæƒå£°æ˜ &copy; ï¼šæœ¬ä¹¦æ‰€æœ‰å†…å®¹éµå¾ª[CC-BY-SA 3.0åè®®ï¼ˆç½²å-ç›¸åŒæ–¹å¼å…±äº«ï¼‰&copy;](http://zh.wikipedia.org/wiki/Wikipedia:CC-by-sa-3.0åè®®æ–‡æœ¬) 



### Links

+ [Wiki ç»´åŸºç™¾ç§‘](https://en.wikipedia.org/wiki/Linux_namespaces)
