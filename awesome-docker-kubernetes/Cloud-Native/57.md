+ [author](http://nsddd.top)

# ç¬¬57èŠ‚ ææ¡ˆ sealer æ„å»ºå·¥ç¨‹è®¾è®¡

<div><a href = '56.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—  </a><a href = '58.md' style='float: right'>  â¬‡ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div>
<br>

> â¤ï¸ğŸ’•ğŸ’•è®°å½•[sealos](https://github.com/cubxxw/sealos)å¼€æºé¡¹ç›®çš„å­¦ä¹ è¿‡ç¨‹ã€‚[k8s,dockerå’Œäº‘åŸç”Ÿçš„å­¦ä¹ ](https://github.com/cubxxw/sealos)ã€‚Myblog:[http://nsddd.top](http://nsddd.top/)

---
[TOC]

# [ä¸­æ–‡] sealer æ„å»ºå·¥ç¨‹è®¾è®¡

## ğŸ”¥ Questions THAT can BE SOLVED WITH DOCUMENTATION and SEARCH, DON'T ASK !!!

sealer çš„ Makefile è®¾è®¡è¿‡äºå•ä¸€å’Œç®€é™‹ï¼Œæ„å»ºè„šæœ¬([build.sh](http://build.sh)) è¿‡äºé™ˆæ—§å’Œåšé‡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›è®¾è®¡æ–¹æ¡ˆæ¥å¯¹ Makefile å’Œ [build.sh](http://build.sh) è¿›è¡Œè®¾è®¡ä»¥åŠæ”¹è¿›ï¼Œè®©å®ƒä»¬çœ‹ä¸Šå»å¾ˆå‹å¥½ã€‚

Makefile çš„é‡æ„è®¾è®¡åˆ°å¾ˆå¤šçš„æ”¹å˜ï¼ŒåŒ…æ‹¬ä¸€äº›æ¨¡å—çš„å¾®è°ƒå’Œ CICD actions çš„å˜åŒ–ï¼Œè¿™äº›éƒ½ä¼šæ¶‰åŠåˆ°ï¼Œä¹Ÿä¼šæ…¢æ…¢è®¾è®¡ï¼Œä¸ºæ­¤ï¼Œä¹‹å‰æˆ‘æè¿‡ä¸€ä¸ª RFCï¼Œç§»æ­¥åˆ° â†’ https://github.com/sealerio/sealer/issues/2148

**Notion æ–‡æ¡£ï¼š**

+ [https://nsddd.notion.site/sealer-construction-engineering-design-e98b303493d5492e98aff79afadc1cce](https://nsddd.notion.site/sealer-construction-engineering-design-e98b303493d5492e98aff79afadc1cce)



## æ¡ˆä¾‹

<aside> â“ æ˜¯å¦æœ‰ç›¸åŒçš„æ¡ˆä¾‹ï¼Œæˆ–è€…ç»éªŒï¼Ÿ</aside>

è¿™æ˜¯æœ‰çš„ï¼Œåœ¨ç½‘æ˜“çš„ [horizoncd](https://github.com/horizoncd) ç¤¾åŒºä¸­ï¼Œæˆ‘æˆåŠŸè®¾è®¡äº†ä¸€å¥—å®Œæ•´çš„ Makefile æµç¨‹å¹¶ä¸”å¯ä»¥ä½¿ç”¨ã€‚å¹¶ä¸”å¸®åŠ©ä»–ä»¬æ”¹è¿›äº†[è´¡çŒ®è€…æ–‡æ¡£](https://github.com/horizoncd/horizon/blob/main/CONTRIBUTING.md)ã€‚åœ¨å®ƒä»¬çš„é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬èƒ½æ‰¾åˆ°ä¸€å¥—å·²ç»å®ç°çš„æ–¹æ¡ˆï¼Œå¹¶ä¸”æå‡ºäº†è®¾è®¡æ–‡ç¨¿ï¼šhttps://github.com/horizoncd/horizon/issues/100ï¼š

[GitHub - horizoncd/horizon: Production-Grade GitOps CD PlatForm For CloudNative Applications, MiddleWares, etc.](https://github.com/horizoncd/horizon)

ğŸ¯ ç›¸æ¯”è¾ƒ horizonï¼Œsealer çš„è®¾è®¡æœ‰å“ªäº›å±é™©ä¿¡å·ï¼š

+ sealer æ”¯æŒå¤šäºŒè¿›åˆ¶ç¼–è¯‘ï¼Œéœ€è¦å¾ˆå¥½çš„æ‰©å±•æ€§ï¼Œå¹¶ä¸”æ­£ç¡®çš„é€šè¿‡ **å¹¶è¡Œç¼–è¯‘** æé«˜ç¼–è¯‘é€Ÿåº¦ã€‚
+ sealer æœ‰äº› `cgo\c` ä»£ç æ¶‰åŠåˆ° `containers_image_openpgp exclude_graphdriver_devicemapper exclude_graphdriver_btrfs` è¿›è¡Œç¼–è¯‘ã€‚

[image/README.md at ed2844ccc615a447b98344d1bbefca61b3cb7749 Â· mtrmac/image](https://github.com/mtrmac/image/blob/ed2844ccc615a447b98344d1bbefca61b3cb7749/README.md)

è¿™æ ·æé«˜äº†ç¼–è¯‘å’Œæµ‹è¯•çš„éš¾åº¦ï¼Œç»è¿‡è°ƒç ”ï¼Œæˆ‘é€‰æ‹©çš„æµ‹è¯•æ–¹æ¡ˆæ˜¯ `junit-report` ï¼Œåœ¨æœ¬åœ°ä½¿ç”¨ `tmp` ä¸´æ—¶ç›®å½•ä½œä¸ºç¼“å­˜ï¼Œæé«˜è¦†ç›–ç‡æµ‹è¯•é€Ÿåº¦ã€‚

## æ¨¡å—æ–¹æ¡ˆ

è¿ç§»ç›®å½• [version/version.go â†’ pkg/version/version.go](https://github.com/sealerio/sealer/pull/2161/files#diff-73b8ec8a05213857da6e9598e34c5d7a18a6e5349250908ae6710578236977f2)

å°† `hack/` æ”¹åä¸º `scripts/`

è¿™äº›æ–‡ä»¶çš„ä½œç”¨å¦‚ä¸‹ï¼š

+ LICENSE_TEMPLATEï¼šåŒ…å«è®¸å¯è¯çš„æ–‡æœ¬æ¨¡æ¿ã€‚
+ boilerplate.go.txtï¼šç”Ÿæˆæ–° Go æ–‡ä»¶æ—¶ä½¿ç”¨çš„æ–‡æœ¬æ¨¡æ¿ï¼ˆä¸å†ä½¿ç”¨ï¼‰ã€‚
+ [build.sh](http://build.sh/)ï¼šæ–°çš„æ„å»ºè„šæœ¬
+ `coverage.awk`ï¼šç”¨äºä» Go æµ‹è¯•æ–‡ä»¶ä¸­æå–è¦†ç›–ç‡æ•°æ®çš„ AWK è„šæœ¬ã€‚
+ `make-rules/`ï¼šåŒ…å« Makefile è§„åˆ™çš„ç›®å½•ã€‚
  + [common.mk](http://common.mk/)ï¼šåŒ…å«é€šç”¨å˜é‡å’Œè§„åˆ™çš„ Makefileï¼Œæ‰€æœ‰ mk é€šç”¨ã€‚
  + [copyright.mk](http://copyright.mk/)ï¼šç”¨äºç”Ÿæˆä»£ç ä¸­çš„ç‰ˆæƒä¿¡æ¯çš„ Makefileã€‚
  + [dependencies.mk](http://dependencies.mk/)ï¼šåŒ…å«ä¾èµ–å…³ç³»å›¾å’Œç”Ÿæˆä¾èµ–å…³ç³»çš„ Makefile è§„åˆ™ã€‚
  + [gen.mk](http://gen.mk/)ï¼šç”¨äºç”Ÿæˆä»£ç çš„ Makefileã€‚
  + [golang.mk](http://golang.mk/)ï¼šåŒ…å«ä¸ Go ç¼–è¯‘å™¨å’Œå·¥å…·é“¾ç›¸å…³çš„ Makefile è§„åˆ™ã€‚
  + [image.mk](http://image.mk/)ï¼šåŒ…å«ä¸ Docker é•œåƒç”Ÿæˆç›¸å…³çš„ Makefile è§„åˆ™ã€‚
  + [tools.mk](http://tools.mk/)ï¼šåŒ…å«æ„å»ºä¸æµ‹è¯•å·¥å…·çš„ Makefile è§„åˆ™ã€‚

------

ğŸ”¥ åˆ†ä¸ºä¸‰ä¸ªæ¨¡å—ï¼Œåˆ†åˆ«æ˜¯æ–°æ‰©å±•çš„ Makefile æ¼”ç¤ºã€è„šæœ¬æ”¹è¿›çš„æ¼”ç¤ºï¼Œä»¥åŠ CICD æµçš„æ”¹è¿›ï¼š
## makefile

æœ€å¸¸ç”¨çš„å¸®åŠ©ä¿¡æ¯ï¼Œæ”¾å…¥åˆ° `Makefile/`

```go
â¯ make help

Usage: make <TARGETS> <OPTIONS> ...

Targets:

  build                        Build binaries by default
  tidy                         tidy go.mod
  vendor                       vendor go.mod
  fmt                          Run go fmt against code.
  vet                          Run go vet against code.
  lint                         Check syntax and styling of go sources.
  style                        code style -> fmt,vet,lint
  linux                        Build the all with a build script
  linux.%                      Build binaries for Linux (make linux.amd64 OR make linux.arm64)
  format                       Gofmt (reformat) package sources (exclude vendor dir if existed).
  test                         Run unit test.
  cover                        Run unit test and get test coverage.
  updates                      Check for updates to go.mod dependencies
  imports                      task to automatically handle import packages in Go files using goimports tool
  clean                        Remove all files that are created by building.
  tools                        Install dependent tools.
  build-in-docker              sealer should be compiled in linux platform, otherwise there will be GraphDriver problem.
  gen                          Generate all necessary files.
  verify-copyright             Verify the license headers for all files.
  add-copyright                Add copyright ensure source code files have license headers.
  help                         Show this help info.
  all-help                     Show all help details info.

Options:

  DEBUG            Whether or not to generate debug symbols. Default is 0.

  BINS             Binaries to build. Default is all binaries under cmd.
                   This option is available when using: make {build}(.multiarch)
                   Example: make build BINS="sealer sealctl"

  PLATFORMS        Platform to build for. Default is linux_arm64 and linux_amd64.
                   This option is available when using: make {build}.multiarch
                   Example: make build.multiarch PLATFORMS="linux_arm64 linux_amd64"

  V                Set to 1 enable verbose build. Default is 0.
```

èƒ½è§£å†³æ›´å¤šé—®é¢˜ï¼Œæ›´åŠ ç»†è‡´çš„ `Makefile`

```bash
â¯ make help-all
  go.build.verify                     Verify that a suitable version of Go exists
  go.bin.%                            Verify binary for specific platform
  go.build.%                          Build binary for specific platform
  go.build                            Build binaries
  go.build.multiarch                  Build multi-arch binaries
  go.linux-a                          Build the project with a build script, use
  go.linux-p                        
  go.linux.%                          Build linux_amd64 OR linux_arm64 binaries
  go.lint                             Run golangci to lint source codes
  go.test                             Run unit test
  go.test.junit-report                Run unit test
  go.test.cover                       Run unit test with coverage
  go.format                           Run unit test and format codes
  imports                             task to automatically handle import packages in Go files using goimports tool
  go.updates                          Check for updates to go.mod dependencies
  go.clean                            Clean all builds directories and files
  copyright.help                      Show copyright help
---------------------------------------------------------------------------------
  copyright.verify                    Validate boilerplate headers for assign files
  copyright.add                       Add the boilerplate headers for all files
  copyright.help                      Show copyright help
---------------------------------------------------------------------------------
  tools.install                       Install a must tools
  tools.install-all                   Install all tools
  tools.install.%                     Install a single tool in $GOBIN/
  tools.install-all.%                 Parallelism install a single tool in ./tools/*
  tools.verify.%                      Check if a tool is installed and install it
  install.golangci-lint               Install golangci-lint
  install.goimports                   Install goimports, used to format go source files
  install.addlicense                  Install addlicense, used to add license header to source files
  install.deepcopy-gen                Install deepcopy-gen, used to generate deep copy functions
  install.conversion-gen              Install conversion-gen, used to generate conversion functions
  install.ginkgo                      Install ginkgo to run a single test or set of tests
  install.go-junit-report             Install go-junit-report, used to convert go test output to junit xml
  install.kube-score                  Install kube-score, used to check kubernetes yaml files
  install.kubeconform                 Install kubeconform, used to check kubernetes yaml files
  Install go-gitlint                  Install go-gitlint, used to check git commit message
  install.gsemver                     Install gsemver, used to generate semver
  install.git-chglog                  Install git-chglog, used to generate changelog
  install.github-release              Install github-release, used to create github release
  install.gvm                         Install gvm, gvm is a Go version manager, built on top of the official go tool.
  install.golines                     Install golines, used to format long lines
  install.go-mod-outdated             Install go-mod-outdated, used to check outdated dependencies
  install.mockgen                     Install mockgen, used to generate mock functions
  install.gotests                     Install gotests, used to generate test functions
  install.protoc-gen-go               Install protoc-gen-go, used to generate go source files from protobuf files
  install.cfssl                       Install cfssl, used to generate certificates
  install.depth                       Install depth, used to check dependency tree
  install.go-callvis                  Install go-callvis, used to visualize call graph
  install.gothanks                    Install gothanks, used to thank go dependencies
  install.richgo                      Install richgo
  install.rts                         Install rts
  install.codegen                     Install code generator, used to generate code
  tools.help                          Display help information about the tools package
---------------------------------------------------------------------------------
  image.verify                        Verify docker version
  image.daemon.verify                 Verify docker daemon experimental features
  image.build                         Build docker images
  image.build.multiarch               Build docker images for all platforms
  image.build.%                       Build docker image for a specific platform
  image.push                          Push docker images
  image.push.multiarch                Push docker images for all platforms
  image.push.%                        Push docker image for a specific platform
  image.manifest.push                 Push manifest list for multi-arch images
  image.manifest.push.%               Push manifest list for multi-arch images for a specific platform
  image.manifest.remove.%             Remove local manifest list
  image.manifest.push.multiarch       Push manifest list for multi-arch images for all platforms
  image.manifest.push.multiarch.%     Push manifest list for multi-arch images for all platforms for a specific image
  image.help                          Print help for image targets
---------------------------------------------------------------------------------

Usage: make <TARGETS> <OPTIONS> ...

Targets:

  build                        Build binaries by default
  tidy                         tidy go.mod
  vendor                       vendor go.mod
  fmt                          Run go fmt against code.
  vet                          Run go vet against code.
  lint                         Check syntax and styling of go sources.
  style                        code style -> fmt,vet,lint
  linux                        Build the all with a build script
  linux.%                      Build binaries for Linux (make linux.amd64 OR make linux.arm64)
  format                       Gofmt (reformat) package sources (exclude vendor dir if existed).
  test                         Run unit test.
  cover                        Run unit test and get test coverage.
  updates                      Check for updates to go.mod dependencies
  imports                      task to automatically handle import packages in Go files using goimports tool
  clean                        Remove all files that are created by building.
  tools                        Install dependent tools.
  build-in-docker              sealer should be compiled in linux platform, otherwise there will be GraphDriver problem.
  gen                          Generate all necessary files.
  verify-copyright             Verify the license headers for all files.
  add-copyright                Add copyright ensure source code files have license headers.
  help                         Show this help info.
  all-help                     Show all help details info.

Options:

  DEBUG            Whether or not to generate debug symbols. Default is 0.

  BINS             Binaries to build. Default is all binaries under cmd.
                   This option is available when using: make {build}(.multiarch)
                   Example: make build BINS="sealer sealctl"

  PLATFORMS        Platform to build for. Default is linux_arm64 and linux_amd64.
                   This option is available when using: make {build}.multiarch
                   Example: make build.multiarch PLATFORMS="linux_arm64 linux_amd64"

  V                Set to 1 enable verbose build. Default is 0.

Make example:

# make build BINS=sealer                                         Only a single sealer binary is built.
# make -j  all                                           Run tidy gen add-copyright format lint cover build concurrently.
# make gen                                                       Generate all necessary files.
# make linux.arm64                                               sealer is compiled on arm64 platform.
# make verify-copyright                                          Verify the license headers for all files.
# make install-deepcopy-gen                                      Install deepcopy-gen tools if the license is missing.
# make build BINS=sealer V=1 DEBUG=1                             Build debug binaries for only sealer.
# make build.multiarch PLATFORMS="linux_arm64 linux_amd64" V=1   Build binaries for both platforms.

Ariables:

  DEBUG: 0
  BINS: sealer seautil
  PLATFORMS: linux_amd64 linux_arm64
  V:
```

### å¯è§‚æµ‹çš„ç¼–è¯‘ä¿¡æ¯

```bash
â¯ make build
===========> Verify that a suitable version of Go exists, current version: go version go1.20 linux/amd64
COMMAND=sealer
PLATFORM=linux_amd64
BIN_DIR=/root/workspaces/sealer/_output/bin
===========> Building binary sealer v0.9.3.dirty for linux_amd64
COMMAND=seautil
PLATFORM=linux_amd64
BIN_DIR=/root/workspaces/sealer/_output/bin
===========> Building binary seautil v0.9.3.dirty for linux_amd64
===========> Building binary sealer seautil v0.9.3.dirty for linux_amd64

â¯ sealer version #-o yaml
sealerVersion:
  major: ""
  minor: ""
  gitversion: untagged
  gitcommit: 7c086967e1ee44d33e095780639b0ee006edf6ad
  gittreestate: dirty
  builddate: "2023-05-07T11:43:30Z"
  goversion: go1.20
  compiler: gc
  platform: linux/amd64

â¯ sealer version -o json
{"sealerVersion":{"gitVersion":"untagged","gitCommit":"7c086967e1ee44d33e095780639b0ee006edf6ad","gitTreeState":"dirty","buildDate":"2023-05-07T11:43:30Z","goVersion":"go1.20","compiler":"gc","platform":"linux/amd64"}}
```

å¾ˆæ–¹ä¾¿çš„æ‰“å°å‡ºå½“å‰ç¼–è¯‘çŠ¶æ€ï¼Œç”šè‡³æ˜¯ç¼–è¯‘çš„ç¯å¢ƒï¼Œä»¥åŠé€šè¿‡ `v0.9.3.dirty` åˆ¤æ–­ git æ˜¯å¦å¹²å‡€ã€‚

åœ¨ sealer çš„ cmd ä¸­ï¼Œä¼˜åŒ–äº†å¯è§‚æµ‹æ€§ä»£ç éƒ¨åˆ†ã€‚

### å·¥å…·åŒ…

æœ¬å·¥å…·åŒ…ä½¿ç”¨ Makefile å®ç°äº†ä¸€äº› CICD åŠ¨ä½œï¼ŒåŒ…æ‹¬ä»£ç åˆ†æã€ä»£ç ç”Ÿæˆã€æµ‹è¯•ã€ç‰ˆæœ¬æ§åˆ¶å’Œå®ç”¨å·¥å…·ã€‚è¿™äº›å·¥å…·çš„å®‰è£…æ–¹å¼å¦‚ä¸‹ï¼š

+ å®‰è£… golangci-lint: ç”¨äºä»£ç åˆ†æ
+ å®‰è£… goimports: ç”¨äºæ ¼å¼åŒ– Go æºæ–‡ä»¶
+ å®‰è£… addlicense: ç”¨äºä¸ºæºæ–‡ä»¶æ·»åŠ è®¸å¯è¯å¤´
+ å®‰è£… deepcopy-gen: ç”¨äºç”Ÿæˆæ·±åº¦å¤åˆ¶å‡½æ•°
+ å®‰è£… conversion-gen: ç”¨äºç”Ÿæˆè½¬æ¢å‡½æ•°
+ å®‰è£… ginkgo: ç”¨äºè¿è¡Œå•ä¸ªæµ‹è¯•æˆ–æµ‹è¯•é›†
+ å®‰è£… go-junit-report: ç”¨äºå°† Go æµ‹è¯•è¾“å‡ºè½¬æ¢ä¸º junit xml æ ¼å¼
+ å®‰è£… kube-score: ç”¨äºæ£€æŸ¥ Kubernetes yaml æ–‡ä»¶
+ å®‰è£… kubeconform: ç”¨äºæ£€æŸ¥ Kubernetes yaml æ–‡ä»¶
+ å®‰è£… go-gitlint: ç”¨äºæ£€æŸ¥ git æäº¤ä¿¡æ¯
+ å®‰è£… gsemver: ç”¨äºç”Ÿæˆ semver
+ å®‰è£… git-chglog: ç”¨äºç”Ÿæˆ changelog
+ å®‰è£… github-release: ç”¨äºåˆ›å»º Github Release
+ å®‰è£… golines: ç”¨äºæ ¼å¼åŒ–é•¿è¡Œ
+ å®‰è£… go-mod-outdated: ç”¨äºæ£€æŸ¥è¿‡æ—¶çš„ä¾èµ–å…³ç³»
+ å®‰è£… mockgen: ç”¨äºç”Ÿæˆæ¨¡æ‹Ÿå‡½æ•°
+ å®‰è£… gotests: ç”¨äºç”Ÿæˆæµ‹è¯•å‡½æ•°
+ å®‰è£… protoc-gen-go: ç”¨äºä» protobuf æ–‡ä»¶ç”Ÿæˆ Go æºæ–‡ä»¶
+ å®‰è£… cfssl: ç”¨äºç”Ÿæˆè¯ä¹¦
+ å®‰è£… depth: ç”¨äºæ£€æŸ¥ä¾èµ–æ ‘
+ å®‰è£… go-callvis: ç”¨äºå¯è§†åŒ–è°ƒç”¨å›¾
+ å®‰è£… gothanks: ç”¨äºæ„Ÿè°¢ Go ä¾èµ–é¡¹
+ å®‰è£… richgo: ç”¨äºä¸°å¯Œçš„æµ‹è¯•è¾“å‡º
+ å®‰è£… rts: ç”¨äºæŸ¥æ‰¾ Go ç±»å‹å®šä¹‰
+ å®‰è£… codegen: ç”¨äºä»£ç ç”Ÿæˆ

è¿™äº›å·¥å…·çš„å®‰è£…è·¯å¾„ä¸º $GOBIN æˆ– $TOOLS_DIRã€‚æœ‰äº›å·¥å…·éœ€è¦ä» Github æˆ–ç§æœ‰æºä»£ç ä»“åº“è¿›è¡Œå®‰è£…ï¼Œæœ‰äº›å·¥å…·éœ€è¦è¿›è¡Œç¼–è¯‘ï¼Œéœ€è¦ä¸€äº›ç‰¹å®šçš„å‚æ•°æ¥å®‰è£…ã€‚

è¿™äº›å·¥å…·çš„ä½¿ç”¨éœ€è¦åœ¨ Makefile ä¸­è°ƒç”¨ç‰¹å®šçš„ç›®æ ‡ï¼Œå¦‚ä¸‹ï¼š

+ tools.install: ç”¨äºå®‰è£…å¿…é¡»çš„å·¥å…·
+ tools.install-all: ç”¨äºå®‰è£…æ‰€æœ‰å·¥å…·
+ tools.install.%: ç”¨äºå®‰è£…å•ä¸ªå·¥å…·
+ tools.install-all.%: ç”¨äºå¹¶è¡Œå®‰è£…å•ä¸ªå·¥å…·
+ tools.verify.%: ç”¨äºæ£€æŸ¥å·¥å…·æ˜¯å¦å·²å®‰è£…å¹¶å®‰è£…å®ƒ

### å·¥å…·è¯´æ˜

ä¸‹é¢æ˜¯æ¯ä¸ªå·¥å…·çš„è¯¦ç»†è¯´æ˜ï¼š

+ golangci-lint: ç”¨äºå¯¹ Go ä»£ç è¿›è¡Œå¿«é€Ÿæ£€æŸ¥çš„å·¥å…·ï¼Œå®ƒå¯ä»¥æ£€æŸ¥å¸¸è§çš„é”™è¯¯å’Œæ½œåœ¨çš„é”™è¯¯ï¼Œæ¯”å¦‚ï¼šä»£ç é£æ ¼ã€ä¸å®‰å…¨çš„ä»£ç ã€ç©ºæŒ‡é’ˆå¼•ç”¨ã€æ€§èƒ½é—®é¢˜ç­‰ã€‚
+ goimports: ç”¨äºæ ¼å¼åŒ– Go ä»£ç çš„å·¥å…·ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨æ·»åŠ æˆ–åˆ é™¤æœªä½¿ç”¨çš„å¯¼å…¥ï¼Œå°†å¯¼å…¥åˆ†ç»„ï¼Œå¹¶å°†åŒ…åæŒ‰å­—å…¸åºæ’åºã€‚
+ addlicense: ç”¨äºè‡ªåŠ¨ä¸ºæºæ–‡ä»¶æ·»åŠ è®¸å¯è¯å¤´çš„å·¥å…·ï¼Œå¯ä»¥è®¾ç½®å¤šç§ç±»å‹çš„è®¸å¯è¯ã€‚
+ deepcopy-gen: ç”¨äºä¸º Go ç»“æ„ä½“ç”Ÿæˆæ·±åº¦å¤åˆ¶å‡½æ•°çš„ä»£ç ç”Ÿæˆå™¨ã€‚
+ conversion-gen: ç”¨äºä¸º Go ç»“æ„ä½“ç”Ÿæˆè½¬æ¢å‡½æ•°çš„ä»£ç ç”Ÿæˆå™¨ã€‚
+ ginkgo: ç”¨äºè¿è¡Œå•ä¸ªæµ‹è¯•æˆ–æµ‹è¯•é›†çš„æµ‹è¯•æ¡†æ¶ï¼Œå¯ä»¥ä½¿ç”¨ Gomega æ–­è¨€åº“ã€‚
+ go-junit-report: ç”¨äºå°† Go æµ‹è¯•è¾“å‡ºè½¬æ¢ä¸º junit xml æ ¼å¼çš„å·¥å…·ï¼Œç”¨äºä¸å…¶ä»–æµ‹è¯•å·¥å…·æˆ– CICD æµç¨‹é›†æˆã€‚
+ kube-score: ç”¨äºæ£€æŸ¥ Kubernetes yaml æ–‡ä»¶çš„å·¥å…·ï¼Œå®ƒå¯ä»¥æ£€æŸ¥æ–‡ä»¶ä¸­çš„æœ€ä½³å®è·µå’Œå®‰å…¨é—®é¢˜ã€‚
+ kubeconform: ç”¨äºæ£€æŸ¥ Kubernetes yaml æ–‡ä»¶çš„å·¥å…·ï¼Œå®ƒå¯ä»¥æ£€æŸ¥æ–‡ä»¶ä¸­çš„æœ€ä½³å®è·µå’Œå®‰å…¨é—®é¢˜ã€‚
+ â€¦â€¦

### è®¾è®¡æŠ€å·§

è¿™é‡Œæœ‰ä¸€ä¸ªå·§å¦™çš„è®¾è®¡ï¼Œæˆ‘ä»¬æ–°å¢äº†ä¸€ä¸ª `tools` ç›®å½•ã€‚ä¸æ˜¯æ‰€æœ‰å·¥å…·éƒ½å®‰è£…åœ¨ `GOPATH/bin` ç›®å½•ä¸‹ï¼Œè€Œæ˜¯å°† `tools.install` å®‰è£…é€»è¾‘æ”¾å…¥äº† `GOPATH/bin`ï¼Œå°† `tools.verify.%` é€»è¾‘éƒ½æ”¾åœ¨äº† `tools` çš„ç®¡ç†ä¹‹ä¸‹ã€‚å…¶ä»–çš„ `targer` å¯¹è±¡æ˜¯é€šè¿‡ `tools.verify.%` è°ƒç”¨çš„ã€‚è¿™å¯¹äºåæœŸç»´æŠ¤éå¸¸æ–¹ä¾¿ï¼Œå°¤å…¶æ˜¯åœ¨ä½¿ç”¨å·¥å…·ä¸‹çš„ `gvm` ç®¡ç† Go è¯­è¨€ç‰ˆæœ¬æ—¶ã€‚

### å­˜åœ¨çš„é—®é¢˜

å› ä¸º cgo çš„åŸå› ï¼Œå•å…ƒæµ‹è¯•å’Œæµ‹è¯•è¦†ç›–ç‡ä¾æ—§å¾ˆéš¾ä¿è¯é¡ºåˆ©è¿è¡Œ

ä½¿ç”¨ `go.build.multiarch` ç¼–è¯‘çš„æ—¶å€™ï¼Œå¯ä»¥ä¿è¯ `amd64` é¡ºåˆ©é€šè¿‡ï¼Œä½†æ˜¯ä¸èƒ½ä¿è¯ `arm64` ç¼–è¯‘ã€‚

+ æŠ¥é”™ä¿¡æ¯

  cgo: C compiler "aarch64-linux-gnu-gcc" not found: exec: "aarch64-linux-gnu-gcc": executable file not found in $PATH

éœ€è¦ä¼˜åŒ–ä¸€äº›å…³äºç‰ˆæœ¬çš„ä»£ç 

### æ„å»ºè„šæœ¬ä¼˜åŒ–

ä¸€æ ·çš„ï¼Œé€šè¿‡å¸®åŠ©ä¿¡æ¯ï¼Œå¯ä»¥å¾ˆæ¸…æ™°çš„äº†è§£ï¼š

```bash
â¯ ./scripts/build.sh -h

Usage: ./scripts/build.sh [-h] [-p PLATFORMS] [-a] [-b BINARIES]

Build Sealer binaries for one or more platforms.
    DOTO: I recommend using a Makefile for a more immersive experience

    -h, --help      display this help and exit

    -p, --platform  build binaries for the specified platform(s), e.g. linux/amd64 or linux/arm64.
                    Multiple platforms should be separated by comma, e.g. linux/amd64,linux/arm64.

    -a, --all       build binaries for all supported platforms

    -b, --binary    build the specified binary/binaries, e.g. sealer or seautil.
                    Multiple binaries should be separated by comma, e.g. sealer,seautil.
                    (note: currently only supported in Makefile)

+ exit 0
```

+ æ„å»ºè„šæœ¬ `build.sh` æ”¯æŒå¤šç§é€‰é¡¹ï¼ŒåŒ…æ‹¬æ„å»ºæŒ‡å®š binary/binariesï¼ˆä»…åœ¨ Makefile ä¸­æ”¯æŒï¼‰ã€æ„å»ºæŒ‡å®š platform(s) å’Œæ„å»ºæ‰€æœ‰æ”¯æŒçš„ platform(s)ï¼Œä¸è¿‡ç›®å‰ä¸æ”¯æŒ~

### CICD actions çš„æ”¹è¿›ç­–ç•¥

Makefile çš„æ”¹è¿›ï¼Œå¯èƒ½å¯¼è‡´éƒ¨åˆ† actions æ²¡åŠæ³•é¡ºåˆ©é€šè¿‡ã€‚åé¢æˆ‘å°†ä¼šç»§ç»­ä¼˜åŒ– CICD æµç¨‹ã€‚

â€¦â€¦



## END é“¾æ¥
<ul><li><div><a href = '56.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—  </a><a href = '58.md' style='float: right'>  ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div></li></ul>

+ [â“‚ï¸å›åˆ°ç›®å½•ğŸ ](../README.md)

+ [**ğŸ«µå‚ä¸è´¡çŒ®ğŸ’â¤ï¸â€ğŸ”¥ğŸ’–**](https://nsddd.top/archives/contributors))

+ âœ´ï¸ç‰ˆæƒå£°æ˜ &copy; ï¼šæœ¬ä¹¦æ‰€æœ‰å†…å®¹éµå¾ª[CC-BY-SA 3.0åè®®ï¼ˆç½²å-ç›¸åŒæ–¹å¼å…±äº«ï¼‰&copy;](http://zh.wikipedia.org/wiki/Wikipedia:CC-by-sa-3.0åè®®æ–‡æœ¬) 
