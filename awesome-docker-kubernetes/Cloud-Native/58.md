+ [author](http://nsddd.top)

# ç¬¬58èŠ‚ lychee å®ç° docs æ£€æŸ¥

<div><a href = '57.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—  </a><a href = '59.md' style='float: right'>  â¬‡ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div>
<br>

> â¤ï¸ğŸ’•ğŸ’•è®°å½•[sealos](https://github.com/cubxxw/sealos)å¼€æºé¡¹ç›®çš„å­¦ä¹ è¿‡ç¨‹ã€‚[k8s,dockerå’Œäº‘åŸç”Ÿçš„å­¦ä¹ ](https://github.com/cubxxw/sealos)ã€‚Myblog:[http://nsddd.top](http://nsddd.top/)

---
[TOC]

## ä»‹ç»

ä»€ä¹ˆæ˜¯ lycheeï¼Ÿ

âš¡ ç”¨Rustç¼–å†™çš„å¿«é€Ÿã€å¼‚æ­¥ã€åŸºäºæµçš„é“¾æ¥æ£€æŸ¥å™¨ã€‚

åœ¨Markdownã€HTMLã€reStructuredTextæˆ–ä»»ä½•å…¶ä»–æ–‡æœ¬æ–‡ä»¶æˆ–ç½‘ç«™ä¸­æŸ¥æ‰¾æŸåçš„è¶…é“¾æ¥å’Œé‚®ä»¶åœ°å€ï¼

å¯ä½œä¸ºå‘½ä»¤è¡Œå®ç”¨ç¨‹åºã€åº“å’Œ GitHub Actionä½¿ç”¨ã€‚



## å®‰è£…

åœ¨åŸºäºAPT/dpkgçš„Linuxå‘è¡Œç‰ˆï¼ˆä¾‹å¦‚Debianã€Ubuntuã€Linux Mintå’ŒKali Linuxï¼‰ï¼Œä»¥ä¸‹å‘½ä»¤å°†å®‰è£…æ‰€æœ‰å¿…éœ€çš„æ„å»ºä¾èµ–é¡¹ï¼ŒåŒ…æ‹¬Rustå·¥å…·é“¾å’Œ `cargo` ï¼š

```bash
curl -sSf 'https://sh.rustup.rs' | sh
apt install gcc pkg-config libc6-dev libssl-dev
```



## ä½¿ç”¨

é€’å½’æ£€æŸ¥å½“å‰ç›®å½•ä¸­æ”¯æŒçš„æ–‡ä»¶ä¸­çš„æ‰€æœ‰é“¾æ¥

```bash
lychee .
```

æ‚¨è¿˜å¯ä»¥æŒ‡å®šå„ç§ç±»å‹çš„è¾“å…¥ï¼š

```bash
# check links in specific local file(s):
lychee README.md
lychee test.html info.txt

# check links on a website:
lychee https://endler.dev

# check links in directory but block network requests
lychee --offline path/to/directory

# check links in a remote file:
lychee https://raw.githubusercontent.com/lycheeverse/lychee/master/README.md

# check links in local files via shell glob:
lychee ~/projects/*/README.md

# check links in local files (lychee supports advanced globbing and ~ expansion):
lychee "~/projects/big_project/**/README.*"

# ignore case when globbing and check result for each link:
lychee --glob-ignore-case --verbose "~/projects/**/[r]eadme.*"

# check links from epub file (requires atool: https://www.nongnu.org/atool)
acat -F zip {file.epub} "*.xhtml" "*.html" | lychee -
```

Lycheeå°†å…¶ä»–æ–‡ä»¶æ ¼å¼è§£æä¸ºæ˜æ–‡ï¼Œå¹¶ä½¿ç”¨linkifyæå–é“¾æ¥ã€‚å¦‚æœæ²¡æœ‰æ ¼å¼æˆ–ç¼–ç ç»†èŠ‚ï¼Œè¿™é€šå¸¸å·¥ä½œå¾—å¾ˆå¥½ï¼Œä½†å¦‚æœæ‚¨éœ€è¦å¯¹æ–°æ–‡ä»¶æ ¼å¼çš„ä¸“é—¨æ”¯æŒï¼Œè¯·è€ƒè™‘åˆ›å»ºä¸€ä¸ªé—®é¢˜ã€‚



## Docker Usage

ä¸‹é¢æ˜¯å¦‚ä½•å°†æœ¬åœ°ç›®å½•æŒ‚è½½åˆ°å®¹å™¨ä¸­ï¼Œå¹¶ä½¿ç”¨lycheeæ£€æŸ¥ä¸€äº›è¾“å…¥ã€‚ä¼ é€’ `--init` å‚æ•°ï¼Œä»¥ä¾¿å¯ä»¥ä»ç»ˆç«¯åœæ­¢è”æã€‚æˆ‘ä»¬è¿˜ä¼ é€’ `-it` æ¥å¯åŠ¨ä¸€ä¸ªäº¤äº’å¼ç»ˆç«¯ï¼Œè¿™æ˜¯æ˜¾ç¤ºè¿›åº¦æ¡æ‰€å¿…éœ€çš„ã€‚

```bash
docker run --init -it -v `pwd`:/input lycheeverse/lychee /input/README.md
```



### GitHub Token

ä¸ºäº†é¿å…åœ¨æ£€æŸ¥GitHubé“¾æ¥æ—¶å—åˆ°é€Ÿç‡é™åˆ¶ï¼Œæ‚¨å¯ä»¥é€‰æ‹©ä½¿ç”¨Githubä»¤ç‰Œè®¾ç½®ç¯å¢ƒå˜é‡ï¼Œå¦‚ `GITHUB_TOKEN=xxxx` ï¼Œæˆ–ä½¿ç”¨ `--github-token` CLIé€‰é¡¹ã€‚å®ƒä¹Ÿå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹é…ç½®æ–‡ä»¶ã€‚

ä»¤ç‰Œå¯ä»¥åœ¨æ‚¨çš„GitHubå¸æˆ·è®¾ç½®é¡µé¢ä¸­ç”Ÿæˆã€‚æ²¡æœ‰é¢å¤–æƒé™çš„ä¸ªäººä»¤ç‰Œè¶³ä»¥æ£€æŸ¥å…¬å…±å­˜å‚¨åº“é“¾æ¥ã€‚



### Commandline Parameterå‚æ•°

æœ‰å¤§é‡å‘½ä»¤è¡Œå‚æ•°å¯ç”¨äºè‡ªå®šä¹‰è¡Œä¸ºã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„åˆ—è¡¨ã€‚

```bash
A fast, async link checker

Finds broken URLs and mail addresses inside Markdown, HTML, `reStructuredText`, websites and more!

Usage: lychee [OPTIONS] <inputs>...

Arguments:
  <inputs>...
          The inputs (where to get links to check from). These can be: files (e.g. `README.md`), file globs (e.g. `"~/git/*/README.md"`), remote URLs (e.g. `https://example.com/README.md`) or standard input (`-`). NOTE: Use `--` to separate inputs from options that allow multiple arguments

Options:
  -c, --config <CONFIG_FILE>
          Configuration file to use
          
          [default: lychee.toml]

  -v, --verbose...
          Set verbosity level; more output per occurrence (e.g. `-v` or `-vv`)

  -q, --quiet...
          Less output per occurrence (e.g. `-q` or `-qq`)

  -n, --no-progress
          Do not show progress bar.
          This is recommended for non-interactive shells (e.g. for continuous integration)

      --cache
          Use request cache stored on disk at `.lycheecache`

      --max-cache-age <MAX_CACHE_AGE>
          Discard all cached requests older than this duration
          
          [default: 1d]

      --dump
          Don't perform any link checking. Instead, dump all the links extracted from inputs that would be checked

      --archive <ARCHIVE>
          Specify the use of a specific web archive. Can be used in combination with `--suggest`
          
          [possible values: wayback]

      --suggest
          Suggest link replacements for broken links, using a web archive. The web archive can be specified with `--archive`

  -m, --max-redirects <MAX_REDIRECTS>
          Maximum number of allowed redirects
          
          [default: 5]

      --max-retries <MAX_RETRIES>
          Maximum number of retries per request
          
          [default: 3]

      --max-concurrency <MAX_CONCURRENCY>
          Maximum number of concurrent network requests
          
          [default: 128]

  -T, --threads <THREADS>
          Number of threads to utilize. Defaults to number of cores available to the system

  -u, --user-agent <USER_AGENT>
          User agent
          
          [default: lychee/0.12.0]

  -i, --insecure
          Proceed for server connections considered insecure (invalid TLS)

  -s, --scheme <SCHEME>
          Only test links with the given schemes (e.g. http and https)

      --offline
          Only check local files and block network requests

      --include <INCLUDE>
          URLs to check (supports regex). Has preference over all excludes

      --exclude <EXCLUDE>
          Exclude URLs and mail addresses from checking (supports regex)

      --exclude-file <EXCLUDE_FILE>
          Deprecated; use `--exclude-path` instead

      --exclude-path <EXCLUDE_PATH>
          Exclude file path from getting checked

  -E, --exclude-all-private
          Exclude all private IPs from checking.
          Equivalent to `--exclude-private --exclude-link-local --exclude-loopback`

      --exclude-private
          Exclude private IP address ranges from checking

      --exclude-link-local
          Exclude link-local IP address range from checking

      --exclude-loopback
          Exclude loopback IP address range and localhost from checking

      --exclude-mail
          Exclude all mail addresses from checking

      --remap <REMAP>
          Remap URI matching pattern to different URI

      --header <HEADER>
          Custom request header

  -a, --accept <ACCEPT>
          Comma-separated list of accepted status codes for valid links

  -t, --timeout <TIMEOUT>
          Website timeout in seconds from connect to response finished
          
          [default: 20]

  -r, --retry-wait-time <RETRY_WAIT_TIME>
          Minimum wait time in seconds between retries of failed requests
          
          [default: 1]

  -X, --method <METHOD>
          Request method
          
          [default: get]

  -b, --base <BASE>
          Base URL or website root directory to check relative URLs e.g. https://example.com or `/path/to/public`

      --basic-auth <BASIC_AUTH>
          Basic authentication support. E.g. `username:password`

      --github-token <GITHUB_TOKEN>
          GitHub API token to use when checking github.com links, to avoid rate limiting
          
          [env: GITHUB_TOKEN]

      --skip-missing
          Skip missing input files (default is to error if they don't exist)

      --include-verbatim
          Find links in verbatim sections like `pre`- and `code` blocks

      --glob-ignore-case
          Ignore case when expanding filesystem path glob inputs

  -o, --output <OUTPUT>
          Output file of status report

  -f, --format <FORMAT>
          Output format of final status report (compact, detailed, json, markdown)
          
          [default: compact]

      --require-https
          When HTTPS is available, treat HTTP links as errors

  -h, --help
          Print help (see a summary with '-h')

  -V, --version
          Print version

```



### é”™è¯¯ç  ï¼ˆExit codesï¼‰

+ `0` è¡¨ç¤ºæˆåŠŸï¼ˆå·²æˆåŠŸæ£€æŸ¥æ‰€æœ‰é“¾æ¥æˆ–å·²æŒ‰ç…§é…ç½®æ’é™¤/è·³è¿‡æ‰€æœ‰é“¾æ¥ï¼‰
+ `1` ç”¨äºä¸¢å¤±çš„è¾“å…¥å’Œä»»ä½•æ„å¤–çš„è¿è¡Œæ—¶å¤±è´¥æˆ–é…ç½®é”™è¯¯
+ `2` è¡¨ç¤ºé“¾è·¯æ£€æŸ¥å¤±è´¥ï¼ˆå¦‚æœä»»ä½•æœªæ’é™¤çš„é“¾è·¯æœªé€šè¿‡æ£€æŸ¥ï¼‰



### Ignoring links

æ‚¨å¯ä»¥é€šè¿‡ä½¿ç”¨ `--exclude` æŒ‡å®šæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ï¼ˆä¾‹å¦‚ï¼Œ `--exclude example\.(com|org)` ï¼‰ã€‚å¦‚æœå½“å‰å·¥ä½œç›®å½•ä¸­å­˜åœ¨åä¸º `.lycheeignore` çš„æ–‡ä»¶ï¼Œåˆ™å…¶å†…å®¹ä¹Ÿå°†è¢«æ’é™¤ã€‚è¯¥æ–‡ä»¶å…è®¸æ‚¨åˆ—å‡ºå¤šä¸ªè¦æ’é™¤çš„æ­£åˆ™è¡¨è¾¾å¼ï¼ˆæ¯è¡Œä¸€ä¸ªæ¨¡å¼ï¼‰ã€‚

è¦ä»æ‰«æä¸­æ’é™¤æ–‡ä»¶/ç›®å½•ï¼Œè¯·ä½¿ç”¨ `lychee.toml` å’Œ `exclude_path` ã€‚

```bash
exclude_path = ["some/path", "*/dev/*"]
```



### Caching

å¦‚æœè®¾ç½®äº† `--cache` æ ‡å¿—ï¼Œè”æå°†åœ¨å½“å‰ç›®å½•ä¸­åä¸º `.lycheecache` çš„æ–‡ä»¶ä¸­ç¼“å­˜å“åº”ã€‚å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶ä¸”è®¾ç½®äº†æ ‡å¿—ï¼Œåˆ™åœ¨å¯åŠ¨æ—¶å°†åŠ è½½è¯¥é«˜é€Ÿç¼“å­˜ã€‚è¿™å¯ä»¥å¤§å¤§åŠ å¿«æœªæ¥çš„è¿è¡Œé€Ÿåº¦ã€‚è¯·æ³¨æ„ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè”æä¸ä¼šåœ¨ç£ç›˜ä¸Šå­˜å‚¨ä»»ä½•æ•°æ®ã€‚





## ç”¨ä½œè‡ªå·±çš„åº“

ä½¿ç”¨ rust è°ƒç”¨~



## actions

+ [actions çš„é“¾æ¥åœ°å€](https://github.com/lycheeverse/lychee-action)

ä½¿ç”¨è”æå¿«é€Ÿæ£€æŸ¥Markdownã€HTMLå’Œæ–‡æœ¬æ–‡ä»¶ä¸­çš„é“¾æ¥ã€‚



**å¯ä»¥èåˆ issue çš„ä½¿ç”¨ï¼Œæ¯”å¦‚è¯´ï¼š**

ä¸â€œä»æ–‡ä»¶åˆ›å»ºé—®é¢˜â€ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œå½“æ“ä½œå‘ç°é“¾æ¥é—®é¢˜æ—¶ï¼Œå°†æ‰“å¼€ issue

> **Note** å½“ç„¶ï¼Œè¿™éœ€è¦ä½ çš„æƒé™



### Usage

ä»¥ä¸‹æ˜¯GitHubå·¥ä½œæµæ–‡ä»¶çš„å®Œæ•´ç¤ºä¾‹ï¼š

å®ƒå°†æ¯å¤©æ£€æŸ¥ä¸€æ¬¡æ‰€æœ‰å­˜å‚¨åº“é“¾æ¥ï¼Œå¹¶åœ¨å‡ºç°é”™è¯¯æ—¶åˆ›å»ºä¸€ä¸ªé—®é¢˜ã€‚å°†æ­¤ä¿å­˜åœ¨ `.github/workflows/links.yml` ä¸‹ï¼š

```yaml
name: Links

on:
  repository_dispatch:
  workflow_dispatch:
  schedule:
    - cron: "00 18 * * *"

jobs:
  linkChecker:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Link Checker
        id: lychee
        uses: lycheeverse/lychee-action@v1.7.0
        env:
          GITHUB_TOKEN: ${{secrets.GITHUB_TOKEN}}

      - name: Create Issue From File
        if: env.lychee_exit_code != 0
        uses: peter-evans/create-issue-from-file@v4
        with:
          title: Link Checker Report
          content-filepath: ./lychee/out.md
          labels: report, automated issue
```

(Youä¸éœ€è¦è‡ªå·±é…ç½® `GITHUB_TOKEN` ;ç”±Githubè‡ªåŠ¨è®¾ç½®ï¼‰ã€‚

å¦‚æœæ‚¨æ€»æ˜¯å¸Œæœ›ä½¿ç”¨æœ€æ–°çš„åŠŸèƒ½ï¼Œä½†åˆé¿å…ç ´åæ€§çš„æ›´æ”¹ï¼Œåˆ™å¯ä»¥å°†ç‰ˆæœ¬æ›¿æ¢ä¸º `lycheeverse/lychee-action@v1`

::: warning
å¯ä»¥å¯¹ç…§è¿™ä¸ªåŠ ä¸€äº›å‚æ•°ï¼Œæ¯”å¦‚ -E å±è”½æ‰€æœ‰ localhost å’Œå†…ç½‘ipçš„æ£€æŸ¥ï¼Œä»¥åŠå¿½ç•¥401å’Œ403çš„é”™è¯¯ï¼Œ429é‚£ä¸ªæ˜¯GitHubçš„é™é€ŸæŠ¥é”™ï¼ˆå¯åŠ å¯ä¸åŠ ï¼‰

![image-20230513195026852](http://sm.nsddd.top/sm202305131950121.png)

:::



### Alternative approach (æ›¿ä»£æ–¹æ³•)

è¿™å°†åœ¨ä»»ä½•git pushäº‹ä»¶å’Œæ‰€æœ‰pullè¯·æ±‚æœŸé—´æ£€æŸ¥æ‰€æœ‰å­˜å‚¨åº“é“¾æ¥ã€‚å¦‚æœå‡ºç°é”™è¯¯ï¼Œæ“ä½œå°†å¤±è´¥ã€‚

è¿™æ ·åšçš„å¥½å¤„æ˜¯ç¡®ä¿åœ¨åˆå¹¶è¯·æ±‚æœŸé—´ï¼Œä¸ä¼šæ·»åŠ ä»»ä½•æ–­å¼€çš„é“¾æ¥ï¼Œå¹¶ä¸”å¦‚æœä»»ä½•ç°æœ‰é“¾æ¥æ–­å¼€ï¼Œå®ƒä»¬å°†è¢«æ•è·ã€‚å°†å…¶ä¿å­˜åœ¨ `.github/workflows/links-fail-fast.yml` ä¸‹ï¼š

```yaml
name: Links (Fail Fast)

on:
  push:
  pull_request:

jobs:
  linkChecker:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Link Checker
        uses: lycheeverse/lychee-action@v1.7.0
        with:
          fail: true
        env:
          GITHUB_TOKEN: ${{secrets.GITHUB_TOKEN}}
```



## æ ‡å¿—

[![Check Links](https://github.com/OpenIMSDK/Open-IM-Server/actions/workflows/links.yml/badge.svg)](https://github.com/OpenIMSDK/Open-IM-Server/actions/workflows/links.yml)





## END é“¾æ¥

<ul><li><div><a href = '57.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—  </a><a href = '59.md' style='float: right'>  ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div></li></ul>

+ [â“‚ï¸å›åˆ°ç›®å½•ğŸ ](../README.md)

+ [**ğŸ«µå‚ä¸è´¡çŒ®ğŸ’â¤ï¸â€ğŸ”¥ğŸ’–**](https://nsddd.top/archives/contributors))

+ âœ´ï¸ç‰ˆæƒå£°æ˜ &copy; ï¼šæœ¬ä¹¦æ‰€æœ‰å†…å®¹éµå¾ª[CC-BY-SA 3.0åè®®ï¼ˆç½²å-ç›¸åŒæ–¹å¼å…±äº«ï¼‰&copy;](http://zh.wikipedia.org/wiki/Wikipedia:CC-by-sa-3.0åè®®æ–‡æœ¬) 
