+ [author](http://nsddd.top)

# ç¬¬86èŠ‚ Gorelease

<div><a href = '85.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—  </a><a href = '87.md' style='float: right'>  â¬‡ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div>

<br>

> â¤ï¸ğŸ’•ğŸ’•è®°å½•[sealos](https://github.com/cubxxw/sealos)å¼€æºé¡¹ç›®çš„å­¦ä¹ è¿‡ç¨‹ã€‚[k8s,dockerå’Œäº‘åŸç”Ÿçš„å­¦ä¹ ](https://github.com/cubxxw/sealos)ã€‚Myblog:[http://nsddd.top](http://nsddd.top/)

---

[TOC]

# GoReleaserï¼šè‡ªåŠ¨åŒ–ä½ çš„è½¯ä»¶å‘å¸ƒ

GoReleaser çš„ç›®æ ‡æ˜¯è‡ªåŠ¨åŒ–å‘å¸ƒè½¯ä»¶æ—¶çš„å¤§éƒ¨åˆ†ç¹çå·¥ä½œï¼Œé€šè¿‡ä½¿ç”¨åˆç†çš„é»˜è®¤å€¼å¹¶ä½¿æœ€å¸¸è§çš„ç”¨ä¾‹å˜å¾—ç®€å•ã€‚

## å‡†å¤‡å·¥ä½œï¼š

- `.goreleaser.yaml` æ–‡ä»¶ï¼šåŒ…å«æ‰€æœ‰é…ç½®ä¿¡æ¯ã€‚ï¼ˆæœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜… [è‡ªå®šä¹‰](https://goreleaser.com/customization/)ï¼‰
- å¹²å‡€çš„å·¥ä½œæ ‘ï¼šç¡®ä¿ä»£ç æ˜¯æœ€æ–°çš„ï¼Œå¹¶ä¸”å·²ç»æäº¤äº†æ‰€æœ‰æ”¹åŠ¨ã€‚
- ç¬¦åˆ SemVer çš„ç‰ˆæœ¬å·ï¼ˆä¾‹å¦‚ `10.21.34-prerelease+buildmeta`ï¼‰

## GoReleaser çš„è¿è¡Œæ­¥éª¤ï¼š

GoReleaser çš„è¿è¡Œä¸»è¦åˆ†ä¸ºä»¥ä¸‹å››ä¸ªæ­¥éª¤ï¼š

1. **defaulting**ï¼šä¸ºæ¯ä¸ªæ­¥éª¤é…ç½®åˆç†çš„é»˜è®¤å€¼
2. **building**ï¼šæ„å»ºäºŒè¿›åˆ¶æ–‡ä»¶ã€æ¡£æ¡ˆã€åŒ…ã€Docker é•œåƒç­‰
3. **releasing**ï¼šå°†ç‰ˆæœ¬å‘å¸ƒåˆ°é…ç½®çš„ SCMã€Docker æ³¨å†Œè¡¨ã€blob å­˜å‚¨ç­‰
4. **announcing**ï¼šå‘é…ç½®çš„é¢‘é“å®£å¸ƒæ‚¨çš„å‘å¸ƒ

ä½¿ç”¨ `-like` æ ‡å¿—å¯èƒ½ä¼šè·³è¿‡æŸäº›æ­¥éª¤ï¼Œå¦‚ `--skip-foo`

## å¿«é€Ÿå¼€å§‹

é¦–å…ˆï¼Œè¿è¡Œ [init](https://goreleaser.com/cmd/goreleaser_init/) å‘½ä»¤æ¥åˆ›å»ºç¤ºä¾‹çš„ `.goreleaser.yaml` æ–‡ä»¶ï¼š

```
goreleaser init
```

ç„¶åï¼Œæˆ‘ä»¬è¿è¡Œä¸€ä¸ªâ€œä»…é™æœ¬åœ°â€ç‰ˆæœ¬ï¼Œçœ‹çœ‹å®ƒæ˜¯å¦å¯ä»¥ä½¿ç”¨ [release](https://goreleaser.com/cmd/goreleaser_release/) å‘½ä»¤è¿è¡Œï¼š

```
goreleaser release --snapshot --rm-dist
```

æ­¤æ—¶ï¼Œæ‚¨å¯ä»¥ [è‡ªå®šä¹‰](https://goreleaser.com/customization/) ç”Ÿæˆçš„ `.goreleaser.yaml` æ–‡ä»¶ï¼Œæˆ–ä¿æŒåŸæ ·ï¼Œè¿™å–å†³äºæ‚¨ã€‚æœ€ä½³åšæ³•æ˜¯å°† `.goreleaser.yaml` æ–‡ä»¶æ”¾å…¥ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¸­ã€‚

æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ GoReleaser ä¸ºç»™å®šçš„ GOOS/GOARCH [æ„å»ºäºŒè¿›åˆ¶æ–‡ä»¶](https://goreleaser.com/cmd/goreleaser_build/)ï¼Œè¿™å¯¹äºæœ¬åœ°å¼€å‘éå¸¸æœ‰ç”¨ï¼š

```
goreleaser build --single-target
```

å‡†å¤‡ GitHub çš„ Tokenï¼š

```
export GITHUB_TOKEN="YOUR_GH_TOKEN"
```

GoReleaser å°†ä½¿ç”¨æ‚¨å­˜å‚¨åº“çš„æœ€æ–° [Git æ ‡ç­¾](https://git-scm.com/book/en/v2/Git-Basics-Tagging)ã€‚

åˆ›å»ºä¸€ä¸ªæ ‡ç­¾å¹¶å°†å…¶æ¨é€åˆ° GitHubï¼š

```
git push origin v0.1.0
```

ç°åœ¨ï¼Œæ‚¨å¯ä»¥åœ¨é¡¹ç›®çš„æ ¹ç›®å½•è¿è¡Œ GoReleaserï¼š

```
goreleaser release
```

## åœ¨ GitHub Actions ä¸­ä½¿ç”¨ GoReleaser

GoReleaser è¿˜å¯ä»¥é€šè¿‡ [GitHub Actions](https://github.com/features/actions) åœ¨æˆ‘ä»¬çš„å®˜æ–¹ [GoReleaser Action](https://github.com/goreleaser/goreleaser-action) ä¸­ä½¿ç”¨ã€‚

æ‚¨å¯ä»¥é€šè¿‡å°† YAML é…ç½®æ”¾å…¥ `.github/workflows/release.yml` æ–‡ä»¶ä¸­ã€‚

```bash
bashcodename: goreleaser

on:
  push:
    # åªå¯¹æ ‡ç­¾è¿›è¡Œè¿è¡Œ
    tags:
      - '*'

permissions:
  contents: write
  # packages: write
  # issues: write

jobs:
  goreleaser:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
      - run: git fetch --force --tags
      - uses: actions/setup-go@v4
        with:
          go-version: stable
      # æ›´å¤šè®¾ç½®å¯èƒ½éœ€è¦ï¼Œå¦‚ Docker ç™»å½•ã€GPG ç­‰ã€‚è¿™äº›éƒ½å–å†³äºæ‚¨çš„éœ€æ±‚ã€‚
      - uses: goreleaser/goreleaser-action@v4
        with:
          # å¯ä»¥é€‰æ‹© 'goreleaser'ï¼ˆé»˜è®¤ï¼‰æˆ– 'goreleaser-pro'
          distribution: goreleaser
          version: latest
          args: release --rm-dist
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          # å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ 'goreleaser-pro' å‘è¡Œç‰ˆï¼Œä½ éœ€è¦ GoReleaser Pro çš„å¯†é’¥ï¼š
          # GORELEASER_KEY: ${{ secrets.GORELEASER_KEY }}
```

GoReleaser éœ€è¦ä»¥ä¸‹ [æƒé™](https://docs.github.com/en/actions/reference/authentication-in-a-workflow#permissions-for-the-github_token)ï¼š

- ```
  contents: write
  ```

  ï¼Œå¦‚æœä½ æ‰“ç®—ï¼š

  - [å°†æ¡£æ¡ˆä¸Šä¼ ä¸º GitHub Releases](https://goreleaser.com/customization/release/)ï¼Œæˆ–
  - å‘å¸ƒåˆ° [Homebrew](https://goreleaser.com/customization/homebrew/) æˆ– [Scoop](https://goreleaser.com/customization/scoop/)ï¼ˆå‡è®¾å®ƒæ˜¯åŒä¸€å­˜å‚¨åº“çš„ä¸€éƒ¨åˆ†ï¼‰

- `packages: write`ï¼Œå¦‚æœä½ æ‰“ç®— [å°† Docker é•œåƒæ¨é€åˆ°](https://goreleaser.com/customization/docker/) GitHub

- `issues: write`ï¼Œå¦‚æœä½ ä½¿ç”¨äº† [é‡Œç¨‹ç¢‘å…³é—­åŠŸèƒ½](https://goreleaser.com/customization/milestone/)

`GITHUB_TOKEN` æƒé™ [åªé™äº](https://help.github.com/en/actions/configuring-and-managing-workflows/authenticating-with-the-github_token#about-the-github_token-secret) åŒ…å«ä½ çš„å·¥ä½œæµçš„å­˜å‚¨åº“ã€‚

å¦‚æœä½ éœ€è¦å°† Homebrew Tap æ¨é€åˆ°å¦ä¸€ä¸ªå­˜å‚¨åº“ï¼Œé‚£ä¹ˆä½ å¿…é¡»åˆ›å»ºä¸€ä¸ªæœ‰æƒè®¿é—®çš„ä¸ªäººè®¿é—®ä»¤ç‰Œï¼Œå¹¶å°†å…¶æ·»åŠ ä¸ºå­˜å‚¨åº“çš„ç§˜å¯†ã€‚å¦‚æœä½ åˆ›å»ºäº†ä¸€ä¸ªåä¸º `GH_PAT` çš„ç§˜å¯†ï¼Œé‚£ä¹ˆæ­¥éª¤å°†å¦‚ä¸‹ï¼š

```
yaml
```

```yaml
      - name: Run GoReleaser
        uses: goreleaser/goreleaser-action@v4
        with:
          version: latest
          args: release --rm-dist
        env:
          GITHUB_TOKEN: ${{ secrets.GH_PAT }}
```



## å®šåˆ¶åŒ–éœ€æ±‚

GoReleaser å¯ä»¥é€šè¿‡è°ƒæ•´`.goreleaser.yaml`æ–‡ä»¶æ¥å®šåˆ¶ã€‚

[goreleaser init](https://goreleaser.com/cmd/goreleaser_init/)æ‚¨å¯ä»¥é€šè¿‡è¿è¡Œæˆ–ä»å¤´å¼€å§‹ç”Ÿæˆç¤ºä¾‹é…ç½®ã€‚

æ‚¨è¿˜å¯ä»¥é€šè¿‡è¿è¡Œæ¥æ£€æŸ¥æ‚¨çš„é…ç½®æ˜¯å¦æœ‰æ•ˆ[goreleaser check](https://goreleaser.com/cmd/goreleaser_check/)ï¼Œè¿™ä¼šå‘Šè¯‰æ‚¨æ˜¯å¦ä½¿ç”¨äº†å·²å¼ƒç”¨æˆ–æ— æ•ˆçš„é€‰é¡¹ã€‚

### åç§°æ¨¡æ¿

| é’¥åŒ™                   | æè¿°                                                         |
| ---------------------- | ------------------------------------------------------------ |
| `.ProjectName`         | é¡¹ç›®åç§°                                                     |
| `.Version`             | æ­£åœ¨å‘å¸ƒçš„ç‰ˆæœ¬ ([è¯¦æƒ…](https://goreleaser.com/customization/templates/#fn:version-prefix)) |
| `.Branch`              | å½“å‰çš„ git åˆ†æ”¯                                              |
| `.PrefixedTag`         | ä»¥ monorepo é…ç½®æ ‡ç­¾å‰ç¼€ä¸ºå‰ç¼€çš„å½“å‰ git æ ‡ç­¾ï¼ˆå¦‚æœæœ‰ï¼‰      |
| `.Tag`                 | å½“å‰çš„ git æ ‡ç­¾                                              |
| `.PrefixedPreviousTag` | ä¹‹å‰çš„ git æ ‡ç­¾å¸¦æœ‰ monorepo é…ç½®æ ‡ç­¾å‰ç¼€ï¼ˆå¦‚æœæœ‰ï¼‰          |
| `.PreviousTag`         | ä¹‹å‰çš„ git æ ‡ç­¾ï¼Œå¦‚æœæ²¡æœ‰ä¹‹å‰çš„æ ‡ç­¾åˆ™ä¸ºç©º                    |
| `.ShortCommit`         | git æäº¤çŸ­å“ˆå¸Œ                                               |
| `.FullCommit`          | git æäº¤å®Œæ•´å“ˆå¸Œå€¼                                           |
| `.Commit`              | git æäº¤å“ˆå¸Œï¼ˆå·²å¼ƒç”¨ï¼‰                                       |
| `.CommitDate`          | RFC 3339 æ ¼å¼çš„ UTC æäº¤æ—¥æœŸ                                 |
| `.CommitTimestamp`     | Unix æ ¼å¼çš„ UTC æäº¤æ—¥æœŸ                                     |
| `.GitURL`              | git è¿œç¨‹ URL                                                 |
| `.IsGitDirty`          | å½“å‰ git çŠ¶æ€æ˜¯å¦è„ã€‚è‡ª v1.19 èµ·ã€‚                           |
| `.Major`               | ç‰ˆæœ¬ ([è¯¦æƒ…](https://goreleaser.com/customization/templates/#fn:tag-is-semver)) |
| `.Minor`               | ç‰ˆæœ¬ ([è¯¦æƒ…](https://goreleaser.com/customization/templates/#fn:tag-is-semver)) |
| `.Patch`               | è¡¥ä¸éƒ¨åˆ† ([è¯¦æƒ…](https://goreleaser.com/customization/templates/#fn:tag-is-semver)) |
| `.Prerelease`          | ç‰ˆæœ¬çš„é¢„å‘è¡Œéƒ¨åˆ†ï¼Œä¾‹å¦‚beta ([è¯¦æƒ…](https://goreleaser.com/customization/templates/#fn:tag-is-semver)) |
| `.RawVersion`          | ç»„æˆ `{Major}.{Minor}.{Patch}` ([è¯¦æƒ…](https://goreleaser.com/customization/templates/#fn:tag-is-semver)) |
| `.ReleaseNotes`        | ç”Ÿæˆçš„å‘è¡Œè¯´æ˜ï¼Œåœ¨æ‰§è¡Œå˜æ›´æ—¥å¿—æ­¥éª¤åå¯ç”¨                     |
| `.IsDraft`             | true if `release.draft` åœ¨é…ç½®ä¸­è®¾ç½®ï¼Œfalseå¦åˆ™ã€‚è‡ª v1.17 èµ·ã€‚ |
| `.IsSnapshot`          | true å¦‚æœ `--snapshot` å·²è®¾ç½®ï¼Œfalseå¦åˆ™                     |
| `.IsNightly`           | true å¦‚æœ `--nightly` å·²è®¾ç½®ï¼Œfalseå¦åˆ™                      |
| `.Env`                 | åŒ…å«ç³»ç»Ÿç¯å¢ƒå˜é‡çš„æ˜ å°„                                       |
| `.Date`                | RFC 3339 æ ¼å¼çš„å½“å‰ UTC æ—¥æœŸ                                 |
| `.Now`                 | å½“å‰ UTC æ—¥æœŸä½œä¸º `time.Time` ç»“æ„ï¼Œå…è®¸æ‰€æœ‰ `time.Time` åŠŸèƒ½ï¼ˆä¾‹å¦‚ `{{ .Now.Format "2006" }}` ï¼‰ã€‚è‡ª v1.17 èµ·ã€‚ |
| `.Timestamp`           | Unix æ ¼å¼çš„å½“å‰ UTC æ—¶é—´                                     |
| `.ModulePath`          | go æ¨¡å—è·¯å¾„ï¼Œå¦‚æŠ¥å‘Šæ‰€ç¤º `go list -m`                         |
| `incpatch "v1.2.4"`    | è¡¥ä¸ ([è¯¦æƒ…](https://goreleaser.com/customization/templates/#fn:panic-if-not-semver)) |
| `incminor "v1.2.4"`    | æ¬¡è¦ç‰ˆæœ¬ ([è¯¦æƒ…](https://goreleaser.com/customization/templates/#fn:panic-if-not-semver)) |
| `incmajor "v1.2.4"`    | å¢åŠ ç»™å®šç‰ˆæœ¬ ([è¯¦æƒ…](https://goreleaser.com/customization/templates/#fn:panic-if-not-semver)) |
| `.ReleaseURL`          | å½“å‰ç‰ˆæœ¬ä¸‹è½½åœ°å€ ([è¯¦æƒ…](https://goreleaser.com/customization/templates/#fn:scm-release-url)) |
| `.Summary`             | git æ‘˜è¦ï¼Œä¾‹å¦‚ `v1.0.0-10-g34f56g3` ([è¯¦æƒ…](https://goreleaser.com/customization/templates/#fn:git-summary)) |
| `.PrefixedSummary`     | ä»¥ monorepo é…ç½®æ ‡ç­¾å‰ç¼€ä¸ºå‰ç¼€çš„ git æ‘˜è¦ï¼ˆå¦‚æœæœ‰ï¼‰          |
| `.TagSubject`          | å¸¦æ³¨é‡Šçš„æ ‡ç­¾æ¶ˆæ¯ä¸»é¢˜ï¼Œæˆ–è€…å®ƒæŒ‡å‡ºçš„æäº¤çš„æ¶ˆæ¯ä¸»é¢˜ ([è¯¦æƒ…](https://goreleaser.com/customization/templates/#fn:git-tag-subject))ã€‚ä» v1.2 å¼€å§‹ã€‚ |
| `.TagContents`         | å¸¦æ³¨é‡Šçš„æ ‡ç­¾æ¶ˆæ¯ï¼Œæˆ–è€…å®ƒæŒ‡å‡ºçš„æäº¤æ¶ˆæ¯ ([è¯¦æƒ…](https://goreleaser.com/customization/templates/#fn:git-tag-body)) . ä» v1.2 å¼€å§‹ã€‚ |
| `.TagBody`             | å¸¦æ³¨é‡Šçš„æ ‡ç­¾æ¶ˆæ¯æ­£æ–‡ï¼Œæˆ–å…¶æŒ‡å‡ºçš„æäº¤çš„æ¶ˆæ¯æ­£æ–‡ ([è¯¦æƒ…](https://goreleaser.com/customization/templates/#fn:git-tag-body))ã€‚ä» v1.2 å¼€å§‹ã€‚ |
| `.Runtime.Goos`        | ç›¸å½“äº `runtime.GOOS`. ä» v1.5 å¼€å§‹ã€‚                        |
| `.Runtime.Goarch`      | ç›¸å½“äº `runtime.GOARCH`. ä» v1.5 å¼€å§‹ã€‚                      |
| `.Artifacts`           | å½“å‰å·¥ä»¶åˆ—è¡¨ã€‚å­—æ®µè§ä¸‹è¡¨ã€‚è‡ª v1.16-pro èµ·ã€‚                  |



### é…ç½®é€‰é¡¹

```yaml
# Default: './dist'
dist: _output/dist

git:
  # What should be used to sort tags when gathering the current and previous
  # tags if there are more than one tag in the same commit.
  #
  # Default: '-version:refname'
  tag_sort: -version:creatordate

  # What should be used to specify prerelease suffix while sorting tags when gathering
  # the current and previous tags if there are more than one tag in the same commit.
  #
  # Since: v1.17
  prerelease_suffix: "-"
```



### æ„å»ºé€‰é¡¹

å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å®šåˆ¶æ„å»ºã€‚æ‚¨å¯ä»¥æŒ‡å®šæ„å»ºå“ªäº›`GOOS`,`GOARCH`å’Œ`GOARM`äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆGoReleaser å°†ç”Ÿæˆæ‰€æœ‰ç»„åˆçš„çŸ©é˜µï¼‰ï¼Œå¹¶ä¸”æ‚¨å¯ä»¥æ›´æ”¹äºŒè¿›åˆ¶æ–‡ä»¶çš„åç§°ã€æ ‡å¿—ã€ç¯å¢ƒå˜é‡ã€æŒ‚é’©ç­‰ã€‚

**builds æ˜¯é…ç½®æ–‡ä»¶ä¸­æœ€é‡è¦çš„ä¸€ä¸ªé€‰é¡¹ï¼š**

```yaml
# .goreleaser.yaml
builds:
  # You can have multiple builds defined as a yaml list
  - #
    # ID of the build.
    #
    # Default: Binary name
    id: "my-build"

    # Path to main.go file or main package.
    # Notice: when used with `gomod.proxy`, this must be a package.
    #
    # Default is `.`.
    main: ./cmd/my-app

    # Binary name.
    # Can be a path (e.g. `bin/app`) to wrap the binary in a directory.
    #
    # Default: Project directory name
    binary: program

    # Custom flags.
    #
    # Templates: allowed
    flags:
      - -tags=dev
      - -v

    # Custom asmflags.
    #
    # Templates: allowed
    asmflags:
      - -D mysymbol
      - all=-trimpath={{.Env.GOPATH}}

    # Custom gcflags.
    #
    # Templates: allowed
    gcflags:
      - all=-trimpath={{.Env.GOPATH}}
      - ./dontoptimizeme=-N

    # Custom ldflags.
    #
    # Default: '-s -w -X main.version={{.Version}} -X main.commit={{.Commit}} -X main.date={{.Date}} -X main.builtBy=goreleaser'
    # Templates: allowed
    ldflags:
      - -s -w -X main.build={{.Version}}
      - ./usemsan=-msan

    # Custom Go build mode.
    #
    # Valid options:
    # - `c-shared`
    # - `c-archive`
    #
    # Since: v1.13
    buildmode: c-shared

    # Custom build tags templates.
    tags:
      - osusergo
      - netgo
      - static_build
      - feature

    # Custom environment variables to be set during the builds.
    # Invalid environment variables will be ignored.
    #
    # Default: os.Environ() ++ env config section
    # Templates: allowed (since v1.14)
    env:
      - CGO_ENABLED=0
      # complex, templated envs (v1.14+):
      - >-
        {{- if eq .Os "darwin" }}
          {{- if eq .Arch "amd64"}}CC=o64-clang{{- end }}
          {{- if eq .Arch "arm64"}}CC=aarch64-apple-darwin20.2-clang{{- end }}
        {{- end }}
        {{- if eq .Os "windows" }}
          {{- if eq .Arch "amd64" }}CC=x86_64-w64-mingw32-gcc{{- end }}
        {{- end }}

    # GOOS list to build for.
    # For more info refer to: https://golang.org/doc/install/source#environment
    #
    # Default: [ 'darwin', 'linux', 'windows' ]
    goos:
      - freebsd
      - windows

    # GOARCH to build for.
    # For more info refer to: https://golang.org/doc/install/source#environment
    #
    # Default: [ '386', 'amd64', 'arm64' ]
    goarch:
      - amd64
      - arm
      - arm64

    # GOARM to build for when GOARCH is arm.
    # For more info refer to: https://golang.org/doc/install/source#environment
    #
    # Default: [ 6 ]
    goarm:
      - 6
      - 7

    # GOAMD64 to build when GOARCH is amd64.
    # For more info refer to: https://golang.org/doc/install/source#environment
    #
    # Default: [ 'v1' ]
    goamd64:
      - v2
      - v3

    # GOMIPS and GOMIPS64 to build when GOARCH is mips, mips64, mipsle or mips64le.
    # For more info refer to: https://golang.org/doc/install/source#environment
    #
    # Default: [ 'hardfloat' ]
    gomips:
      - hardfloat
      - softfloat

    # List of combinations of GOOS + GOARCH + GOARM to ignore.
    ignore:
      - goos: darwin
        goarch: 386
      - goos: linux
        goarch: arm
        goarm: 7
      - goarm: mips64
      - gomips: hardfloat
      - goamd64: v4

    # Optionally override the matrix generation and specify only the final list
    # of targets.
    #
    # Format is `{goos}_{goarch}` with their respective suffixes when
    # applicable: `_{goarm}`, `_{goamd64}`, `_{gomips}`.
    #
    # Special values:
    # - go_118_first_class: evaluates to the first-class ports of go1.18.
    # - go_first_class: evaluates to latest stable go first-class ports,
    #   currently same as 1.18.
    #
    # This overrides `goos`, `goarch`, `goarm`, `gomips`, `goamd64` and
    # `ignores`.
    targets:
      # Since: v1.9
      - go_first_class
      # Since: v1.9
      - go_118_first_class
      - linux_amd64_v1
      - darwin_arm64
      - linux_arm_6

    # Set a specific go binary to use when building.
    # It is safe to ignore this option in most cases.
    #
    # Default is "go"
    gobinary: "go1.13.4"

    # Sets the command to run to build.
    # Can be useful if you want to build tests, for example,
    # in which case you can set this to "test".
    # It is safe to ignore this option in most cases.
    #
    # Default: build.
    # Since: v1.9
    command: test

    # Set the modified timestamp on the output binary, typically
    # you would do this to ensure a build was reproducible. Pass
    # empty string to skip modifying the output.
    #
    # Templates: allowed.
    mod_timestamp: "{{ .CommitTimestamp }}"

    # Hooks can be used to customize the final binary,
    # for example, to run generators.
    #
    # Templates: allowed
    hooks:
      pre: rice embed-go
      post: ./script.sh {{ .Path }}

    # If true, skip the build.
    # Useful for library projects.
    skip: false

    # By default, GoReleaser will create your binaries inside
    # `dist/${BuildID}_${BuildTarget}`, which is a unique directory per build
    # target in the matrix.
    # You can set subdirs within that folder using the `binary` property.
    #
    # However, if for some reason you don't want that unique directory to be
    # created, you can set this property.
    # If you do, you are responsible for keeping different builds from
    # overriding each other.
    no_unique_dist_dir: true

    # By default, GoReleaser will check if the main filepath has a main
    # function.
    # This can be used to skip that check, in case you're building tests, for
    # example.
    #
    # Since: v1.9
    no_main_check: true

    # Path to project's (sub)directory containing Go code.
    # This is the working directory for the Go build command(s).
    # If dir does not contain a `go.mod` file, and you are using `gomod.proxy`,
    # produced binaries will be invalid.
    # You would likely want to use `main` instead of this.
    #
    # Default: '.'
    dir: go

    # Builder allows you to use a different build implementation.
    # This is a GoReleaser Pro feature.
    # Valid options are: `go` and `prebuilt`.
    #
    # Default: 'go'
    builder: prebuilt

    # Overrides allows to override some fields for specific targets.
    # This can be specially useful when using CGO.
    # Note: it'll only match if the full target matches.
    #
    # Since: v1.5
    overrides:
      - goos: darwin
        goarch: arm64
        goamd64: v1
        goarm: ""
        gomips: ""
        ldflags:
          - foo
        tags:
          - bar
        asmflags:
          - foobar
        gcflags:
          - foobaz
        env:
          - CGO_ENABLED=1
```

**åŒ…å«å¤šä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„æ„å»ºï¼š**

```yaml
# .goreleaser.yaml
builds:
  - main: ./cmd/cli
    id: "cli"
    binary: cli
    goos:
      - linux
      - darwin
      - windows

  - main: ./cmd/worker
    id: "worker"
    binary: worker
    goos:
      - linux
      - darwin
      - windows

  - main: ./cmd/tracker
    id: "tracker"
    binary: tracker
    goos:
      - linux
      - darwin
      - windows
```

äºŒè¿›åˆ¶åç§°å­—æ®µæ”¯æŒ[æ¨¡æ¿åŒ–](https://goreleaser.com/customization/templates/)ã€‚å…¬å¼€äº†ä»¥ä¸‹æ„å»ºè¯¦ç»†ä¿¡æ¯ï¼š

| Key     | Description                     |
| ------- | ------------------------------- |
| .Os     | GOOS                            |
| .Arch   | GOARCH                          |
| .Arm    | GOARM                           |
| .Ext    | Extension, e.g. .exe            |
| .Target | Build target, e.g. darwin_amd64 |

æ‚¨å¯ä»¥é€šè¿‡`{{ .Env.VARIABLE_NAME }}`åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨æ¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œä¾‹å¦‚ï¼š

```yaml
# .goreleaser.yaml
builds:
  - ldflags:
   - -s -w -X "main.goversion={{.Env.GOVERSION}}"
```

ç„¶åä½ å¯ä»¥è¿è¡Œï¼š

`GOVERSION=$(go version) goreleaser`

## build hooks

pre å’Œ post æŒ‚é’©éƒ½ **é’ˆå¯¹æ¯ä¸ªæ„å»ºç›®æ ‡** è¿è¡Œï¼Œæ— è®ºè¿™äº›ç›®æ ‡æ˜¯é€šè¿‡æ“ä½œç³»ç»Ÿå’Œæ¶æ„çŸ©é˜µç”Ÿæˆè¿˜æ˜¯æ˜¾å¼å®šä¹‰ã€‚

é™¤äº†ä¸Šé¢æ‰€ç¤ºçš„ç®€å•å£°æ˜ä¹‹å¤–ï¼Œè¿˜å¯ä»¥å£°æ˜å¤šä¸ªæŒ‚é’©ï¼Œä»¥å¸®åŠ©ä¿æŒä¸åŒæ„å»ºç¯å¢ƒä¹‹é—´é…ç½®çš„å¯é‡ç”¨æ€§ã€‚

```yaml
# .goreleaser.yaml
builds:
  - id: "with-hooks"
    targets:
      - "darwin_amd64"
      - "windows_amd64"
    hooks:
      pre:
        - first-script.sh
        - second-script.sh
      post:
        - upx "{{ .Path }}"
        - codesign -project="{{ .ProjectName }}" "{{ .Path }}"
```

æ¯ä¸ªé’©å­è¿˜å¯ä»¥æœ‰è‡ªå·±çš„å·¥ä½œç›®å½•å’Œç¯å¢ƒå˜é‡ï¼š

```yaml
# .goreleaser.yaml
builds:
  - id: "with-hooks"
    targets:
      - "darwin_amd64"
      - "windows_amd64"
    hooks:
      pre:
        - cmd: first-script.sh
          dir:
            "{{ dir .Dist}}"
            # Always print command output, otherwise only visible in debug mode.
            # Since: v1.5
          output: true
          env:
            - HOOK_SPECIFIC_VAR={{ .Env.GLOBAL_VAR }}
        - second-script.sh
```

é’©å­çš„æ‰€æœ‰å±æ€§ï¼ˆ`cmd`ã€`dir`å’Œ`env`ï¼‰éƒ½æ”¯æŒä½¿ç”¨å…·æœ‰å¯ç”¨äºŒè¿›åˆ¶å·¥ä»¶çš„é’©å­[è¿›è¡Œæ¨¡æ¿åŒ–](https://goreleaser.com/customization/templates/)ï¼ˆå› ä¸ºå®ƒä»¬åœ¨æ„å»º*åè¿è¡Œï¼‰ã€‚*æ­¤å¤–ï¼Œä»¥ä¸‹æ„å»ºè¯¦ç»†ä¿¡æ¯ä¹Ÿä¼šæš´éœ²ç»™å’Œé’©å­ï¼š`postprepost`

| Key     | Description                          |
| ------- | ------------------------------------ |
| .Name   | Filename of the binary, e.g.Â bin.exe |
| .Ext    | Extension, e.g.Â .exe                 |
| .Path   | Absolute path to the binary          |
| .Target | Build target, e.g.Â darwin_amd64      |

ç¯å¢ƒå˜é‡æŒ‰ä»¥ä¸‹é¡ºåºç»§æ‰¿å’Œè¦†ç›–ï¼š

- å…¨å±€ ( `env`)
- æ„å»º ( `builds[].env`)
- é’©å­ (`builds[].hooks.pre[].env`å’Œ`builds[].hooks.post[].env`)

### æ¨¡å—

å¦‚æœæ‚¨ä½¿ç”¨å¸¦æœ‰ go æ¨¡å—æˆ– vgo çš„ Go 1.11+ï¼Œå½“ GoReleaser è¿è¡Œæ—¶ï¼Œå®ƒå¯èƒ½ä¼šå°è¯•ä¸‹è½½ä¾èµ–é¡¹ã€‚ç”±äºå¤šä¸ªæ„å»ºå¹¶è¡Œè¿è¡Œï¼Œå› æ­¤å¾ˆå¯èƒ½ä¼šå¤±è´¥ã€‚

æ‚¨å¯ä»¥é€šè¿‡`go mod tidy`åœ¨è°ƒç”¨ä¹‹å‰è¿è¡Œ`goreleaser`æˆ–æ·»åŠ ä¸€ä¸ªåœ¨æ–‡ä»¶ä¸Šæ‰§è¡Œæ­¤æ“ä½œçš„[æŒ‚é’©](https://goreleaser.com/customization/hooks)`.goreleaser.yaml`æ¥è§£å†³æ­¤é—®é¢˜ï¼š

```yaml
# .goreleaser.yaml
before:
  hooks:
    - go mod tidy
# rest of the file...
```

## archives

`README`æ„å»ºçš„äºŒè¿›åˆ¶æ–‡ä»¶å°†ä¸å’Œæ–‡ä»¶ä¸€èµ·å½’æ¡£`LICENSE`åˆ°ä¸€ä¸ª`tar.gz`æ–‡ä»¶ä¸­ã€‚åœ¨æ­¤`archives`éƒ¨åˆ†ä¸­ï¼Œæ‚¨å¯ä»¥è‡ªå®šä¹‰å­˜æ¡£åç§°ã€å…¶ä»–æ–‡ä»¶å’Œæ ¼å¼ã€‚

```yaml
# .goreleaser.yaml
archives:
  - #
    # ID of this archive.
    #
    # Default: 'default'
    id: my-archive

    # Builds reference which build instances should be archived in this archive.
    builds:
      - default

    # Archive format. Valid options are `tar.gz`, `tgz`, `tar.xz`, `txz`, tar`, `gz`, `zip` and `binary`.
    # If format is `binary`, no archives are created and the binaries are instead
    # uploaded directly.
    #
    # Default: 'tar.gz'
    format: zip

    # This will create an archive without any binaries, only the files are there.
    # The name template must not contain any references to `Os`, `Arch` and etc, since the archive will be meta.
    #
    # Since: v1.9
    # Templates: allowed
    meta: true

    # Archive name.
    #
    # Default:
    # - if format is `binary`:
    #   - `{{ .Binary }}_{{ .Version }}_{{ .Os }}_{{ .Arch }}{{ with .Arm }}v{{ . }}{{ end }}{{ with .Mips }}_{{ . }}{{ end }}{{ if not (eq .Amd64 "v1") }}{{ .Amd64 }}{{ end }}`
    # - if format is anything else:
    #   - `{{ .ProjectName }}_{{ .Version }}_{{ .Os }}_{{ .Arch }}{{ with .Arm }}v{{ . }}{{ end }}{{ with .Mips }}_{{ . }}{{ end }}{{ if not (eq .Amd64 "v1") }}{{ .Amd64 }}{{ end }}`
    # Templates: allowed
    name_template: "{{ .ProjectName }}_{{ .Version }}_{{ .Os }}_{{ .Arch }}"

    # Sets the given file info to all the binaries included from the `builds`.
    #
    # Default: copied from the source binary.
    # Since: v1.14
    builds_info:
      group: root
      owner: root
      mode: 0644
      # format is `time.RFC3339Nano`
      mtime: 2008-01-02T15:04:05Z

    # Set this to true if you want all files in the archive to be in a single directory.
    # If set to true and you extract the archive 'goreleaser_Linux_arm64.tar.gz',
    # you'll get a folder 'goreleaser_Linux_arm64'.
    # If set to false, all files are extracted separately.
    # You can also set it to a custom folder name (templating is supported).
    wrap_in_directory: true

    # If set to true, will strip the parent directories away from binary files.
    #
    # This might be useful if you have your binary be built with a subdir for some reason, but do no want that subdir inside the archive.
    #
    # Since: v1.11
    strip_parent_binary_folder: true

    # This will make the destination paths be relative to the longest common
    # path prefix between all the files matched and the source glob.
    # Enabling this essentially mimic the behavior of nfpm's contents section.
    # It will be the default by June 2023.
    #
    # Since: v1.14
    rlcp: true

    # Can be used to change the archive formats for specific GOOSs.
    # Most common use case is to archive as zip on Windows.
    format_overrides:
      - goos: windows
        format: zip

    # Additional files/globs you want to add to the archive.
    #
    # Default: [ 'LICENSE*', 'README*', 'CHANGELOG', 'license*', 'readme*', 'changelog']
    # Templates: allowed
    files:
      - LICENSE.txt
      - README_{{.Os}}.md
      - CHANGELOG.md
      - docs/*
      - design/*.png
      - templates/**/*
      # a more complete example, check the globbing deep dive below
      - src: "*.md"
        dst: docs

        # Strip parent folders when adding files to the archive.
        strip_parent: true

        # File info.
        # Not all fields are supported by all formats available formats.
        #
        # Default: copied from the source file
        info:
          # Templates: allowed (since v1.14)
          owner: root

          # Templates: allowed (since v1.14)
          group: root

          # Must be in time.RFC3339Nano format.
          #
          # Templates: allowed (since v1.14)
          mtime: "{{ .CommitDate }}"

          # File mode.
          mode: 0644

    # Additional templated files to add to the archive.
    # Those files will have their contents pass through the template engine,
    # and its results will be added to the archive.
    #
    # Since: v1.17 (pro)
    # This feature is only available in GoReleaser Pro.
    # Templates: allowed
    templated_files:
      # a more complete example, check the globbing deep dive below
      - src: "LICENSE.md.tpl"
        dst: LICENSE.md

        # File info.
        # Not all fields are supported by all formats available formats.
        #
        # Default: copied from the source file
        info:
          # Templateable (since v1.14.0)
          owner: root

          # Templateable (since v1.14.0)
          group: root

          # Must be in time.RFC3339Nano format.
          # Templateable (since v1.14.0)
          mtime: "{{ .CommitDate }}"

          # File mode.
          mode: 0644

    # Before and after hooks for each archive.
    # Skipped if archive format is binary.
    # This feature is only available in GoReleaser Pro.
    hooks:
      before:
        - make clean # simple string
        - cmd: go generate ./... # specify cmd
        - cmd: go mod tidy
          output: true # always prints command output
          dir: ./submodule # specify command working directory
        - cmd: touch {{ .Env.FILE_TO_TOUCH }}
          env:
            - "FILE_TO_TOUCH=something-{{ .ProjectName }}" # specify hook level environment variables

      after:
        - make clean
        - cmd: cat *.yaml
          dir: ./submodule
        - cmd: touch {{ .Env.RELEASE_DONE }}
          env:
            - "RELEASE_DONE=something-{{ .ProjectName }}" # specify hook level environment variables

    # Disables the binary count check.
    allow_different_binary_count: true
```

## linux è½¯ä»¶åŒ…

GoReleaser å¯ä»¥è¿æ¥åˆ°[nfpm](https://github.com/goreleaser/nfpm)ä»¥ç”Ÿæˆå’Œå‘å¸ƒ `.deb`ã€`.rpm`ã€`.apk` å’Œ `Archlinux` è½¯ä»¶åŒ…ã€‚

```bash
# .goreleaser.yaml
nfpms:
  # note that this is an array of nfpm configs
  - #
    # ID of the nfpm config, must be unique.
    #
    # Default: 'default'
    id: foo

    # Name of the package.
    # Default: ProjectName
    # Templates: allowed (since v1.18)
    package_name: foo

    # You can change the file name of the package.
    #
    # Default: '{{ .PackageName }}_{{ .Version }}_{{ .Os }}_{{ .Arch }}{{ with .Arm }}v{{ . }}{{ end }}{{ with .Mips }}_{{ . }}{{ end }}{{ if not (eq .Amd64 "v1") }}{{ .Amd64 }}{{ end }}'
    # Templates: allowed
    file_name_template: "{{ .ConventionalFileName }}"

    # Build IDs for the builds you want to create NFPM packages for.
    # Defaults empty, which means no filtering.
    builds:
      - foo
      - bar

    # Your app's vendor.
    vendor: Drum Roll Inc.

    # Your app's homepage.
    homepage: https://example.com/

    # Your app's maintainer (probably you).
    maintainer: Drummer <drum-roll@example.com>

    # Your app's description.
    description: |-
      Drum rolls installer package.
      Software to create fast and easy drum rolls.

    # Your app's license.
    license: Apache 2.0

    # Formats to be generated.
    formats:
      - apk
      - deb
      - rpm
      - termux.deb # Since: v1.11
      - archlinux # Since: v1.13

    # Umask to be used on files without explicit mode set. (overridable)
    #
    # Default: 0o002 (will remove world-writable permissions)
    # Since: v1.19
    umask: 0o002

    # Packages your package depends on. (overridable)
    dependencies:
      - git
      - zsh

    # Packages it provides. (overridable)
    #
    # Since: v1.11
    provides:
      - bar

    # Packages your package recommends installing. (overridable)
    recommends:
      - bzr
      - gtk

    # Packages your package suggests installing. (overridable)
    suggests:
      - cvs
      - ksh

    # Packages that conflict with your package. (overridable)
    conflicts:
      - svn
      - bash

    # Packages it replaces. (overridable)
    replaces:
      - fish

    # Path that the binaries should be installed.
    # Default: '/usr/bin'
    bindir: /usr/bin

    # Version Epoch.
    # Default: extracted from `version` if it is semver compatible
    epoch: 2

    # Version Prerelease.
    # Default: extracted from `version` if it is semver compatible
    prerelease: beta1

    # Version Metadata (previously deb.metadata).
    # Setting metadata might interfere with version comparisons depending on the
    # packager.
    #
    # Default: extracted from `version` if it is semver compatible
    version_metadata: git

    # Version Release.
    release: 1

    # Section.
    section: default

    # Priority.
    priority: extra

    # Makes a meta package - an empty package that contains only supporting
    # files and dependencies.
    # When set to `true`, the `builds` option is ignored.
    #
    # Default: false
    meta: true

    # Changelog YAML file, see: https://github.com/goreleaser/chglog
    #
    # You can use goreleaser/chglog to create the changelog for your project,
    # pass that changelog yaml file to GoReleaser,
    # and it should in turn setup it accordingly for the given available
    # formats (deb and rpm at the moment).
    #
    # Experimental.
    # Since: v1.11
    changelog: ./foo.yml

    # Contents to add to the package.
    # GoReleaser will automatically add the binaries.
    contents:
      # Basic file that applies to all packagers
      - src: path/to/foo
        dst: /usr/bin/foo

      # This will add all files in some/directory or in subdirectories at the
      # same level under the directory /etc. This means the tree structure in
      # some/directory will not be replicated.
      - src: some/directory/
        dst: /etc

      # This will replicate the directory structure under some/directory at
      # /etc, using the "tree" type.
      #
      # Since: v1.17
      # Templates: allowed
      - src: some/directory/
        dst: /etc
        type: tree

      # Simple config file
      - src: path/to/foo.conf
        dst: /etc/foo.conf
        type: config

      # Simple symlink.
      # Corresponds to `ln -s /sbin/foo /usr/local/bin/foo`
      - src: /sbin/foo
        dst: /usr/bin/foo
        type: "symlink"

      # Corresponds to `%config(noreplace)` if the packager is rpm, otherwise it
      # is just a config file
      - src: path/to/local/bar.conf
        dst: /etc/bar.conf
        type: "config|noreplace"

      # The src and dst attributes also supports name templates
      - src: path/{{ .Os }}-{{ .Arch }}/bar.conf
        dst: /etc/foo/bar-{{ .ProjectName }}.conf

    # Additional templated contents to add to the archive.
    # Those files will have their contents pass through the template engine,
    # and its results will be added to the package.
    #
    # Since: v1.17 (pro)
    # This feature is only available in GoReleaser Pro.
    # Templates: allowed
    templated_contents:
      # a more complete example, check the globbing deep dive below
      - src: "LICENSE.md.tpl"
        dst: LICENSE.md

      # These files are not actually present in the package, but the file names
      # are added to the package header. From the RPM directives documentation:
      #
      # "There are times when a file should be owned by the package but not
      # installed - log files and state files are good examples of cases you
      # might desire this to happen."
      #
      # "The way to achieve this, is to use the %ghost directive. By adding this
      # directive to the line containing a file, RPM will know about the ghosted
      # file, but will not add it to the package."
      #
      # For non rpm packages ghost files are ignored at this time.
      - dst: /etc/casper.conf
        type: ghost
      - dst: /var/log/boo.log
        type: ghost

      # You can use the packager field to add files that are unique to a
      # specific packager
      - src: path/to/rpm/file.conf
        dst: /etc/file.conf
        type: "config|noreplace"
        packager: rpm
      - src: path/to/deb/file.conf
        dst: /etc/file.conf
        type: "config|noreplace"
        packager: deb
      - src: path/to/apk/file.conf
        dst: /etc/file.conf
        type: "config|noreplace"
        packager: apk

      # Sometimes it is important to be able to set the mtime, mode, owner, or
      # group for a file that differs from what is on the local build system at
      # build time.
      - src: path/to/foo
        dst: /usr/local/foo
        file_info:
          mode: 0644
          mtime: 2008-01-02T15:04:05Z
          owner: notRoot
          group: notRoot

      # If `dst` ends with a `/`, it'll create the given path and copy the given
      # `src` into it, the same way `cp` works with and without trailing `/`.
      - src: ./foo/bar/*
        dst: /usr/local/myapp/

      # Using the type 'dir', empty directories can be created. When building
      # RPMs, however, this type has another important purpose: Claiming
      # ownership of that folder. This is important because when upgrading or
      # removing an RPM package, only the directories for which it has claimed
      # ownership are removed. However, you should not claim ownership of a
      # folder that is created by the OS or a dependency of your package.
      #
      # A directory in the build environment can optionally be provided in the
      # 'src' field in order copy mtime and mode from that directory without
      # having to specify it manually.
      - dst: /some/dir
        type: dir
        file_info:
          mode: 0700

    # Scripts to execute during the installation of the package. (overridable)
    #
    # Keys are the possible targets during the installation process
    # Values are the paths to the scripts which will be executed.
    scripts:
      preinstall: "scripts/preinstall.sh"
      postinstall: "scripts/postinstall.sh"
      preremove: "scripts/preremove.sh"
      postremove: "scripts/postremove.sh"

    # All fields above marked as `overridable` can be overridden for a given
    # package format in this section.
    overrides:
      # The dependencies override can for example be used to provide version
      # constraints for dependencies where  different package formats use
      # different versions or for dependencies that are named differently.
      deb:
        dependencies:
          - baz (>= 1.2.3-0)
          - some-lib-dev
        # ...
      rpm:
        dependencies:
          - baz >= 1.2.3-0
          - some-lib-devel
        # ...
      apk:
        # ...

    # Custom configuration applied only to the RPM packager.
    rpm:
      # RPM specific scripts.
      scripts:
        # The pretrans script runs before all RPM package transactions / stages.
        pretrans: ./scripts/pretrans.sh
        # The posttrans script runs after all RPM package transactions / stages.
        posttrans: ./scripts/posttrans.sh

      # The package summary.
      #
      # Default: first line of the description
      summary: Explicit Summary for Sample Package

      # The package group.
      # This option is deprecated by most distros but required by old distros
      # like CentOS 5 / EL 5 and earlier.
      group: Unspecified

      # The packager is used to identify the organization that actually packaged
      # the software, as opposed to the author of the software.
      # `maintainer` will be used as fallback if not specified.
      # This will expand any env var you set in the field, eg packager: ${PACKAGER}
      packager: GoReleaser <staff@goreleaser.com>

      # Compression algorithm (gzip (default), lzma or xz).
      compression: lzma

      # Prefixes for relocatable packages.
      #
      # Since: v1.20.
      prefixes:
        - /usr/bin

      # The package is signed if a key_file is set
      signature:
        # PGP secret key file path (can also be ASCII-armored).
        # The passphrase is taken from the environment variable
        # `$NFPM_ID_RPM_PASSPHRASE` with a fallback to `$NFPM_ID_PASSPHRASE`,
        # where ID is the id of the current nfpm config.
        # The id will be transformed to uppercase.
        # E.g. If your nfpm id is 'default' then the rpm-specific passphrase
        # should be set as `$NFPM_DEFAULT_RPM_PASSPHRASE`
        #
        # Templates: allowed
        key_file: "{{ .Env.GPG_KEY_PATH }}"

    # Custom configuration applied only to the Deb packager.
    deb:
      # Lintian overrides
      lintian_overrides:
        - statically-linked-binary
        - changelog-file-missing-in-native-package

      # Custom deb special files.
      scripts:
        # Deb rules script.
        rules: foo.sh
        # Deb templates file, when using debconf.
        templates: templates

      # Custom deb triggers
      triggers:
        # register interest on a trigger activated by another package
        # (also available: interest_await, interest_noawait)
        interest:
          - some-trigger-name
        # activate a trigger for another package
        # (also available: activate_await, activate_noawait)
        activate:
          - another-trigger-name

      # Packages which would break if this package would be installed.
      # The installation of this package is blocked if `some-package`
      # is already installed.
      breaks:
        - some-package

      # The package is signed if a key_file is set
      signature:
        # PGP secret key file path (can also be ASCII-armored).
        # The passphrase is taken from the environment variable
        # `$NFPM_ID_DEB_PASSPHRASE` with a fallback to `$NFPM_ID_PASSPHRASE`,
        # where ID is the id of the current nfpm config.
        # The id will be transformed to uppercase.
        # E.g. If your nfpm id is 'default' then the deb-specific passphrase
        # should be set as `$NFPM_DEFAULT_DEB_PASSPHRASE`
        #
        # Templates: allowed
        key_file: "{{ .Env.GPG_KEY_PATH }}"

        # The type describes the signers role, possible values are "origin",
        # "maint" and "archive".
        #
        # Default: 'origin'
        type: origin

    apk:
      # APK specific scripts.
      scripts:
        # The preupgrade script runs before APK upgrade.
        preupgrade: ./scripts/preupgrade.sh
        # The postupgrade script runs after APK.
        postupgrade: ./scripts/postupgrade.sh

      # The package is signed if a key_file is set
      signature:
        # PGP secret key file path (can also be ASCII-armored).
        # The passphrase is taken from the environment variable
        # `$NFPM_ID_APK_PASSPHRASE` with a fallback to `$NFPM_ID_PASSPHRASE`,
        # where ID is the id of the current nfpm config.
        # The id will be transformed to uppercase.
        # E.g. If your nfpm id is 'default' then the apk-specific passphrase
        # should be set as `$NFPM_DEFAULT_APK_PASSPHRASE`
        #
        # Templates: allowed
        key_file: "{{ .Env.GPG_KEY_PATH }}"

        # The name of the signing key. When verifying a package, the signature
        # is matched to the public key store in /etc/apk/keys/<key_name>.rsa.pub.
        #
        # Default: maintainer's email address
        # Templates: allowed (since v1.15)
        key_name: origin

    archlinux:
      # Archlinux-specific scripts
      scripts:
        # The preupgrade script runs before pacman upgrades the package.
        preupgrade: ./scripts/preupgrade.sh
        # The postupgrade script runs after pacman upgrades the package.
        postupgrade: ./scripts/postupgrade.sh

      # The pkgbase can be used to explicitly specify the name to be used to refer
      # to a group of packages. See: https://wiki.archlinux.org/title/PKGBUILD#pkgbase.
      pkgbase: foo

      # The packager refers to the organization packaging the software, not to be confused
      # with the maintainer, which is the person who maintains the software.
      packager: GoReleaser <staff@goreleaser.com>
```

Learn more about theÂ [name template engine](https://goreleaser.com/customization/templates/).



## ChecksumsÂ æ ¡éªŒ

GoReleaser ä¼šç”Ÿæˆä¸€ä¸ªæ–‡ä»¶å¹¶å°†å…¶ä¸ç‰ˆæœ¬ä¸€èµ·ä¸Šä¼ ï¼Œä»¥ä¾¿æ‚¨çš„ç”¨æˆ·å¯ä»¥éªŒè¯ä¸‹è½½çš„æ–‡ä»¶æ˜¯å¦æ­£ç¡®ã€‚

è¯¥éƒ¨åˆ†å…è®¸è‡ªå®šä¹‰æ–‡ä»¶åï¼š

```jsx
# .goreleaser.yaml
checksum:
  # You can change the name of the checksums file.
  #
  # Default: {{ .ProjectName }}_{{ .Version }}_checksums.txt
  # Templates: allowed
  name_template: "{{ .ProjectName }}_checksums.txt"

  # Algorithm to be used.
  # Accepted options are sha256, sha512, sha1, crc32, md5, sha224 and sha384.
  #
  # Default: sha256.
  algorithm: sha256

  # IDs of artifacts to include in the checksums file.
  #
  # If left empty, all published binaries, archives, linux packages and source archives
  # are included in the checksums file.
  ids:
    - foo
    - bar

  # Disable the generation/upload of the checksum file.
  disable: true

  # You can add extra pre-existing files to the checksums file.
  # The filename on the checksum will be the last part of the path (base).
  # If another file with the same name exists, the last one found will be used.
  #
  # Templates: allowed
  extra_files:
    - glob: ./path/to/file.txt
    - glob: ./glob/**/to/**/file/**/*
    - glob: ./glob/foo/to/bar/file/foobar/override_from_previous
    - glob: ./single_file.txt
      name_template: file.txt # note that this only works if glob matches 1 file only

  # Additional templated extra files to add to the checksum.
  # Those files will have their contents pass through the template engine,
  # and its results will be added to the checksum.
  #
  # Since: v1.17 (pro)
  # This feature is only available in GoReleaser Pro.
  # Templates: allowed
  templated_extra_files:
    - src: LICENSE.tpl
      dst: LICENSE.txt
```

## Snapcraft Packages (snaps)Â Snapcraft Packages

GoReleaserä¹Ÿå¯ä»¥ç”Ÿæˆè½¯ä»¶åŒ…ã€‚Snaps æ˜¯ä¸€ç§æ–°çš„æ‰“åŒ…æ ¼å¼ï¼Œå¯è®©æ‚¨å°†é¡¹ç›®ç›´æ¥å‘å¸ƒåˆ° Ubuntu å•†åº—ã€‚ä»é‚£é‡Œï¼Œå®ƒå¯ä»¥å®‰è£…åœ¨æ‰€æœ‰å—æ”¯æŒçš„Linuxå‘è¡Œç‰ˆä¸­ï¼Œå¹¶è¿›è¡Œè‡ªåŠ¨å’Œäº‹åŠ¡æ€§æ›´æ–°ã€‚

æ‚¨å¯ä»¥åœ¨ snapcraft æ–‡æ¡£ä¸­é˜…è¯»æ›´å¤šç›¸å…³ä¿¡æ¯ã€‚

**Snapsæ˜¯é€‚ç”¨äºæ¡Œé¢**ã€**äº‘**å’Œ**ç‰©è”ç½‘**çš„ Linux åº”ç”¨ç¨‹åºåŒ…ï¼Œæ˜“äºå®‰è£…ã€å®‰å…¨ã€è·¨å¹³å°ä¸”æ— ä¾èµ–æ€§ã€‚

å®ƒä»¬ä¼š**è‡ªåŠ¨æ›´æ–°ï¼Œå¹¶ä¸”é€šå¸¸åœ¨æœ‰é™çš„**åŸºäº**äº‹åŠ¡çš„**ç¯å¢ƒä¸­è¿è¡Œã€‚**å®‰å…¨æ€§å’Œç¨³å¥æ€§**æ˜¯å…¶ä¸»è¦ç‰¹ç‚¹ï¼Œæ­¤å¤–è¿˜**æ˜“äºå®‰è£…**ã€**æ˜“äºç»´æŠ¤**å’Œ**æ˜“äºå‡çº§**ã€‚

**Snapd å‘å¸ƒæµç¨‹**

snapd æ˜¯ç®¡ç†å’Œç»´æŠ¤å¿«ç…§çš„åå°æœåŠ¡ã€‚å®ƒæœ¬èº«å¯ä»¥ä½œä¸º snap åŒ…æˆ–ä¼ ç»Ÿçš„ Linux è½¯ä»¶åŒ…ï¼ˆä¾‹å¦‚ *deb* æˆ– RPMï¼‰æä¾›ã€‚

æœ‰ä¸¤ç§ç±»å‹çš„å‘å¸ƒï¼›ä¸»è¦å’Œæ¬¡è¦ç‰ˆæœ¬ï¼Œç”±å…¶ç‰ˆæœ¬å·çš„æ•°å­—çŠ¶æ€è¡¨ç¤ºï¼Œå¹¶å¸¦æœ‰æ¬¡è¦å¥ç‚¹å’Œä¸ºæ¬¡è¦ç‰ˆæœ¬ä¿ç•™çš„æ•°å­—ï¼š

- ä¸»è¦ç‰ˆæœ¬å‘å¸ƒï¼š2.53ã€2.54ã€2.55
- æ¬¡è¦ç‰ˆæœ¬å‘å¸ƒï¼š2.53.1ã€2.53.2

ä¸»è¦ç‰ˆæœ¬å’Œæ¬¡è¦ç‰ˆæœ¬ä¹‹é—´çš„åŒºåˆ«åœ¨äºå…¶è®¡åˆ’ã€å‡†å¤‡å’ŒåŠ¨æœºã€‚æ¯éš”å‡ å‘¨å°±æœ‰ä¸€ä¸ªä¸»è¦å‘å¸ƒå‘¨æœŸï¼Œä½†æœ‰æ—¶æˆ‘ä»¬éœ€è¦åŒ…å«è¾ƒå°æ›´æ”¹å’Œä¿®å¤çš„ä¸­é—´æ¬¡è¦ç‰ˆæœ¬å‘å¸ƒã€‚

ä¸»è¦ç‰ˆæœ¬å’Œåç»­æ¬¡è¦ç‰ˆæœ¬ï¼ˆä¾‹å¦‚ 2.53 -> 2.53.1ï¼‰ä¹‹é—´çš„å·®å¼‚å°½å¯èƒ½å°ä¸”æœ‰é’ˆå¯¹æ€§ï¼Œå¹¶çœç•¥ä¸»è¦ä»£ç é‡æ„å’Œæ–°åŠŸèƒ½ã€‚è¿™å¹¶ä¸æ€»æ˜¯å¯èƒ½çš„ï¼Œå› ä¸ºæœ‰æ—¶é”™è¯¯æˆ–åŠŸèƒ½å¾ˆå¤æ‚ï¼Œä½†è¿™æ˜¯æˆ‘ä»¬çš„é¦–è¦ç›®æ ‡ã€‚

**é€æ­¥å‘å¸ƒæµç¨‹**

- [https://gist.github.com/baymaxium/e1602202e7a3ef53a723ae14a3e928bc](https://gist.github.com/baymaxium/e1602202e7a3ef53a723ae14a3e928bc)

**ä½¿ç”¨Snapcraftæ„å»ºå‘å¸ƒSnapå®‰è£…åŒ…**

ç”Ÿæˆä¸€ä¸ªåˆå§‹å·¥ç¨‹ï¼š

```jsx
$ snapcraft init
Created snap/snapcraft.yaml.
```

## Docker Images

GoReleaser å¯ä»¥æ„å»ºå’Œæ¨é€ Docker é•œåƒã€‚è®©æˆ‘ä»¬çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

æ‚¨å¯ä»¥å£°æ˜å¤šä¸ª Docker æ˜ åƒã€‚å®ƒä»¬å°†ä¸èŠ‚ç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶å’ŒèŠ‚ç”Ÿæˆçš„åŒ…è¿›è¡ŒåŒ¹é…ã€‚

å¦‚æœæ‚¨åªæœ‰ä¸€ä¸ªè®¾ç½®ï¼Œåˆ™é…ç½®å°±åƒå°†æ˜ åƒåç§°æ·»åŠ åˆ°æ–‡ä»¶ä¸­ä¸€æ ·ç®€å•ï¼š

```jsx
dockers:
  - image_templates:
      - user/repo
```

æ‚¨è¿˜éœ€è¦åœ¨é¡¹ç›®çš„æ ¹æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ª `Dockerfile`ï¼š

```jsx
FROM scratch
ENTRYPOINT ["/mybin"]
COPY mybin /
```

æ­¤é…ç½®å°†ç”Ÿæˆå¹¶æ¨é€åä¸º çš„ Docker æ˜ åƒã€‚

**CustomizationÂ å®šåˆ¶**

```jsx
# .goreleaser.yaml
dockers:
  # You can have multiple Docker images.
  - #
    # ID of the image, needed if you want to filter by it later on (e.g. on custom publishers).
    id: myimg

    # GOOS of the built binaries/packages that should be used.
    # Default: 'linux'
    goos: linux

    # GOARCH of the built binaries/packages that should be used.
    # Default: 'amd64'
    goarch: amd64

    # GOARM of the built binaries/packages that should be used.
    # Default: '6'
    goarm: ""

    # GOAMD64 of the built binaries/packages that should be used.
    # Default: 'v1'
    goamd64: "v2"

    # IDs to filter the binaries/packages.
    ids:
      - mybuild
      - mynfpm

    # Templates of the Docker image names.
    #
    # Templates: allowed
    image_templates:
      - "myuser/myimage:latest"
      - "myuser/myimage:{{ .Tag }}"
      - "myuser/myimage:{{ .Tag }}-{{ .Env.FOOBAR }}"
      - "myuser/myimage:v{{ .Major }}"
      - "gcr.io/myuser/myimage:latest"

    # Skips the docker build.
    # Could be useful if you want to skip building the windows docker image on
    # linux, for example.
    #
    # Templates: allowed
    # Since: v1.14 (pro)
    # This option is only available on GoReleaser Pro.
    skip_build: false

    # Skips the docker push.
    # Could be useful if you also do draft releases.
    #
    # If set to auto, the release will not be pushed to the Docker repository
    #  in case there is an indicator of a prerelease in the tag, e.g. v1.0.0-rc1.
    #
    # Templates: allowed (since v1.19)
    skip_push: false

    # Path to the Dockerfile (from the project root).
    #
    # Default: 'Dockerfile'
    dockerfile: "{{ .Env.DOCKERFILE }}"

    # Set the "backend" for the Docker pipe.
    #
    # Valid options are: docker, buildx, podman.
    #
    # Podman is a GoReleaser Pro feature and is only available on Linux.
    #
    # Default: 'docker'
    use: docker

    # Docker build flags.
    #
    # Templates: allowed
    build_flag_templates:
      - "--pull"
      - "--label=org.opencontainers.image.created={{.Date}}"
      - "--label=org.opencontainers.image.title={{.ProjectName}}"
      - "--label=org.opencontainers.image.revision={{.FullCommit}}"
      - "--label=org.opencontainers.image.version={{.Version}}"
      - "--build-arg=FOO={{.Env.Bar}}"
      - "--platform=linux/arm64"

    # Extra flags to be passed down to the push command.
    push_flags:
      - --tls-verify=false

    # If your Dockerfile copies files other than binaries and packages,
    # you should list them here as well.
    # Note that GoReleaser will create the same structure inside a temporary
    # folder, so if you add `foo/bar.json` here, on your Dockerfile you can
    # `COPY foo/bar.json /whatever.json`.
    # Also note that the paths here are relative to the folder in which
    # GoReleaser is being run (usually the repository root folder).
    # This field does not support wildcards, you can add an entire folder here
    # and use wildcards when you `COPY`/`ADD` in your Dockerfile.
    extra_files:
      - config.yml

    # Additional templated extra files to add to the Docker image.
    # Those files will have their contents pass through the template engine,
    # and its results will be added to the build context the same way as the
    # extra_files field above.
    #
    # Since: v1.17 (pro)
    # This feature is only available in GoReleaser Pro.
    # Templates: allowed
    templated_extra_files:
      - src: LICENSE.tpl
        dst: LICENSE.txt
        mode: 0644
```

## Docker Images

GoReleaser å¯ä»¥æ„å»ºå’Œæ¨é€ Docker é•œåƒã€‚è®©æˆ‘ä»¬çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

æ‚¨å¯ä»¥å£°æ˜å¤šä¸ª Docker æ˜ åƒã€‚å®ƒä»¬å°†ä¸èŠ‚ç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶å’ŒèŠ‚ç”Ÿæˆçš„åŒ…è¿›è¡ŒåŒ¹é…ã€‚

å¦‚æœæ‚¨åªæœ‰ä¸€ä¸ª build è®¾ç½®ï¼Œåˆ™é…ç½®å°±åƒå°†æ˜ åƒåç§°æ·»åŠ åˆ°æ–‡ä»¶ä¸­ä¸€æ ·ç®€å•ï¼š

```jsx
dockers:
  - image_templates:
      - user/repo
```

æ‚¨è¿˜éœ€è¦åœ¨é¡¹ç›®çš„æ ¹æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªï¼š

```jsx
FROM scratch
ENTRYPOINT ["/mybin"]
COPY mybin /
```

æ­¤é…ç½®å°†ç”Ÿæˆå¹¶æ¨é€åä¸º çš„ Docker æ˜ åƒã€‚

**Customization**

```jsx
# .goreleaser.yaml
dockers:
  # You can have multiple Docker images.
  - #
    # ID of the image, needed if you want to filter by it later on (e.g. on custom publishers).
    id: myimg

    # GOOS of the built binaries/packages that should be used.
    # Default: 'linux'
    goos: linux

    # GOARCH of the built binaries/packages that should be used.
    # Default: 'amd64'
    goarch: amd64

    # GOARM of the built binaries/packages that should be used.
    # Default: '6'
    goarm: ""

    # GOAMD64 of the built binaries/packages that should be used.
    # Default: 'v1'
    goamd64: "v2"

    # IDs to filter the binaries/packages.
    ids:
      - mybuild
      - mynfpm

    # Templates of the Docker image names.
    #
    # Templates: allowed
    image_templates:
      - "myuser/myimage:latest"
      - "myuser/myimage:{{ .Tag }}"
      - "myuser/myimage:{{ .Tag }}-{{ .Env.FOOBAR }}"
      - "myuser/myimage:v{{ .Major }}"
      - "gcr.io/myuser/myimage:latest"

    # Skips the docker build.
    # Could be useful if you want to skip building the windows docker image on
    # linux, for example.
    #
    # Templates: allowed
    # Since: v1.14 (pro)
    # This option is only available on GoReleaser Pro.
    skip_build: false

    # Skips the docker push.
    # Could be useful if you also do draft releases.
    #
    # If set to auto, the release will not be pushed to the Docker repository
    #  in case there is an indicator of a prerelease in the tag, e.g. v1.0.0-rc1.
    #
    # Templates: allowed (since v1.19)
    skip_push: false

    # Path to the Dockerfile (from the project root).
    #
    # Default: 'Dockerfile'
    dockerfile: "{{ .Env.DOCKERFILE }}"

    # Set the "backend" for the Docker pipe.
    #
    # Valid options are: docker, buildx, podman.
    #
    # Podman is a GoReleaser Pro feature and is only available on Linux.
    #
    # Default: 'docker'
    use: docker

    # Docker build flags.
    #
    # Templates: allowed
    build_flag_templates:
      - "--pull"
      - "--label=org.opencontainers.image.created={{.Date}}"
      - "--label=org.opencontainers.image.title={{.ProjectName}}"
      - "--label=org.opencontainers.image.revision={{.FullCommit}}"
      - "--label=org.opencontainers.image.version={{.Version}}"
      - "--build-arg=FOO={{.Env.Bar}}"
      - "--platform=linux/arm64"

    # Extra flags to be passed down to the push command.
    push_flags:
      - --tls-verify=false

    # If your Dockerfile copies files other than binaries and packages,
    # you should list them here as well.
    # Note that GoReleaser will create the same structure inside a temporary
    # folder, so if you add `foo/bar.json` here, on your Dockerfile you can
    # `COPY foo/bar.json /whatever.json`.
    # Also note that the paths here are relative to the folder in which
    # GoReleaser is being run (usually the repository root folder).
    # This field does not support wildcards, you can add an entire folder here
    # and use wildcards when you `COPY`/`ADD` in your Dockerfile.
    extra_files:
      - config.yml

    # Additional templated extra files to add to the Docker image.
    # Those files will have their contents pass through the template engine,
    # and its results will be added to the build context the same way as the
    # extra_files field above.
    #
    # Since: v1.17 (pro)
    # This feature is only available in GoReleaser Pro.
    # Templates: allowed
    templated_extra_files:
      - src: LICENSE.tpl
        dst: LICENSE.txt
        mode: 0644
```

è¯·æ³¨æ„ï¼Œæ‚¨å¿…é¡»æ‰‹åŠ¨ç™»å½•åˆ°è¦æ¨é€åˆ°çš„Dockeræ³¨å†Œè¡¨ - GoReleaserä¸ä¼šè‡ªè¡Œç™»å½•ã€‚

> è¯·æ³¨æ„ï¼Œæ‚¨å¿…é¡»æ‰‹åŠ¨ç™»å½•åˆ°è¦æ¨é€åˆ°çš„Dockeræ³¨å†Œè¡¨ - GoReleaserä¸ä¼šè‡ªè¡Œç™»å½•ã€‚

è¿™äº›è®¾ç½®åº”è¯¥å…è®¸æ‚¨ç”Ÿæˆå¤šä¸ª Docker æ˜ åƒï¼Œä¾‹å¦‚ï¼Œä½¿ç”¨å¤šä¸ªè¯­å¥ï¼Œä»¥åŠä¸ºé¡¹ç›®ä¸­çš„æ¯ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ç”Ÿæˆä¸€ä¸ªæ˜ åƒæˆ–ä¸€ä¸ªå…·æœ‰å¤šä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„æ˜ åƒï¼Œä»¥åŠå®‰è£…ç”Ÿæˆçš„åŒ…è€Œä¸æ˜¯æ‰‹åŠ¨å¤åˆ¶äºŒè¿›åˆ¶æ–‡ä»¶å’Œé…ç½®ã€‚

### é€šç”¨æ˜ åƒåç§°

æŸäº›ç”¨æˆ·å¯èƒ½å¸Œæœ›ä½¿å…¶æ˜ åƒåç§°å°½å¯èƒ½é€šç”¨ã€‚è¿™å¯ä»¥é€šè¿‡åœ¨å®šä¹‰ä¸­æ·»åŠ æ¨¡æ¿è¯­è¨€æ¥å®ç°ï¼š

```jsx
# .goreleaser.yaml
project_name: foo
dockers:
  - image_templates:
      - "myuser/{{.ProjectName}}"
```

è¿™å°†ç”Ÿæˆå¹¶å‘å¸ƒä»¥ä¸‹æ˜ åƒï¼š

- `myuser/foo`

### ä¿æŒå½“å‰ä¸»è¦å†…å®¹çš„ docker æ˜ åƒæ›´æ–°

ä¸€äº›ç”¨æˆ·å¯èƒ½æƒ³è¦æ¨é€ docker æ ‡è®° ã€ ä»¥åŠä½•æ—¶ï¼ˆä¾‹å¦‚ï¼‰æ„å»ºã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨å¤šä¸ªï¼š

```jsx
# .goreleaser.yaml
dockers:
  - image_templates:
      - "myuser/myimage:{{ .Tag }}"
      - "myuser/myimage:v{{ .Major }}"
      - "myuser/myimage:v{{ .Major }}.{{ .Minor }}"
      - "myuser/myimage:latest"
```

è¿™å°†ç”Ÿæˆå¹¶å‘å¸ƒä»¥ä¸‹æ˜ åƒï¼š

- `myuser/myimage:v1.6.4`
- `myuser/myimage:v1`
- `myuser/myimage:v1.6`
- `myuser/myimage:latest`

é€šè¿‡è¿™äº›è®¾ç½®ï¼Œæ‚¨å¯ä»¥å¸Œæœ›æ¨é€å¤šä¸ªå…·æœ‰å¤šä¸ªæ ‡ç­¾çš„ Docker æ˜ åƒã€‚

### å‘å¸ƒåˆ°å¤šä¸ª docker æ³¨å†Œè¡¨

æŸäº›ç”¨æˆ·å¯èƒ½å¸Œæœ›å°†æ˜ åƒæ¨é€åˆ°å¤šä¸ª docker æ³¨å†Œè¡¨ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨å¤šä¸ªï¼š

```jsx
# .goreleaser.yaml
dockers:
  - image_templates:
      - "docker.io/myuser/myimage:{{ .Tag }}"
      - "docker.io/myuser/myimage:latest"
      - "gcr.io/myuser/myimage:{{ .Tag }}"
      - "gcr.io/myuser/myimage:latest"
```

è¿™ä¼šç”Ÿæˆä»¥ä¸‹æ˜ åƒå¹¶å°†å…¶å‘å¸ƒåˆ° å’Œ ï¼š

- `myuser/myimage:v1.6.4`
- `myuser/myimage:latest`
- `gcr.io/myuser/myimage:v1.6.4`
- `gcr.io/myuser/myimage:latest`

### åº”ç”¨ Docker æ„å»ºæ ‡å¿—

å¯ä»¥ä½¿ç”¨ åº”ç”¨ç”Ÿæˆæ ‡å¿—ã€‚è¿™äº›æ ‡å¿—å¿…é¡»æ˜¯æœ‰æ•ˆçš„ Docker æ„å»ºæ ‡å¿—ã€‚

```jsx
# .goreleaser.yaml
dockers:
  - image_templates:
      - "myuser/myimage"
    build_flag_templates:
      - "--pull"
      - "--label=org.opencontainers.image.created={{.Date}}"
      - "--label=org.opencontainers.image.title={{.ProjectName}}"
      - "--label=org.opencontainers.image.revision={{.FullCommit}}"
      - "--label=org.opencontainers.image.version={{.Version}}"
```

è¿™å°†æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```jsx
docker build -t myuser/myimage . \
  --pull \
  --label=org.opencontainers.image.created=2020-01-19T15:58:07Z \
  --label=org.opencontainers.image.title=mybinary \
  --label=org.opencontainers.image.revision=da39a3ee5e6b4b0d3255bfef95601890afd80709 \
  --label=org.opencontainers.image.version=1.6.4
```

### å°†ç‰¹å®šçš„æ„å»ºå™¨ä¸ Docker buildx ä¸€èµ·ä½¿ç”¨

å¦‚æœå¯ç”¨ï¼Œåˆ™åœ¨æ„å»ºæ˜ åƒæ—¶ä½¿ç”¨ä¸Šä¸‹æ–‡æ„å»ºå™¨ã€‚æ­¤æ„å»ºå™¨å§‹ç»ˆå¯ç”¨ï¼Œå¹¶ç”± Docker å¼•æ“ä¸­çš„ BuildKit æä¾›æ”¯æŒã€‚å¦‚æœè¦ä½¿ç”¨å…¶ä»–æ„å»ºå™¨ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å­—æ®µæŒ‡å®šå®ƒï¼š

```jsx
# .goreleaser.yaml
dockers:
  - image_templates:
      - "myuser/myimage"
    use: buildx
    build_flag_templates:
      - "--builder=mybuilder"
```

### Podman

æ‚¨å¯ä»¥ä½¿ç”¨è€Œä¸æ˜¯é€šè¿‡åœ¨é…ç½®ä¸Šè®¾ç½®ä¸ºï¼š

```jsx
# .goreleaser.yaml
dockers:
  - image_templates:
      - "myuser/myimage"
    use: podman
```

è¯·æ³¨æ„ï¼ŒGoReleaser ä¸ä¼šä¸ºæ‚¨å®‰è£… Podmanï¼Œä¹Ÿä¸ä¼šæ›´æ”¹å…¶ä»»ä½•é…ç½®ã€‚

## Docker Manifests

GoReleaser è¿˜å¯ä»¥ä½¿ç”¨è¯¥å·¥å…·åˆ›å»ºå’Œæ¨é€ Docker å¤šå¹³å°æ˜ åƒã€‚

æ— éœ€åˆ‡æ¢è®¾å¤‡ï¼Œåœ¨ Apple M2 èŠ¯ç‰‡çš„æœºå™¨ä¸Šæˆ‘ä»¬å¯ä»¥ç›´æ¥æ„å»ºÂ `amd64`Â ä¹Ÿå°±æ˜¯ Linux å¹³å°é•œåƒï¼Œ`docker build`Â å‘½ä»¤æä¾›äº†Â `--platform`Â å‚æ•°å¯ä»¥æ„å»ºè·¨å¹³å°é•œåƒã€‚

```jsx
docker build --platform=linux/amd64 -t kubecub/echo-platform-amd64 .
```

è¿è¡Œä¸åŒå¹³å°çš„é•œåƒä¼šæ€ä¹ˆæ ·ï¼š

ä½ ä¹Ÿè®¸ä¼šå¥½å¥‡ï¼Œåœ¨ Apple M2 èŠ¯ç‰‡çš„ä¸»æœºè®¾å¤‡ä¸Šè¿è¡ŒÂ `amd64`Â å¹³å°é•œåƒä¼šæ€æ ·ã€‚ç›®å‰å’±ä»¬æ„å»ºçš„è¿™ä¸ªç®€å•é•œåƒå…¶å®æ˜¯èƒ½å¤Ÿè¿è¡Œçš„ï¼Œåªä¸è¿‡ä¼šå¾—åˆ°ä¸€æ¡è­¦å‘Šä¿¡æ¯ï¼š

```jsx
$ docker run --rm kubecub/echo-platform-amd64
WARNING: The requested image's platform (linux/amd64) does not match the detected host platform (linux/arm64/v8) and no specific platform was requested
Linux buildkitsandbox 5.15.49-linuxkit #1 SMP PREEMPT Tue Sep 13 07:51:32 UTC 2022 x86_64 Linux
```

è¾“å‡ºå†…å®¹ä¸­çš„Â `x86_64`Â å°±è¡¨ç¤ºÂ `AMD64`Â æ¶æ„ã€‚

> æ³¨æ„ï¼šè™½ç„¶è¿™ä¸ªç®€å•çš„é•œåƒèƒ½å¤Ÿè¿è¡ŒæˆåŠŸï¼Œä½†å¦‚æœå®¹å™¨å†…éƒ¨ç¨‹åºä¸æ”¯æŒè·¨å¹³å°ï¼Œ`amd64`Â å¹³å°é•œåƒæ— æ³•åœ¨Â `arm64`Â å¹³å°è¿è¡ŒæˆåŠŸã€‚

**ä½¿ç”¨ manifest åˆå¹¶å¤šå¹³å°é•œåƒ**

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `docker manifest` çš„å­å‘½ä»¤ `create` åˆ›å»ºä¸€ä¸ª `manifest list`ï¼Œå³å°†å¤šä¸ªå¹³å°çš„é•œåƒåˆå¹¶ä¸ºä¸€ä¸ªé•œåƒã€‚

`create` å‘½ä»¤ç”¨æ³•å¾ˆç®€å•ï¼Œåé¢è·Ÿçš„ç¬¬ä¸€ä¸ªå‚æ•° `jianghushinian/echo-platform` å³ä¸ºåˆå¹¶åçš„é•œåƒï¼Œä»ç¬¬äºŒä¸ªå‚æ•°å¼€å§‹å¯ä»¥æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªä¸åŒå¹³å°çš„é•œåƒã€‚

```jsx
docker manifest create kubecub/echo-platform kubecub/echo-platform-arm64 kubecub/echo-platform-amd64
```

æµè§ˆå™¨ä¸­ç™»å½•Â [Docker Hub](https://link.juejin.cn/?target=https%3A%2F%2Fhub.docker.com%2F)Â æŸ¥çœ‹æ¨é€æˆåŠŸçš„é•œåƒï¼š

> è¿›å…¥é•œåƒä¿¡æ¯è¯¦æƒ…é¡µé¢çš„Â `Tags`Â æ ‡ç­¾ï¼Œèƒ½å¤Ÿçœ‹åˆ°é•œåƒæ”¯æŒÂ `amd64`ã€`arm64/v8`Â è¿™ä¸¤ä¸ªå¹³å°ã€‚

### Manifest å‘½ä»¤

å¯ä»¥å‘ç°ï¼Œ`docker manifest`Â å…±æä¾›äº†Â `annotate`ã€`create`ã€`inspect`ã€`push`ã€`rm`Â è¿™ 5 ä¸ªå­å‘½ã€‚

å¯ä»¥å‘ç°ï¼Œ`create`Â å­å‘½ä»¤æ”¯æŒä¸¤ä¸ªå¯é€‰å‚æ•°Â `-a/--amend`Â ç”¨æ¥ä¿®è®¢å·²å­˜åœ¨çš„å¤šæ¶æ„é•œåƒã€‚

æŒ‡å®šÂ `--insecure`Â å‚æ•°åˆ™å…è®¸ä½¿ç”¨ä¸å®‰å…¨çš„ï¼ˆé httpsï¼‰é•œåƒä»“åº“ã€‚

### push

`push`Â å­å‘½ä»¤æˆ‘ä»¬ä¹Ÿè§è¿‡äº†ï¼Œä½¿ç”¨Â `push`Â å¯ä»¥å°†å¤šæ¶æ„é•œåƒæ¨é€åˆ°é•œåƒä»“åº“ã€‚

åŒæ ·çš„ï¼Œ`push`Â ä¹Ÿæœ‰ä¸€ä¸ªÂ `--insecure`Â å‚æ•°å…è®¸ä½¿ç”¨ä¸å®‰å…¨çš„ï¼ˆé httpsï¼‰é•œåƒä»“åº“ã€‚

- `p/--purge`Â é€‰é¡¹çš„ä½œç”¨æ˜¯æ¨é€æœ¬åœ°é•œåƒåˆ°è¿œç¨‹ä»“åº“åï¼Œåˆ é™¤æœ¬åœ°Â `manifest list`ã€‚

### inspect

`inspect`Â ç”¨æ¥æŸ¥çœ‹Â `manifest`/`manifest list`Â æ‰€åŒ…å«çš„é•œåƒä¿¡æ¯ã€‚

`--insecure`Â å‚æ•°å…è®¸ä½¿ç”¨ä¸å®‰å…¨çš„ï¼ˆé httpsï¼‰é•œåƒä»“åº“ã€‚è¿™å·²ç»æ˜¯æˆ‘ä»¬ç¬¬ä¸‰æ¬¡çœ‹è§è¿™ä¸ªå‚æ•°äº†ï¼Œè¿™ä¹ŸéªŒè¯äº†Â `docker manifest`Â å‘½ä»¤éœ€è¦è”ç½‘æ‰èƒ½ä½¿ç”¨çš„è¯´æ³•ï¼Œå› ä¸ºè¿™äº›å­å‘½ä»¤åŸºæœ¬éƒ½æ¶‰åŠåˆ°å’Œè¿œç¨‹é•œåƒä»“åº“çš„äº¤äº’ã€‚

### annotate

`annotate`Â å­å‘½ä»¤å¯ä»¥ç»™ä¸€ä¸ªæœ¬åœ°é•œåƒÂ `manifest`Â æ·»åŠ é™„åŠ çš„ä¿¡æ¯ã€‚è¿™æœ‰ç‚¹åƒ K8s Annotations çš„æ„æ€ã€‚

å¯é€‰å‚æ•°åˆ—è¡¨å¦‚ä¸‹ï¼š

| é€‰é¡¹          | æè¿°                                                         |
| ------------- | ------------------------------------------------------------ |
| --arch        | è®¾ç½® CPU æ¶æ„ä¿¡æ¯ã€‚                                          |
| --os          | è®¾ç½®æ“ä½œç³»ç»Ÿä¿¡æ¯ã€‚                                           |
| --os-features | è®¾ç½®æ“ä½œç³»ç»ŸåŠŸèƒ½ä¿¡æ¯ã€‚                                       |
| --os-version  | è®¾ç½®æ“ä½œç³»ç»Ÿç‰ˆæœ¬ä¿¡æ¯ã€‚                                       |
| --variant     | è®¾ç½® CPU æ¶æ„çš„ variant ä¿¡æ¯ï¼ˆç¿»è¯‘è¿‡æ¥æ˜¯â€œå˜ç§â€çš„æ„æ€ï¼‰ï¼Œå¦‚ ARM æ¶æ„çš„ v7ã€v8 ç­‰ã€‚ |

## rm

æœ€åè¦ä»‹ç»çš„å­å‘½ä»¤æ˜¯Â `rm`ï¼Œä½¿ç”¨Â `rm`Â å¯ä»¥åˆ é™¤æœ¬åœ°ä¸€ä¸ªæˆ–å¤šä¸ªå¤šæ¶æ„é•œåƒï¼ˆ`manifest lists`ï¼‰ã€‚

### Customization

æ‚¨å¯ä»¥åœ¨ä¸€æ¬¡ GoReleaser è¿è¡Œä¸­åˆ›å»ºå¤šä¸ªæ¸…å•ï¼Œä»¥ä¸‹æ˜¯æ‰€æœ‰å¯ç”¨çš„é€‰é¡¹ï¼š

```jsx
# .goreleaser.yaml
docker_manifests:
  # You can have multiple Docker manifests.
-
  # ID of the manifest, needed if you want to filter by it later on (e.g. on
  # custom publishers).
  id: myimg

  # Name for the manifest.
  #
  # Templates: allowed
  name_template: "foo/bar:{{ .Version }}"

  # Image name to be added to this manifest.
  #
  # Templates: allowed
  image_templates:
  - "foo/bar:{{ .Version }}-amd64"
  - "foo/bar:{{ .Version }}-arm64v8"

  # Extra flags to be passed down to the manifest create command.
  create_flags:
  - --insecure

  # Extra flags to be passed down to the manifest push command.
  push_flags:
  - --insecure

  # Skips the Docker manifest.
  # If you set this to `false` or `auto` on your source Docker configuration,
  #  you'll probably want to do the same here.
  #
  # If set to `auto`, the manifest will not be created in case there is an
  #  indicator of a prerelease in the tag, e.g. v1.0.0-rc1.
  #
  # Templates: allowed (since v1.19)
  skip_push: false

  # Set the "backend" for the Docker manifest pipe.
  # Valid options are: docker, podman
  #
  # Relevant notes:
  # 1. podman is a GoReleaser Pro feature and is only available on Linux;
  # 2. if you set podman here, the respective docker configuration need to use
  #     podman too.
  #
  # Default: 'docker'
  use: docker
```

## KO

https://github.com/ko-build/ko

KO is Build and deploy Go applications

install docs:

[Installation - ko: Easy Go Containers](https://ko.build/install/)

User Actions:

```jsx
steps:
- uses: imjasonh/setup-ko@v0.6
```

**User Ko:** 

`ko`å–å†³äº Docker é…ç½®ä¸­é…ç½®çš„èº«ä»½éªŒè¯ï¼ˆé€šå¸¸`~/.docker/config.json`ï¼‰ã€‚

âœ¨**å¦‚æœæ‚¨å¯ä»¥ä½¿ç”¨ æ¨é€å›¾ç‰‡`docker push`ï¼Œåˆ™æ‚¨å·²ç»é€šè¿‡äº†èº«ä»½éªŒè¯`ko`ï¼**âœ¨

ç”±äº`ko`ä¸éœ€è¦`docker`ï¼Œ`ko login`è¿˜æä¾›äº†ä¸€ä¸ªä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç ç™»å½•å®¹å™¨æ˜ åƒæ³¨å†Œè¡¨çš„ç•Œé¢ï¼Œç±»ä¼¼äº`[docker login](https://docs.docker.com/engine/reference/commandline/login/)`.

æ­¤å¤–ï¼Œå³ä½¿æœªåœ¨ Docker é…ç½®ä¸­é…ç½®èº«ä»½éªŒè¯ï¼Œä¹Ÿ`ko`åŒ…å«ä½¿ç”¨ç¯å¢ƒä¸­é…ç½®çš„å‡­æ®å¯¹ä»¥ä¸‹å®¹å™¨æ³¨å†Œè¡¨è¿›è¡Œèº«ä»½éªŒè¯çš„å†…ç½®æ”¯æŒï¼š

- Google å®¹å™¨æ³¨å†Œè¡¨å’Œ Artifact æ³¨å†Œè¡¨ï¼Œä½¿ç”¨[åº”ç”¨ç¨‹åºé»˜è®¤å‡­æ®](https://cloud.google.com/docs/authentication/production)`gcloud`

  æˆ–

- Amazon Elastic Container Registryï¼Œä½¿ç”¨[AWS å‡­è¯](https://github.com/awslabs/amazon-ecr-credential-helper/#aws-credentials)

- Azure å®¹å™¨æ³¨å†Œè¡¨ï¼Œä½¿ç”¨[ç¯å¢ƒå˜é‡](https://github.com/chrismellard/docker-credential-acr-env/)

- GitHub Container Registryï¼Œä½¿ç”¨`GITHUB_TOKEN`ç¯å¢ƒå˜é‡

`ko`å–å†³äºç¯å¢ƒå˜é‡ ï¼Œ`KO_DOCKER_REPO`æ¥ç¡®å®šåº”å°†å…¶æ„å»ºçš„æ˜ åƒæ¨é€åˆ°ä½•å¤„ã€‚é€šå¸¸è¿™å°†æ˜¯è¿œç¨‹æ³¨å†Œè¡¨ï¼Œä¾‹å¦‚ï¼š

- `KO_DOCKER_REPO=gcr.io/my-project`ï¼Œ æˆ–è€…
- `KO_DOCKER_REPO=ghcr.io/my-org/my-repo`ï¼Œ æˆ–è€…
- `KO_DOCKER_REPO=my-dockerhub-user`

**æ­¥éª¤ï¼š**

```jsx
echo "***" | docker login ghcr.io -u kuebcub --password-stdin
export GITHUB_TOKEN="******"
export KO_DOCKER_REPO=ghcr.io/kubecub/exporter; ko build ./cmd/exporter
```

**æµ‹è¯•ï¼š**

```jsx
docker run -p 8080:8080 $(ko build ./cmd/app)
```

## Docker Images with Ko

è¯·æ³¨æ„ ko å°†å†æ¬¡æ„å»ºæ‚¨çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚è¿™ä¸åº”è¯¥è¿‡å¤šåœ°å¢åŠ å‘å¸ƒæ—¶é—´ï¼Œå› ä¸ºå®ƒä¼šåœ¨å¯èƒ½çš„æƒ…å†µä¸‹ä½¿ç”¨ä¸æ„å»ºç®¡é“ç›¸åŒçš„æ„å»ºé€‰é¡¹ï¼Œå› æ­¤ç»“æœå¯èƒ½ä¼šè¢«ç¼“å­˜ã€‚

```jsx
# .goreleaser.yaml
kos:
-
  # ID of this image.
  id: foo

  # Build ID that should be used to import the build settings.
  build: build-id

  # Main path to build.
  #
  # Default: build.main
  main: ./cmd/...

  # Working directory used to build.
  #
  # Default: build.dir
  working_dir: .

  # Base image to publish to use.
  #
  # Default: 'cgr.dev/chainguard/static'
  base_image: alpine

  # Labels for the image.
  #
  # Since: v1.17
  labels:
    foo: bar

  # Repository to push to.
  #
  # Default: $KO_DOCKER_REPO
  repository: ghcr.io/foo/bar

  # Platforms to build and publish.
  #
  # Default: 'linux/amd64'
  platforms:
  - linux/amd64
  - linux/arm64

  # Tag to build and push.
  # Empty tags are ignored.
  #
  # Default: 'latest'
  # Templates: allowed
  tags:
  - latest
  - '{{.Tag}}'
  - '{{if not .Prerelease}}stable{{end}}'

  # Creation time given to the image
  # in seconds since the Unix epoch as a string.
  #
  # Since: v1.17
  # Templates: allowed
  creation_time: '{{.CommitTimestamp}}'

  # Creation time given to the files in the kodata directory
  # in seconds since the Unix epoch as a string.
  #
  # Since: v1.17
  # Templates: allowed
  ko_data_creation_time: '{{.CommitTimestamp}}'

  # SBOM format to use.
  #
  # Default: 'spdx'
  # Valid options are: spdx, cyclonedx, go.version-m and none.
  sbom: none

  # Ldflags to use on build.
  #
  # Default: build.ldflags
  ldflags:
  - foo
  - bar

  # Flags to use on build.
  #
  # Default: build.flags
  flags:
  - foo
  - bar

  # Env to use on build.
  #
  # Default: build.env
  env:
  - FOO=bar
  - SOMETHING=value

  # Bare uses a tag on the $KO_DOCKER_REPO without anything additional.
  bare: true

  # Whether to preserve the full import path after the repository name.
  preserve_import_paths: true

  # Whether to use the base path without the MD5 hash after the repository name.
  base_import_paths: true
```

è¿™æ˜¯ä¸€ä¸ªæœ€å°çš„ä¾‹å­ï¼š

```jsx
# .goreleaser.yml
before:
  hooks:
    - go mod tidy

builds:
  - env: [ "CGO_ENABLED=1" ]
    binary: test
    goos:
    - darwin
    - linux
    goarch:
    - amd64
    - arch64

kos:
  - repository: ghcr.io/caarlos0/test-ko
    tags:
    - '{{.Version}}'
    - latest
    bare: true
    preserve_import_paths: false
    platforms:
    - linux/amd64
    - linux/arm64
```

è¿™å°†ä¸º ã€ å’Œ æ„å»ºäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä»¥åŠ Linux çš„ Docker æ˜ åƒå’Œæ¸…å•ã€‚

## åŒ…çš„å¤§å°

```jsx
# .goreleaser.yaml
# Whether to enable the size reporting or not.
report_sizes: true
```

## MetadataÂ å…ƒæ•°æ®

GoReleaser åœ¨å®Œæˆè¿è¡Œä¹‹å‰ä¼šåœ¨æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€äº›å…ƒæ•°æ®æ–‡ä»¶ã€‚

```jsx
# .goreleaser.yaml
#
metadata:
  # Set the modified timestamp on the metadata files.
  #
  # Templates: allowed.
  mod_timestamp: "{{ .CommitTimestamp }}"
```

## ç­¾åæ ¡éªŒ

GoReleaser æä¾›äº†å¯¹å¯æ‰§è¡Œæ–‡ä»¶å’Œæ¡£æ¡ˆè¿›è¡Œç­¾åçš„æ–¹æ³•ã€‚

ç­¾åä¸æ ¡éªŒå’Œæ–‡ä»¶ç»“åˆä½¿ç”¨ï¼Œé€šå¸¸ä»…å¯¹æ ¡éªŒå’Œæ–‡ä»¶è¿›è¡Œç­¾åå°±è¶³å¤Ÿäº†ã€‚

é»˜è®¤é…ç½®ä¸ºä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¸ºæ ¡éªŒå’Œæ–‡ä»¶åˆ›å»ºç‹¬ç«‹ç­¾å[GnuPG](https://www.gnupg.org/)ï¼Œä»¥åŠæ‚¨çš„é»˜è®¤å¯†é’¥ã€‚è¦å¯ç”¨ç­¾ååªéœ€æ·»åŠ 

```jsx
# .goreleaser.yaml
signs:
  - artifacts: checksum
```

è¦è‡ªå®šä¹‰ç­¾åç®¡é“ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹é€‰é¡¹ï¼š

```jsx
# .goreleaser.yaml
signs:
  -
    # ID of the sign config, must be unique.
    #
    # Default: 'default'
    id: foo

    # Name of the signature file.
    #
    # Default: '${artifact}.sig'
    # Templates: allowed
    signature: "${artifact}_sig"

    # Path to the signature command
    #
    # Default: 'gpg'
    cmd: gpg2

    # Command line arguments for the command
    #
    # to sign with a specific key use
    # args: ["-u", "<key id, fingerprint, email, ...>", "--output", "${signature}", "--detach-sign", "${artifact}"]
    #
    # Default: ["--output", "${signature}", "--detach-sign", "${artifact}"]
    # Templates: allowed
    args: ["--output", "${signature}", "${artifact}", "{{ .ProjectName }}"]

    # Which artifacts to sign
    #
    #   all:      all artifacts
    #   none:     no signing
    #   checksum: only checksum file(s)
    #   source:   source archive
    #   package:  linux packages (deb, rpm, apk)
    #   archive:  archives from archive pipe
    #   binary:   binaries if archiving format is set to binary
    #   sbom:     any Software Bill of Materials generated for other artifacts
    #
    # Default: 'none'
    artifacts: all

    # IDs of the artifacts to sign.
    #
    # If `artifacts` is checksum or source, this fields has no effect.
    ids:
      - foo
      - bar

    # Stdin data to be given to the signature command as stdin.
    #
    # Templates: allowed
    stdin: '{{ .Env.GPG_PASSWORD }}'

    # StdinFile file to be given to the signature command as stdin.
    stdin_file: ./.password

    # Sets a certificate that your signing command should write to.
    # You can later use `${certificate}` or `.Env.certificate` in the `args` section.
    # This is particularly useful for keyless signing (for instance, with cosign).
    # Note that this should be a name, not a path.
    certificate: '{{ trimsuffix .Env.artifact ".tar.gz" }}.pem'

    # List of environment variables that will be passed to the signing command
    # as well as the templates.
    env:
    - FOO=bar
    - HONK=honkhonk

    # By default, the stdout and stderr of the signing cmd are discarded unless
    # GoReleaser is running with `--debug` set.
    # You can set this to true if you want them to be displayed regardless.
    #
    # Since: v1.2
    output: true
```

### å¯ç”¨çš„å˜é‡åç§°

è¿™äº›ç¯å¢ƒå˜é‡å¯èƒ½åœ¨æ¥å—æ¨¡æ¿çš„å­—æ®µä¸­å¯ç”¨ï¼š

- `${artifact}`ï¼šå°†è¢«ç­¾åçš„å·¥ä»¶çš„è·¯å¾„
- `${artifactID}`ï¼šå°†è¢«ç­¾åçš„å·¥ä»¶çš„ID
- `${certificate}`ï¼šè¯ä¹¦æ–‡ä»¶åï¼ˆå¦‚æœæä¾›ï¼‰
- `${signature}`: ç­¾åæ–‡ä»¶å

å‡è®¾ä½ æœ‰ä¸€ä¸ª`cosign.key`åœ¨å­˜å‚¨åº“æ ¹ç›®å½•å’Œ`COSIGN_PWD`ç¯å¢ƒå˜é‡è®¾ç½®ï¼Œä¸€ä¸ªç®€å•çš„ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š

```jsx
# .goreleaser.yaml
signs:
- cmd: cosign
  stdin: '{{ .Env.COSIGN_PWD }}'
  args:
  - "sign-blob"
  - "--key=cosign.key"
  - "--output-signature=${signature}"
  - "${artifact}"
  - "--yes" # needed on cosign 2.0.0+
  artifacts: all
```

ç„¶åï¼Œæ‚¨çš„ç”¨æˆ·å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼éªŒè¯ç­¾åï¼š

`cosign verify-blob -key cosign.pub -signature file.tar.gz.sig file.tar.gz`

## å¯¹ Docker æ˜ åƒå’Œæ¸…å•è¿›è¡Œç­¾å

ä½¿ç”¨ GoReleaser ä¹Ÿå¯ä»¥å¯¹ Docker æ˜ åƒå’Œæ¸…å•è¿›è¡Œç­¾åã€‚è¯¥ç®¡é“æ˜¯æ ¹æ®é€šç”¨æ ‡å¿—ç®¡é“è®¾è®¡çš„ï¼Œå¹¶è€ƒè™‘äº†å…±ç­¾åã€‚

```jsx
# .goreleaser.yml
docker_signs:
  -
    # ID of the sign config, must be unique.
    # Only relevant if you want to produce some sort of signature file.
    #
    # Default: 'default'
    id: foo

    # Path to the signature command
    #
    # Default: 'cosign'
    cmd: cosign

    # Command line arguments for the command
    #
    # Templates: allowed
    # Default: ["sign", "--key=cosign.key", "${artifact}@${digest}", "--yes"]
    args:
    - "sign"
    - "--key=cosign.key"
    - "--upload=false"
    - "${artifact}"
    - "--yes" # needed on cosign 2.0.0+

    # Which artifacts to sign
    #
    #   all:       all artifacts
    #   none:      no signing
    #   images:    only docker images
    #   manifests: only docker manifests
    #
    # Default: 'none'
    artifacts: all

    # IDs of the artifacts to sign.
    ids:
      - foo
      - bar

    # Stdin data to be given to the signature command as stdin.
    #
    # Templates: allowed
    stdin: '{{ .Env.COSIGN_PWD }}'

    # StdinFile file to be given to the signature command as stdin.
    stdin_file: ./.password

    # List of environment variables that will be passed to the signing command as well as the templates.
    env:
    - FOO=bar
    - HONK=honkhonk

    # By default, the stdout and stderr of the signing cmd are discarded unless GoReleaser is running with `--debug` set.
    # You can set this to true if you want them to be displayed regardless.
    #
    # Since: v1.2
    output: true
```

è¿™äº›ç¯å¢ƒå˜é‡å¯èƒ½åœ¨å¯æ¨¡æ¿åŒ–çš„å­—æ®µä¸­å¯ç”¨ï¼š

- `${artifact}`: å°†è¦ç­¾åçš„é¡¹ç›®çš„è·¯å¾„
- `${digest}`: å°†ç­¾åçš„æ˜ åƒ/æ¸…å•çš„æ‘˜è¦
- `${artifactID}`: å°†è¦ç­¾åçš„é¡¹ç›®çš„ ID
- `${certificate}`: è¯ä¹¦æ–‡ä»¶åï¼ˆå¦‚æœæä¾›ï¼‰

## Release

GoReleaser å¯ä»¥ä½¿ç”¨å½“å‰æ ‡ç­¾åˆ›å»º GitHub/GitLab/Gitea ç‰ˆæœ¬ï¼Œä¸Šä¼ æ‰€æœ‰å·¥ä»¶ï¼Œå¹¶æ ¹æ®è‡ªä¸Šä¸€ä¸ªæ ‡ç­¾ä»¥æ¥çš„æ–°æäº¤ç”Ÿæˆæ›´æ”¹æ—¥å¿—ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹ GitHub éƒ¨åˆ†å¯ä»¥è‡ªå®šä¹‰çš„å†…å®¹ï¼š

```jsx
# .goreleaser.yaml
release:
  # Repo in which the release will be created.
  # Default is extracted from the origin remote URL or empty if its private hosted.
  github:
    owner: user
    name: repo

  # IDs of the archives to use.
  # Empty means all IDs.
  #
  # Default: []
  ids:
    - foo
    - bar

  # If set to true, will not auto-publish the release.
  # Available only for GitHub and Gitea.
  #
  # Default: false
  draft: true

  # Whether to remove existing draft releases with the same name before creating
  # a new one.
  # Only effective if `draft` is set to true.
  # Available only for GitHub.
  #
  # Default: false
  # Since: v1.11
  replace_existing_draft: true

  # Useful if you want to delay the creation of the tag in the remote.
  # You can create the tag locally, but not push it, and run GoReleaser.
  # It'll then set the `target_commitish` portion of the GitHub release to the
  # value of this field.
  # Only works on GitHub.
  #
  # Default: ''
  # Since: v1.11
  # Templates: allowed
  target_commitish: "{{ .Commit }}"

  # This allows to change which tag GitHub will create.
  # Usually you'll use this together with `target_commitish`, or if you want to
  # publish a binary from a monorepo into a public repository somewhere, without
  # the tag prefix.
  #
  # Default: '{{ .PrefixedCurrentTag }}'
  # Since: v1.19 (pro)
  # Templates: allowed
  tag: "{{ .CurrentTag }}"

  # If set, will create a release discussion in the category specified.
  #
  # Warning: do not use categories in the 'Announcement' format.
  #  Check https://github.com/goreleaser/goreleaser/issues/2304 for more info.
  #
  # Default is empty.
  discussion_category_name: General

  # If set to auto, will mark the release as not ready for production
  # in case there is an indicator for this in the tag e.g. v1.0.0-rc1
  # If set to true, will mark the release as not ready for production.
  # Default is false.
  prerelease: auto

  # If set to false, will NOT mark the release as "latest".
  # This prevents it from being shown at the top of the release list,
  # and from being returned when calling https://api.github.com/repos/OWNER/REPO/releases/latest.
  #
  # Available only for GitHub.
  #
  # Default is true.
  # Since: v1.20.
  make_latest: true

  # What to do with the release notes in case there the release already exists.
  #
  # Valid options are:
  # - `keep-existing`: keep the existing notes
  # - `append`: append the current release notes to the existing notes
  # - `prepend`: prepend the current release notes to the existing notes
  # - `replace`: replace existing notes
  #
  # Default is `keep-existing`.
  mode: append

  # Header for the release body.
  #
  # Templates: allowed
  header: |
    ## Some title ({{ .Date }})

    Welcome to this new release!

  # Footer for the release body.
  #
  # Templates: allowed
  footer: |
    ## Thanks!

    Those were the changes on {{ .Tag }}!

  # You can change the name of the release.
  #
  # Default: '{{.Tag}}' ('{{.PrefixedTag}}' on Pro)
  # Templates: allowed
  name_template: "{{.ProjectName}}-v{{.Version}} {{.Env.USER}}"

  # You can disable this pipe in order to not create the release on any SCM.
  # Keep in mind that this might also break things that depend on the release
  # URL, for instance, homebrew taps.
  #
  # Templates: allowed (since v1.15)
  disable: true

  # Set this to true if you want to disable just the artifact upload to the SCM.
  # If this is true, GoReleaser will still create the release with the
  # changelog, but won't upload anything to it.
  #
  # Since: v1.11
  # Templates: allowed (since v1.15)
  skip_upload: true

  # You can add extra pre-existing files to the release.
  # The filename on the release will be the last part of the path (base).
  # If another file with the same name exists, the last one found will be used.
  #
  # Templates: allowed
  extra_files:
    - glob: ./path/to/file.txt
    - glob: ./glob/**/to/**/file/**/*
    - glob: ./glob/foo/to/bar/file/foobar/override_from_previous
    - glob: ./single_file.txt
      name_template: file.txt # note that this only works if glob matches 1 file only

  # Additional templated extra files to add to the release.
  # Those files will have their contents pass through the template engine,
  # and its results will be added to the release.
  #
  # Since: v1.17 (pro)
  # This feature is only available in GoReleaser Pro.
  # Templates: allowed
  templated_extra_files:
    - src: LICENSE.tpl
      dst: LICENSE.txt
```

## GPG è®¤è¯

GitHub æ”¯æŒå¤šç§ GPG å…³é”®ç®—æ³•ã€‚å¦‚æœæ‚¨å°è¯•æ·»åŠ ä½¿ç”¨ä¸å—æ”¯æŒçš„ç®—æ³•ç”Ÿæˆçš„å¯†é’¥ï¼Œåˆ™å¯èƒ½ä¼šé‡åˆ°é”™è¯¯ã€‚

### æ£€æŸ¥ç°æœ‰ GPG å¯†é’¥

ä½¿ç”¨è¯¥`gpg --list-secret-keys --keyid-format=long`å‘½ä»¤åˆ—å‡ºæ‚¨æ‹¥æœ‰å…¬é’¥å’Œç§é’¥çš„ GPG å¯†é’¥çš„é•¿æ ¼å¼ã€‚ç­¾ç½²æäº¤æˆ–æ ‡ç­¾éœ€è¦ç§é’¥ã€‚

```jsx
gpg --list-secret-keys --keyid-format=long
```

### ç”Ÿæˆæ–°çš„ GPG å¯†é’¥

é€šè¿‡ git çš„å‚æ•°æ ¡éªŒã€‚é…ç½®ï¼š

```jsx
git config --global gpg.program gpg2
```

**ç”Ÿæˆå¯†é’¥å¯¹ï¼š**

```jsx
gpg --full-generate-key
```

**æ£€æŸ¥å¯†é’¥å¯¹ï¼š**

```jsx
gpg --list-secret-keys --keyid-format=long
```

ä» GPG å¯†é’¥åˆ—è¡¨ä¸­ï¼Œå¤åˆ¶æ‚¨è¦ä½¿ç”¨çš„ GPG å¯†é’¥ ID çš„å®Œæ•´å½¢å¼ã€‚

1. åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼ŒGPG å¯†é’¥ ID ä¸º`3AA5C34371567BD2`ï¼š

   ```
   $ gpg --list-secret-keys --keyid-format=long
   /Users/hubot/.gnupg/secring.gpg
   ------------------------------------
   sec Â  4096R/3AA5C34371567BD2 2016-03-10 [expires: 2017-03-10]
   uid Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   Hubot <hubot@example.com>
   ssb Â  4096R/4BB6D45482678BE3 2016-03-10
   ```

2. ç²˜è´´ä¸‹é¢çš„æ–‡æœ¬ï¼Œå¹¶å°†å…¶æ›¿æ¢ä¸ºæ‚¨è¦ä½¿ç”¨çš„ GPG å¯†é’¥ IDã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼ŒGPG å¯†é’¥ ID ä¸º`3AA5C34371567BD2`ï¼š

   ```
   gpg --armor --export 3AA5C34371567BD2
   # Prints the GPG key ID, in ASCII armor format
   ```

3. å¤åˆ¶æ‚¨çš„ GPG å¯†é’¥ï¼Œä»¥ å¼€å¤´`----BEGIN PGP PUBLIC KEY BLOCK-----`å’Œç»“å°¾`----END PGP PUBLIC KEY BLOCK-----`ã€‚

```jsx
cat /root/.gnupg/openpgp-revocs.d/4DDA37AE0F3AEA3044B33F1B1BAD6F395338EFDE.rev
```

ç„¶åå°±æ˜¯å°†è¿™ä¸ªå¯†é’¥é“¾æ¥åˆ°ä½ çš„ GitHub è´¦æˆ·äº†ã€‚è¿™ä¸ªæ“ä½œå¾ˆç®€å•ï¼Œä¸ä»‹ç»äº†

**å‘Šè¯‰ Git ä½ çš„ç­¾åå¯†é’¥ï¼š**

ä½ è¿˜éœ€è¦å‘Šè¯‰ Git å…³äºä½ çš„ ç­¾å å¯†é’¥ï¼Œå› ä¸º å¦‚æœæ‚¨æœ‰å¤šä¸ª GPG å¯†é’¥ï¼Œåˆ™éœ€è¦å‘Šè¯‰ Git ä½¿ç”¨å“ªä¸€ä¸ªã€‚

1. å¦‚æœæ‚¨ä¹‹å‰å·²å°† Git é…ç½®ä¸ºåœ¨ä½¿ç”¨ è¿›è¡Œç­¾åæ—¶ä½¿ç”¨ä¸åŒçš„å¯†é’¥æ ¼å¼ï¼Œè¯·å–æ¶ˆè®¾ç½®æ­¤é…ç½®ï¼Œä»¥ä¾¿ä½¿ç”¨`-gpg-sign`é»˜è®¤æ ¼å¼ã€‚`openpgp`

   ```
   git config --global --unset gpg.format
   ```

ä½¿ç”¨è¯¥`gpg --list-secret-keys --keyid-format=long`å‘½ä»¤åˆ—å‡ºæ‚¨æ‹¥æœ‰å…¬é’¥å’Œç§é’¥çš„ GPG å¯†é’¥çš„é•¿æ ¼å¼ã€‚ç­¾ç½²æäº¤æˆ–æ ‡ç­¾éœ€è¦ç§é’¥ã€‚

```jsx
gpg --list-secret-keys --keyid-format=long
```

ä» GPG å¯†é’¥åˆ—è¡¨ä¸­ï¼Œå¤åˆ¶æ‚¨è¦ä½¿ç”¨çš„ GPG å¯†é’¥ ID çš„å®Œæ•´å½¢å¼ã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼ŒGPG å¯†é’¥ ID ä¸º`3AA5C34371567BD2`ï¼š

```jsx
$ gpg --list-secret-keys --keyid-format=long
/Users/hubot/.gnupg/secring.gpg
------------------------------------
sec   4096R/3AA5C34371567BD2 2016-03-10 [expires: 2017-03-10]
uid                          Hubot <hubot@example.com>
ssb   4096R/4BB6D45482678BE3 2016-03-10
```

è¦åœ¨ Git ä¸­è®¾ç½®ä¸» GPG ç­¾åå¯†é’¥ï¼Œè¯·ç²˜è´´ä¸‹é¢çš„æ–‡æœ¬ï¼Œå¹¶æ›¿æ¢ä¸ºæ‚¨è¦ä½¿ç”¨çš„ GPG ä¸»å¯†é’¥ IDã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼ŒGPG å¯†é’¥ ID ä¸º`3AA5C34371567BD2`ï¼š

```jsx
git config --global user.signingkey 3AA5C34371567BD2
```

æˆ–è€…ï¼Œåœ¨è®¾ç½®å­é¡¹æ—¶åŒ…å«åç¼€`!`ã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼ŒGPG å­å¯†é’¥ ID ä¸º`4BB6D45482678BE3`ï¼š

```jsx
git config --global user.signingkey 4BB6D45482678BE3!
```

æˆ–è€…ï¼Œè¦å°† Git é…ç½®ä¸ºé»˜è®¤ç­¾ç½²æ‰€æœ‰æäº¤ï¼Œè¯·è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š

```jsx
git config --global commit.gpgsign true
```

+ [å‘Šè¯‰ Git ä½ çš„ SSH å¯†é’¥](https://docs.github.com/en/authentication/managing-commit-signature-verification/telling-git-about-your-signing-key#telling-git-about-your-ssh-key)

æ‚¨å¯ä»¥ä½¿ç”¨ç°æœ‰çš„ SSH å¯†é’¥æ¥ç­¾ç½²æäº¤å’Œæ ‡ç­¾ï¼Œæˆ–ç”Ÿæˆä¸“é—¨ç”¨äºç­¾åçš„æ–°å¯†é’¥ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…â€œ[ç”Ÿæˆæ–°çš„ SSH å¯†é’¥å¹¶å°†å…¶æ·»åŠ åˆ° ssh-agent](https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent)Â â€ã€‚

**æ³¨æ„ï¼š**

æˆ‘ä»¬å¯èƒ½éœ€è¦å°† `export GPG_TTY=$(tty)` æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­

### ç­¾åæ ‡ç­¾

```jsx
$ git tag -s MYTAG
# Creates a signed tag
```

é€šè¿‡è¿è¡ŒéªŒè¯æ‚¨çš„ç­¾åæ ‡ç­¾`git tag -v [tag-name]`ã€‚

```
$ git tag -v MYTAG
# Verifies the signed tag
```

## äº‘å­˜å‚¨æœåŠ¡

å…è®¸æ‚¨å°†å·¥ä»¶ä¸Šä¼ åˆ° Amazon S3ã€Azure Blob å’Œ Google GCSã€‚

å…¶å®ä¸ä»…ä»…æ˜¯è¿™äº›ï¼Œè¿˜æœ‰åŒ…æ‹¬å›½å†…çš„ COS å’Œ CSS

```jsx
# .goreleaser.yaml
blobs:
  # You can have multiple blob configs
  - # Cloud provider name:
    # - s3 for AWS S3 Storage
    # - azblob for Azure Blob Storage
    # - gs for Google Cloud Storage
    #
    # Templates: allowed
    provider: azblob

    # Set a custom endpoint, useful if you're using a minio backend or
    # other s3-compatible backends.
    #
    # Implies s3ForcePathStyle and requires provider to be `s3`
    #
    # Templates: allowed
    endpoint: https://minio.foo.bar

    # Sets the bucket region.
    # Requires provider to be `s3`
    #
    # Templates: allowed
    region: us-west-1

    # Disables SSL
    # Requires provider to be `s3`
    disableSSL: true

    # Bucket name.
    #
    # Templates: allowed
    bucket: goreleaser-bucket

    # IDs of the artifacts you want to upload.
    ids:
      - foo
      - bar

    # Path/name inside the bucket.
    #
    # Default: '{{ .ProjectName }}/{{ .Tag }}'
    # Templates: allowed
    folder: "foo/bar/{{.Version}}"

    # Whether to disable this particular upload configuration.
    #
    # Since: v1.17
    # Templates: allowed
    disable: '{{ neq .BLOB_UPLOAD_ONLY "foo" }}'

    # You can add extra pre-existing files to the bucket.
    # The filename on the release will be the last part of the path (base).
    # If another file with the same name exists, the last one found will be used.
    # These globs can also include templates.
    extra_files:
      - glob: ./path/to/file.txt
      - glob: ./glob/**/to/**/file/**/*
      - glob: ./glob/foo/to/bar/file/foobar/override_from_previous
      - glob: ./single_file.txt
        # Templates: allowed
        name_template: file.txt # note that this only works if glob matches 1 file only

    # Additional templated extra files to uploaded.
    # Those files will have their contents pass through the template engine,
    # and its results will be uploaded.
    #
    # Since: v1.17 (pro)
    # This feature is only available in GoReleaser Pro.
    # Templates: allowed
    templated_extra_files:
      - src: LICENSE.tpl
        dst: LICENSE.txt

  - provider: gs
    bucket: goreleaser-bucket
    folder: "foo/bar/{{.Version}}"
  - provider: s3
    bucket: goreleaser-bucket
    folder: "foo/bar/{{.Version}}"
```

### Fury.io (apt å’Œ rpm å­˜å‚¨åº“ï¼‰

**è¿™æ˜¯ä¸€ä¸ªé«˜çº§åŠŸèƒ½**ï¼Œä½†æ˜¯ sealos ä¹Ÿä½¿ç”¨äº†ï¼Œç”¨çš„æ˜¯ bash é€»è¾‘

æ‚¨å¯ä»¥ä½¿ç”¨ GoReleaser è½»æ¾åœ°åœ¨ fury.io ä¸Šåˆ›å»ºå’Œå­˜å‚¨åº“ã€‚

é¦–å…ˆï¼Œæ‚¨éœ€è¦åœ¨ fury.io ä¸Šåˆ›å»ºä¸€ä¸ªå¸æˆ·å¹¶è·å–æ¨é€ä»¤ç‰Œã€‚

ç„¶åï¼Œæ‚¨éœ€è¦å°†æ‚¨çš„å¸æˆ·åç§°ä¼ é€’ç»™ GoReleaserï¼Œå¹¶å°†æ‚¨çš„æ¨é€ä»¤ç‰Œä½œä¸ºåä¸º `FURY_TOKEN` ï¼š

```jsx
# .goreleaser.yaml
furies:
- account: myaccount
```

è¿™å°†è‡ªåŠ¨ä¸Šä¼ æ‚¨çš„æ‰€æœ‰æ–‡ä»¶ã€‚

**è‡ªå®šä¹‰ï¼š**

```jsx
# goreleaser.yaml

furies:
  -
    # fury.io account.
    # Config is skipped if empty
    account: "{{ .Env.FURY_ACCOUNT }}"

    # Skip the announcing feature in some conditions, for instance, when
    # publishing patch releases.
    # Any value different of 'true' will be considered 'false'.
    #
    # Templates: allowed
    skip: "{{gt .Patch 0}}"

    # Environment variable name to get the push token from.
    # You might want to change it if you have multiple fury configurations for
    # some reason.
    #
    # Default: 'FURY_TOKEN'
    secret_name: MY_ACCOUNT_FURY_TOKEN

    # IDs to filter by.
    # configurations get uploaded.
    ids:
      - packages

    # Formats to upload.
    # Available options are `deb` and `rpm`.
    #
    # Default: ['deb', 'rpm']
    formats:
      - deb
```

## Homebrew Taps

å‘å¸ƒåˆ° GitHubã€GitLab æˆ– Gitea åï¼ŒGoReleaser å¯ä»¥ç”Ÿæˆ *homebrew-tap* å¹¶å°†å…¶å‘å¸ƒåˆ°æ‚¨æœ‰æƒè®¿é—®çš„å­˜å‚¨åº“ä¸­ã€‚

## Announce

GoReleaserè¿˜å¯ä»¥åœ¨ç¤¾äº¤ç½‘ç»œï¼ŒèŠå¤©å®¤å’Œç”µå­é‚®ä»¶ä¸Šå®£å¸ƒæ–°ç‰ˆæœ¬ï¼

å®ƒåœ¨ç®¡é“çš„æœ€æœ«ç«¯è¿è¡Œï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤çš„æ ‡å¿—æˆ–é€šè¿‡ skip å±æ€§è·³è¿‡ï¼š

```jsx
# .goreleaser.yaml
announce:
  # Skip the announcing feature in some conditions, for instance, when
  # publishing patch releases.
  #
  # Any value different from 'true' is evaluated to false.
  #
  # Templates: allowed
  skip: "{{gt .Patch 0}}"
```

### ç›®å‰æ”¯æŒå¾ˆå¤šä¸ªè´¦æˆ·

**Discode:** 

è¦ä½¿ç”¨ Discordï¼Œæ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ª [Webhook](https://support.discord.com/hc/en-us/articles/228383668-Intro-to-Webhooks)ï¼Œå¹¶åœ¨ç®¡é“ä¸Šè®¾ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

- `DISCORD_WEBHOOK_ID`
- `DISCORD_WEBHOOK_TOKEN`

åœ¨æ­¤ä¹‹åï¼Œæ‚¨å¯ä»¥å°†ä»¥ä¸‹éƒ¨åˆ†æ·»åŠ åˆ°æ‚¨çš„é…ç½®ä¸­ï¼š

```jsx
# .goreleaser.yaml
announce:
  discord:
    # Whether its enabled or not.
    enabled: true

    # Message template to use while publishing.
    #
    # Default: '{{ .ProjectName }} {{ .Tag }} is out! Check it out at {{ .ReleaseURL }}'
    # Templates: allowed
    message_template: 'Awesome project {{.Tag}} is out!'

    # Set author of the embed.
    #
    # Default: 'GoReleaser'
    author: ''

    # Color code of the embed. You have to use decimal numeral system, not hexadecimal.
    #
    # Default: '3888754' (the grey-ish from GoReleaser)
    color: ''

    # URL to an image to use as the icon for the embed.
    #
    # Default: 'https://goreleaser.com/static/avatar.png'
    icon_url: ''
```

è¦ä½¿å…¶æ­£å¸¸å·¥ä½œï¼Œæ‚¨éœ€è¦åœ¨ç®¡é“ä¸Šè®¾ç½®ä¸€äº›ç¯å¢ƒå˜é‡ï¼š

- `LINKEDIN_ACCESS_TOKEN`

> We currently don't support posting in groups.

ç„¶åï¼Œæ‚¨å¯ä»¥åœ¨é…ç½®ä¸­æ·»åŠ ç±»ä¼¼ä»¥ä¸‹å†…å®¹çš„å†…å®¹ï¼š

```jsx
# .goreleaser.yaml
announce:
  linkedin:
    # Whether its enabled or not.
    enabled: true

    # Message to use while publishing.
    #
    # Default: '{{ .ProjectName }} {{ .Tag }} is out! Check it out at {{ .ReleaseURL }}'
    message_template: 'Awesome project {{.Tag}} is out!'
```

### slack

å’Œ discode ä¸€æ ·ï¼Œ slack åŒæ ·ä¹Ÿæ˜¯éœ€è¦ä¼ å…¥ä¸€ä¸ªæ–°çš„ `Webhook`

- `SLACK_WEBHOOK`

ç„¶åï¼Œæ‚¨å¯ä»¥åœ¨é…ç½®ä¸­æ·»åŠ ç±»ä¼¼ä»¥ä¸‹å†…å®¹çš„å†…å®¹ï¼š

```jsx
# .goreleaser.yaml
announce:
  slack:
    # Whether its enabled or not.
    enabled: true

    ****# Message template to use while publishing.
    #
    # Default: '{{ .ProjectName }} {{ .Tag }} is out! Check it out at {{ .ReleaseURL }}'
    # Templates: allowed
    message_template: 'Awesome project {{.Tag}} is out!'

    # The name of the channel that the user selected as a destination for webhook messages.
    channel: '#channel'

    # Set your Webhook's user name.
    username: ''

    # Emoji to use as the icon for this message. Overrides icon_url.
    icon_emoji: ''

    # URL to an image to use as the icon for this message.
    icon_url: ''

    # Blocks for advanced formatting, see: https://api.slack.com/messaging/webhooks#advanced_message_formatting
    # and https://api.slack.com/messaging/composing/layouts#adding-blocks.
    #
    # Attention: goreleaser doesn't check the full structure of the Slack API: please make sure that
    # your configuration for advanced message formatting abides by this API.
    #
    # Templates: allowed
    blocks: []

    # Attachments, see: https://api.slack.com/reference/messaging/attachments
    #
    # Attention: goreleaser doesn't check the full structure of the Slack API: please make sure that
    # your configuration for advanced message formatting abides by this API.
    #
    # Templates: allowed
    attachments: []
```

## é“¾æ¥

- [https://docs.docker.com/engine/reference/commandline/manifest/](https://docs.docker.com/engine/reference/commandline/manifest/)



## END é“¾æ¥

<ul><li><div><a href = '85.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—  </a><a href = '87.md' style='float: right'>  ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div></li></ul>

+ [â“‚ï¸å›åˆ°ç›®å½•ğŸ ](../README.md)

+ [**ğŸ«µå‚ä¸è´¡çŒ®ğŸ’â¤ï¸â€ğŸ”¥ğŸ’–**](https://nsddd.top/archives/contributors))

+ âœ´ï¸ç‰ˆæƒå£°æ˜ &copy; ï¼šæœ¬ä¹¦æ‰€æœ‰å†…å®¹éµå¾ª[CC-BY-SA 3.0åè®®ï¼ˆç½²å-ç›¸åŒæ–¹å¼å…±äº«ï¼‰&copy;](http://zh.wikipedia.org/wiki/Wikipedia:CC-by-sa-3.0åè®®æ–‡æœ¬) 
