+ [author(Github)](https://github.com)

# ç¬¬29èŠ‚ algoliaçˆ¬å–å¹¶ä¼˜åŒ–ç½‘ç«™æœç´¢

+ [å›åˆ°ç›®å½•](../README.md)
+ [å›åˆ°é¡¹ç›®é¦–é¡µ](../../README.md)
+ [ä¸Šä¸€èŠ‚](28.md)
> â¤ï¸ğŸ’•ğŸ’•CSè‡ªå­¦æŒ‡å—,å¤§å­¦æ•™è‚²æ— è®ºæ˜¯æ·±åº¦è¿˜æ˜¯å¹¿åº¦éƒ½æ²¡æœ‰åŠæ³•æ”¯æ’‘æˆ‘ä»¬çš„èŒä¸šç´ å…»,è¿™ä¸ªæ¿å—ç®—æ˜¯è‡ªå·±åœ¨CSå­¦ä¹ ä¸­é¢å¤–è¡¥å……å’Œè®°å½•çš„ã€‚ä¸ªäººåšå®¢:[http://nsddd.top](http://nsddd.top/)
---
[TOC]

## ä»€ä¹ˆæ˜¯Algolia

### å®˜ç½‘

+ [algolia](https://www.algolia.com/)

### ä»‹ç»

Algolia ä¸ºæ„å»ºè€…æä¾›æ„å»ºä¸–ç•Œçº§ä½“éªŒæ‰€éœ€çš„æœç´¢å’Œæ¨èæœåŠ¡ã€‚Algolia æ˜¯ä¸€ä¸ªæ•°æ®åº“å®æ—¶æœç´¢æœåŠ¡ï¼Œèƒ½å¤Ÿæä¾›æ¯«ç§’çº§çš„æ•°æ®åº“æœç´¢æœåŠ¡ï¼Œå¹¶ä¸”å…¶æœåŠ¡èƒ½ä»¥ API çš„å½¢å¼æ–¹ä¾¿åœ°å¸ƒå±€åˆ°ç½‘é¡µã€å®¢æˆ·ç«¯ã€APP ç­‰å¤šç§åœºæ™¯ã€‚

Algoliaæ˜¯ä¸€ä¸ªæ‰˜ç®¡æœç´¢å¼•æ“ï¼Œæä¾›å…¨æ–‡ï¼Œæ•°å­—å’Œåˆ†é¢æœç´¢ï¼Œèƒ½å¤Ÿä»ç¬¬ä¸€æ¬¡å‡»é”®æä¾›å®æ—¶ç»“æœã€‚Algoliaå¼ºå¤§çš„APIå¯è®©æ‚¨åœ¨ç½‘ç«™å’Œç§»åŠ¨åº”ç”¨ç¨‹åºä¸­å¿«é€Ÿæ— ç¼åœ°å®æ–½æœç´¢ã€‚æˆ‘ä»¬çš„æœç´¢ API æ¯æœˆä¸ºæ•°åƒå®¶å…¬å¸æä¾›æ•°åäº¿æ¬¡æŸ¥è¯¢æ”¯æŒï¼Œåœ¨ä¸–ç•Œä»»ä½•åœ°æ–¹çš„ 100 æ¯«ç§’å†…å³å¯æä¾›ç›¸å…³ç»“æœã€‚



## ä½¿ç”¨

### ä½¿ç”¨æ’ä»¶

**æ–¹æ³•ï¼š**

```json
npm i -D @vuepress/plugin-docsearch@next
import { docsearchPlugin } from '@vuepress/plugin-docsearch'

export default {
  plugins: [
    docsearchPlugin({
      // é…ç½®é¡¹
    }),
  ],
}
```



ä½ å¯ä»¥é€šè¿‡ `themeConfig.algolia` é€‰é¡¹æ¥ç”¨ [Algolia æœç´¢ (opens new window)](https://community.algolia.com/docsearch/)æ›¿æ¢å†…ç½®çš„æœç´¢æ¡†ã€‚è¦å¯ç”¨ Algolia æœç´¢ï¼Œä½ éœ€è¦è‡³å°‘æä¾› `apiKey` å’Œ `indexName`ï¼š

```js
// .vuepress/config.js
module.exports = {
  themeConfig: {
    algolia: {
      apiKey: '<API_KEY>',
      indexName: '<INDEX_NAME>'
      // å¦‚æœ Algolia æ²¡æœ‰ä¸ºä½ æä¾› `appId` ï¼Œä½¿ç”¨ `BH4D9OD16A` æˆ–è€…ç§»é™¤è¯¥é…ç½®é¡¹
      appId: '<APP_ID>',
    }
  }
}
```

**æ³¨æ„ï¼š**

ä¸åŒäºå¼€ç®±å³ç”¨çš„ [å†…ç½®æœç´¢](https://vuepress.vuejs.org/zh/theme/default-theme-config.html#å†…ç½®æœç´¢)ï¼Œ[Algolia æœç´¢ (opens new window)](https://community.algolia.com/docsearch/)éœ€è¦ä½ åœ¨ä½¿ç”¨ä¹‹å‰å°†ä½ çš„ç½‘ç«™æäº¤ç»™å®ƒä»¬ç”¨äºåˆ›å»ºç´¢å¼•ã€‚



### ä½¿ç”¨çˆ¬è™«

æˆ–è€…ï¼Œä½ ä¹Ÿå¯ä»¥ [è¿è¡Œä½ è‡ªå·±çš„çˆ¬è™«åœ¨æ–°çª—å£æ‰“å¼€](https://docsearch.algolia.com/docs/run-your-own/) æ¥åˆ›å»ºç´¢å¼•ï¼Œç„¶åä½¿ç”¨ä½ è‡ªå·±çš„ [appId](https://v2.vuepress.vuejs.org/zh/reference/plugin/docsearch.html#appId), [apiKey](https://v2.vuepress.vuejs.org/zh/reference/plugin/docsearch.html#apikey) å’Œ [indexName](https://v2.vuepress.vuejs.org/zh/reference/plugin/docsearch.html#indexname) æ¥é…ç½®è¯¥æ’ä»¶ã€‚

```js
new Crawler({
  appId: 'YOUR_APP_ID',
  apiKey: 'YOUR_API_KEY',
  rateLimit: 8,
  startUrls: [
    // è¿™æ˜¯ Algolia å¼€å§‹æŠ“å–ç½‘ç«™çš„åˆå§‹åœ°å€
    // å¦‚æœä½ çš„ç½‘ç«™è¢«åˆ†ä¸ºæ•°ä¸ªç‹¬ç«‹éƒ¨åˆ†ï¼Œä½ å¯èƒ½éœ€è¦åœ¨æ­¤è®¾ç½®å¤šä¸ªå…¥å£é“¾æ¥
    'https://YOUR_WEBSITE_URL/',
  ],
  sitemaps: [
    // å¦‚æœä½ åœ¨ä½¿ç”¨ Sitemap æ’ä»¶ (å¦‚: vuepress-plugin-sitemap2)ï¼Œä½ å¯ä»¥æä¾› Sitemap é“¾æ¥
    'https://YOUR_WEBSITE_URL/sitemap.xml',
  ],
  ignoreCanonicalTo: false,
  exclusionPatterns: [
    // ä½ å¯ä»¥é€šè¿‡å®ƒé˜»æ­¢ Algolia æŠ“å–æŸäº› URL
  ],
  discoveryPatterns: [
    // è¿™æ˜¯ Algolia æŠ“å– URL çš„èŒƒå›´
    'https://YOUR_WEBSITE_URL/**',
  ],
  // çˆ¬è™«æ‰§è¡Œçš„è®¡åˆ’æ—¶é—´ï¼Œå¯æ ¹æ®æ–‡æ¡£æ›´æ–°é¢‘ç‡è®¾ç½®
  schedule: 'at 02:00 every 1 day',
  actions: [
    // ä½ å¯ä»¥æ‹¥æœ‰å¤šä¸ª actionï¼Œç‰¹åˆ«æ˜¯ä½ åœ¨ä¸€ä¸ªåŸŸåä¸‹éƒ¨ç½²å¤šä¸ªæ–‡æ¡£æ—¶
    {
      // ä½¿ç”¨é€‚å½“çš„åç§°ä¸ºç´¢å¼•å‘½å
      indexName: 'YOUR_INDEX_NAME',
      // ç´¢å¼•ç”Ÿæ•ˆçš„è·¯å¾„
      pathsToMatch: ['https://YOUR_WEBSITE_URL/**'],
      // æ§åˆ¶ Algolia å¦‚ä½•æŠ“å–ä½ çš„ç«™ç‚¹
      recordExtractor: ({ $, helpers }) => {
        // @vuepress/theme-default çš„é€‰é¡¹
        return helpers.docsearch({
          recordProps: {
            lvl0: {
              selectors: '.sidebar-heading.active',
              defaultValue: 'Documentation',
            },
            lvl1: '.theme-default-content h1',
            lvl2: '.theme-default-content h2',
            lvl3: '.theme-default-content h3',
            lvl4: '.theme-default-content h4',
            lvl5: '.theme-default-content h5',
            lvl6: '.theme-default-content h6',
            content: '.theme-default-content p, .theme-default-content li',
          },
          indexHeadings: true,
        })
      },
    },
  ],
  initialIndexSettings: {
    // æ§åˆ¶ç´¢å¼•å¦‚ä½•è¢«åˆå§‹åŒ–ï¼Œè¿™ä»…å½“ç´¢å¼•å°šæœªç”Ÿæˆæ—¶æœ‰æ•ˆ
    // ä½ å¯èƒ½éœ€è¦åœ¨ä¿®æ”¹åæ‰‹åŠ¨åˆ é™¤å¹¶é‡æ–°ç”Ÿæˆæ–°çš„ç´¢å¼•
    YOUR_INDEX_NAME: {
      attributesForFaceting: ['type', 'lang'],
      attributesToRetrieve: ['hierarchy', 'content', 'anchor', 'url'],
      attributesToHighlight: ['hierarchy', 'hierarchy_camel', 'content'],
      attributesToSnippet: ['content:10'],
      camelCaseAttributes: ['hierarchy', 'hierarchy_radio', 'content'],
      searchableAttributes: [
        'unordered(hierarchy_radio_camel.lvl0)',
        'unordered(hierarchy_radio.lvl0)',
        'unordered(hierarchy_radio_camel.lvl1)',
        'unordered(hierarchy_radio.lvl1)',
        'unordered(hierarchy_radio_camel.lvl2)',
        'unordered(hierarchy_radio.lvl2)',
        'unordered(hierarchy_radio_camel.lvl3)',
        'unordered(hierarchy_radio.lvl3)',
        'unordered(hierarchy_radio_camel.lvl4)',
        'unordered(hierarchy_radio.lvl4)',
        'unordered(hierarchy_radio_camel.lvl5)',
        'unordered(hierarchy_radio.lvl5)',
        'unordered(hierarchy_radio_camel.lvl6)',
        'unordered(hierarchy_radio.lvl6)',
        'unordered(hierarchy_camel.lvl0)',
        'unordered(hierarchy.lvl0)',
        'unordered(hierarchy_camel.lvl1)',
        'unordered(hierarchy.lvl1)',
        'unordered(hierarchy_camel.lvl2)',
        'unordered(hierarchy.lvl2)',
        'unordered(hierarchy_camel.lvl3)',
        'unordered(hierarchy.lvl3)',
        'unordered(hierarchy_camel.lvl4)',
        'unordered(hierarchy.lvl4)',
        'unordered(hierarchy_camel.lvl5)',
        'unordered(hierarchy.lvl5)',
        'unordered(hierarchy_camel.lvl6)',
        'unordered(hierarchy.lvl6)',
        'content',
      ],
      distinct: true,
      attributeForDistinct: 'url',
      customRanking: [
        'desc(weight.pageRank)',
        'desc(weight.level)',
        'asc(weight.position)',
      ],
      ranking: [
        'words',
        'filters',
        'typo',
        'attribute',
        'proximity',
        'exact',
        'custom',
      ],
      highlightPreTag: '<span class="algolia-docsearch-suggestion--highlight">',
      highlightPostTag: '</span>',
      minWordSizefor1Typo: 3,
      minWordSizefor2Typos: 7,
      allowTyposOnNumericTokens: false,
      minProximity: 1,
      ignorePlurals: true,
      advancedSyntax: true,
      attributeCriteriaComputedByMinProximity: true,
      removeWordsIfNoResults: 'allOptional',
    },
  },
})
```

ä¸Šè¿° `recordProps` æ˜¯ç”¨äºé»˜è®¤ä¸»é¢˜çš„é…ç½®ï¼Œä½ å¯ä»¥æ ¹æ®ä½ ä½¿ç”¨çš„ä¸»é¢˜æ¥ä¿®æ”¹å®ƒä»¬ã€‚

æ³¨æ„ `initialIndexSettings.YOUR_INDEX_NAME.attributesForFaceting` å­—æ®µ**å¿…é¡»**åŒ…å« `'lang'`ï¼Œå¦åˆ™è¯¥æ’ä»¶å°†æ— æ³•æ­£å¸¸å·¥ä½œã€‚



## ä½¿ç”¨çˆ¬è™«çš„æ­¥éª¤

å¦‚æœæ‚¨æƒ³é€šè¿‡æ›´å¼ºçš„æ§åˆ¶åŠ›æ›´æ–°ç»“æœï¼Œæˆ–è€…æ‚¨[ä¸ç¬¦åˆæˆ‘ä»¬çš„æ¸…å•](https://docsearch.algolia.com/docs/who-can-apply)ï¼Œæˆ–è€…æ‚¨çš„ç½‘ç«™ä½äºé˜²ç«å¢™åé¢ï¼Œåˆ™å¯èƒ½éœ€è¦è‡ªå·±è¿è¡Œçˆ¬ç½‘ç¨‹åºã€‚

DocSearchçš„æ•´ä¸ªä»£ç åº“éƒ½æ˜¯å¼€æºçš„ï¼Œæˆ‘ä»¬å°†å…¶æ‰“åŒ…ä¸ºDockeræ˜ åƒï¼Œä»¥ä¾¿æ‚¨æ›´è½»æ¾åœ°ä½¿ç”¨å®ƒã€‚



### ä¸ºä»€ä¹ˆè¦ä½¿ç”¨çˆ¬è™«

> ä½¿ç”¨çˆ¬è™«å°±å¯ä»¥å»é™¤å¾½ç« ï¼Œæ³¨æ„ï¼šå¾½æ ‡å°†è‡ªåŠ¨æ·»åŠ åˆ°ä¸‹æ‹‰åˆ—è¡¨ä¸­ï¼Œå¹¶å¸¦æœ‰é»˜è®¤æ ·å¼ã€‚è¿™æ˜¯æˆ‘ä»¬è®©æ›´å¤šäººäº†è§£æˆ‘ä»¬å·¥ä½œçš„æ–¹å¼ï¼Œä»¥åŠä»–ä»¬å¦‚ä½•ä»å…¶ç½‘ç«™ä¸Šçš„å¿«é€Ÿç›¸å…³æœç´¢ä¸­å—ç›Šã€‚

æ–‡æ¡£æœç´¢æŠ“å–å™¨æ˜¯ç”¨Pythonç¼–å†™çš„ï¼Œå¹¶å—åˆ°[Crapyæ¡†æ¶çš„](https://scrapy.org/)å¯å‘ã€‚å®ƒéå†æ‚¨ç½‘ç«™çš„æ‰€æœ‰é¡µé¢ï¼Œå¹¶ä»HTMLç»“æ„ä¸­æå–å†…å®¹ä»¥å¡«å……Algoliaç´¢å¼•ã€‚

å®ƒä¼šè‡ªåŠ¨è·Ÿéšæ¯ä¸ªå†…éƒ¨é“¾æ¥ï¼Œä»¥ç¡®ä¿æˆ‘ä»¬æ²¡æœ‰é—æ¼ä»»ä½•å†…å®¹ï¼Œå¹¶ä½¿ç”¨HTMLç»“æ„çš„è¯­ä¹‰æ¥æ„å»ºå…¶è®°å½•ã€‚è¿™æ„å‘³ç€ `h1`ï¼Œ`h2` ç­‰ï¼ˆ`selectors`ï¼‰æ ‡é¢˜ç”¨ä½œå±‚æ¬¡ç»“æ„ï¼Œå¹¶ä¸”æ¯ä¸ª `p` éƒ½ç”¨ä½œæ½œåœ¨ç»“æœã€‚

è¿™äº›CSSé€‰æ‹©å™¨å¯ä»¥è¢«è¦†ç›–ï¼Œæ¯ä¸ªç½‘ç«™éƒ½æœ‰è‡ªå·±çš„JSONé…ç½®æ–‡ä»¶ï¼Œæ›´è¯¦ç»†åœ°æè¿°äº†æŠ“å–å™¨çš„è¡Œä¸ºæ–¹å¼ã€‚æ‚¨å¯ä»¥åœ¨[ç›¸å…³éƒ¨åˆ†](https://docsearch.algolia.com/docs/legacy/config-file)æ‰¾åˆ°å®Œæ•´çš„é€‰é¡¹åˆ—è¡¨.

å¦‚æœä½ æƒ³[è‡ªå·±è¿è¡Œæ–‡æ¡£æœç´¢](https://docsearch.algolia.com/docs/legacy/run-your-own)ï¼Œæ‰€æœ‰çš„ä»£ç éƒ½æ˜¯å¼€æºçš„ï¼Œç”šè‡³æ‰“åŒ…æˆä¸€ä¸ª Docker æ˜ åƒã€‚ä¸‹è½½å®ƒï¼Œå¹¶ä½¿ç”¨æ‚¨è‡ªå·±çš„å‡­æ®è¿è¡Œå®ƒã€‚



### è®¾ç½®ç¯å¢ƒ

+ [å‚è€ƒåšå®¢](https://www.imcao.cn/2022/06/24/docsearch/)

æ‚¨éœ€è¦å°†`algolia`åº”ç”¨ç¨‹åº ID å’Œç®¡ç† API å¯†é’¥è®¾ç½®ä¸ºç¯å¢ƒå˜é‡ã€‚å¦‚æœæ‚¨æ²¡æœ‰`algolia`å¸æˆ·ï¼Œåˆ™éœ€è¦[åˆ›å»ºä¸€ä¸ª](https://www.algolia.com/pricing)

+ `APPLICATION_ID`è®¾ç½®ä¸ºæ‚¨çš„é˜¿å°”æˆˆåˆ©äºšåº”ç”¨ç¨‹åº ID
+ `API_KEY`è®¾ç½®ä¸ºæ‚¨çš„ API å¯†é’¥ã€‚è¯·ç¡®ä¿ä½¿ç”¨å¯¹ç´¢å¼•å…·æœ‰**å†™å…¥**è®¿é—®æƒé™çš„ API å¯†é’¥ã€‚å®ƒéœ€è¦ [ACL addObjectã€editSettingså’ŒdeleteIndex](https://www.algolia.com/doc/guides/security/api-keys/#acl).

åˆ›å»ºå®Œç´¢å¼•åï¼Œæ¥åˆ°è®¾ç½®â€”â€”API Keys è·å– `Application ID` å’Œ `Admin API Key`ã€‚åˆ›å»º `.env` æ–‡ä»¶ï¼Œå°†ä¸¤ä¸ªå‚æ•°å¡«å…¥ã€‚

![image-20221015105658692](http://sm.nsddd.top/smimage-20221015105658692.png?xxw@nsddd.top)

ä¸ºæ–¹ä¾¿èµ·è§ï¼Œæ‚¨å¯ä»¥åœ¨å­˜å‚¨åº“æ ¹ç›®å½•ä¸­åˆ›å»º`.env` æ–‡ä»¶ã€‚

```sh
APPLICATION_ID=LIPIDXUN7V
API_KEY=e0bc57bb5910bb4cbaff54471af173d4
```

é…ç½®å®Œ APIï¼Œæ¥ä¸‹å»éœ€è¦é…ç½®çˆ¬è™«çš„é€‰é¡¹ã€‚åˆ›å»º `config.json` æ–‡ä»¶ï¼Œå¯¹äº VuePress å¯ä»¥ç”¨ä»¥ä¸‹é…ç½®ï¼Œä¿®æ”¹ `index_name` ä¸ºä¹‹å‰åˆ›å»ºçš„ç´¢å¼•åç§°ï¼Œ`start_urls` ä¸ºç½‘ç«™çš„é¦–é¡µåœ°å€ï¼Œå…¶ä½™é€‰é¡¹å¯ä¿æŒé»˜è®¤ã€‚

```json
{
  "index_name": "docker.nsddd.top",
  "start_urls": [{ "url": "https://docker.nsddd.top/", "variables": { "lang": ["zh-CN"] } }],
  "selectors": {
    "lvl0": ".sidebar-heading.active",
    "lvl1": ".theme-default-content h1",
    "lvl2": ".theme-default-content h2",
    "lvl3": ".theme-default-content h3",
    "lvl4": ".theme-default-content h4",
    "lvl5": ".theme-default-content h5",
    "lvl6": ".theme-default-content h6",
    "text": ".theme-default-content p, .theme-default-content li"
  },
  "initialIndexSettings": {
    "attributesForFaceting": ["type", "lang"],
    "attributesToRetrieve": ["hierarchy", "content", "anchor", "url"],
    "attributesToHighlight": ["hierarchy", "hierarchy_camel", "content"],
    "attributesToSnippet": ["content:10"],
    "camelCaseAttributes": ["hierarchy", "hierarchy_radio", "content"],
    "searchableAttributes": [
      "unordered(hierarchy_radio_camel.lvl0)",
      "unordered(hierarchy_radio.lvl0)",
      "unordered(hierarchy_radio_camel.lvl1)",
      "unordered(hierarchy_radio.lvl1)",
      "unordered(hierarchy_radio_camel.lvl2)",
      "unordered(hierarchy_radio.lvl2)",
      "unordered(hierarchy_radio_camel.lvl3)",
      "unordered(hierarchy_radio.lvl3)",
      "unordered(hierarchy_radio_camel.lvl4)",
      "unordered(hierarchy_radio.lvl4)",
      "unordered(hierarchy_radio_camel.lvl5)",
      "unordered(hierarchy_radio.lvl5)",
      "unordered(hierarchy_radio_camel.lvl6)",
      "unordered(hierarchy_radio.lvl6)",
      "unordered(hierarchy_camel.lvl0)",
      "unordered(hierarchy.lvl0)",
      "unordered(hierarchy_camel.lvl1)",
      "unordered(hierarchy.lvl1)",
      "unordered(hierarchy_camel.lvl2)",
      "unordered(hierarchy.lvl2)",
      "unordered(hierarchy_camel.lvl3)",
      "unordered(hierarchy.lvl3)",
      "unordered(hierarchy_camel.lvl4)",
      "unordered(hierarchy.lvl4)",
      "unordered(hierarchy_camel.lvl5)",
      "unordered(hierarchy.lvl5)",
      "unordered(hierarchy_camel.lvl6)",
      "unordered(hierarchy.lvl6)",
      "content"
    ]
  }
}
```



### ä½¿ç”¨dockeré•œåƒæ‹‰å–å¹¶ä¸”è¿è¡Œçˆ¬è™«

æ‚¨å¯ä»¥ä»æ‰“åŒ…çš„ Docker æ˜ åƒè¿è¡Œçˆ¬ç½‘æ¥æŠ“å–æ‚¨çš„ç½‘ç«™ã€‚æ‚¨å°†éœ€è¦[å®‰è£… jqï¼Œè¿™æ˜¯ä¸€ä¸ªè½»é‡çº§å‘½ä»¤è¡Œ JSON å¤„ç†å™¨](https://github.com/stedolan/jq/wiki/Installation)

+ [x] [ä¸ºäº†å­¦jqï¼Œæˆ‘ç‰¹æ„å¼€äº†ä¸€ä¸ªç« èŠ‚ï¼Œå°±æ˜¯ä¸‹ä¸€èŠ‚](./30.md)

> **centosä¸€è¡Œå‘½ä»¤å°±èƒ½æå®šï¼š**
>
> ```
> yum install jq
> ```
>
> **ç”¨ Dockerfile ç›´æ¥å®‰è£…å‘å¸ƒäºŒè¿›åˆ¶æ–‡ä»¶ï¼š**
>
> ```dockerfile
> ENV JQ_VERSION='1.5'
> 
> RUN wget --no-check-certificate https://raw.githubusercontent.com/stedolan/jq/master/sig/jq-release.key -O /tmp/jq-release.key && \
>     wget --no-check-certificate https://raw.githubusercontent.com/stedolan/jq/master/sig/v${JQ_VERSION}/jq-linux64.asc -O /tmp/jq-linux64.asc && \
>     wget --no-check-certificate https://github.com/stedolan/jq/releases/download/jq-${JQ_VERSION}/jq-linux64 -O /tmp/jq-linux64 && \
>     gpg --import /tmp/jq-release.key && \
>     gpg --verify /tmp/jq-linux64.asc /tmp/jq-linux64 && \
>     cp /tmp/jq-linux64 /usr/bin/jq && \
>     chmod +x /usr/bin/jq && \
>     rm -f /tmp/jq-release.key && \
>     rm -f /tmp/jq-linux64.asc && \
>     rm -f /tmp/jq-linux64
> ```



ç„¶åï¼Œæ‚¨éœ€è¦æ ¹æ®æ‚¨çš„é…ç½®å¯åŠ¨çˆ¬ç½‘ã€‚æ‚¨åº”è¯¥æŸ¥çœ‹ä¸“ç”¨çš„[é…ç½®æ–‡æ¡£](https://docsearch.algolia.com/docs/legacy/config-file).

```sh
docker run -it --env-file=.env -e "CONFIG=$(cat ./config.json | jq -r tostring)" algolia/docsearch-scraper
```

> æˆ‘æˆåŠŸçš„æ ·å­å¤šé…·ï¼Ÿ
>
> ![image-20221015163350747](http://sm.nsddd.top/smimage-20221015163350747.png?xxw@nsddd.top)

æŠ“å–å®Œæˆåï¼Œæ‚¨å¯ä»¥[è·³è½¬åˆ°é›†æˆæ­¥éª¤](https://docsearch.algolia.com/docs/legacy/run-your-own/#integration)ã€‚

![image-20221015163552627](http://sm.nsddd.top/smimage-20221015163552627.png?xxw@nsddd.top)



### ä¿®æ”¹vuepressé…ç½®æ–‡ä»¶

**å®‰è£…æ’ä»¶ï¼š**

```
npm i -D @vuepress/plugin-docsearch@next
```



**å¯¼å…¥æ’ä»¶ï¼š**

> hugoç­‰å…¶ä»–çš„æ¡†æ¶å‚è€ƒå¯¹åº”çš„æ’ä»¶ï¼Œæˆ‘ä»¬åœ¨vuepressé…ç½®æ–‡ä»¶ä¸­å¯¼å…¥ä¸‹é¢çš„å†…å®¹
>
> **å…³é”®å­—ï¼š**
>
> apiKey
>
> + ç±»å‹ï¼š `string`
>
> + æ˜¯å¦å¿…éœ€ï¼š `true`
>
> + è¯¦æƒ…ï¼š
>
>   ä» DocSearch å›¢é˜Ÿæ”¶åˆ°çš„ `apiKey` ï¼Œæˆ–è€…ç”±ä½ è‡ªå·±ç”Ÿæˆã€‚
>
> + å‚è€ƒï¼š
>
>   + [DocSearch > Options > apiKeyåœ¨æ–°çª—å£æ‰“å¼€](https://docsearch.algolia.com/docs/api#apikey)
>
> [#](https://v2.vuepress.vuejs.org/zh/reference/plugin/docsearch.html#indexname)indexName
>
> + ç±»å‹ï¼š `string`
>
> + æ˜¯å¦å¿…éœ€ï¼š `true`
>
> + è¯¦æƒ…ï¼š
>
>   ä» DocSearch å›¢é˜Ÿæ”¶åˆ°çš„ `indexName` ï¼Œæˆ–è€…ç”±ä½ è‡ªå·±ç”Ÿæˆã€‚
>
> + å‚è€ƒï¼š
>
>   + [DocSearch > Options > indexNameåœ¨æ–°çª—å£æ‰“å¼€](https://docsearch.algolia.com/docs/api#indexname)
>
> [#](https://v2.vuepress.vuejs.org/zh/reference/plugin/docsearch.html#appid)appId
>
> + ç±»å‹ï¼š `string`
>
> + æ˜¯å¦å¿…éœ€ï¼š `true`
>
> + è¯¦æƒ…ï¼š
>
>   ç”¨äºè®¾ç½®ä½ çš„ Application IDã€‚
>
> + å‚è€ƒï¼š
>
>   + [DocSearch > Options > appIdåœ¨æ–°çª—å£æ‰“å¼€](https://docsearch.algolia.com/docs/api#appid)
>
> [#](https://v2.vuepress.vuejs.org/zh/reference/plugin/docsearch.html#searchparameters)searchParameters
>
> + ç±»å‹ï¼š `SearchParameters`
>
> + è¯¦æƒ…ï¼š
>
>   Algolia æœç´¢ API å‚æ•°ã€‚
>
> + å‚è€ƒï¼š
>
>   + [DocSearch > Options > searchParametersåœ¨æ–°çª—å£æ‰“å¼€](https://docsearch.algolia.com/docs/api/#searchparameters)
>   + [Algolia > Search API Parametersåœ¨æ–°çª—å£æ‰“å¼€](https://www.algolia.com/doc/api-reference/search-api-parameters/)
>
> [#](https://v2.vuepress.vuejs.org/zh/reference/plugin/docsearch.html#placeholder)placeholder
>
> + ç±»å‹ï¼š `string`
>
> + é»˜è®¤å€¼ï¼š `'Search docs'`
>
> + è¯¦æƒ…ï¼š
>
>   æœç´¢è¾“å…¥æ¡†çš„ placeholder å±æ€§ã€‚
>
> + å‚è€ƒï¼š
>
>   + [DocSearch > Options > placeholderåœ¨æ–°çª—å£æ‰“å¼€](https://docsearch.algolia.com/docs/api#placeholder)
>
> [#](https://v2.vuepress.vuejs.org/zh/reference/plugin/docsearch.html#disableuserpersonalization)disableUserPersonalization
>
> + ç±»å‹ï¼š `boolean`
>
> + é»˜è®¤å€¼ï¼š `false`
>
> + è¯¦æƒ…ï¼š
>
>   æ˜¯å¦ç¦ç”¨æ‰€æœ‰çš„ä¸ªæ€§åŒ–åŠŸèƒ½ï¼šæœ€è¿‘çš„æœç´¢ã€æ”¶è—çš„æœç´¢ç»“æœç­‰ã€‚
>
> + å‚è€ƒï¼š
>
>   + [DocSearch > Options > disableUserPersonalizationåœ¨æ–°çª—å£æ‰“å¼€](https://docsearch.algolia.com/docs/api#disableuserpersonalization)
>
> [#](https://v2.vuepress.vuejs.org/zh/reference/plugin/docsearch.html#initialquery)initialQuery
>
> + ç±»å‹ï¼š `string`
>
> + è¯¦æƒ…ï¼š
>
>   æ‰“å¼€å¼¹çª—æ—¶çš„åˆå§‹è¯·æ±‚ã€‚
>
> + å‚è€ƒï¼š
>
>   + [DocSearch > Options > initialQueryåœ¨æ–°çª—å£æ‰“å¼€](https://docsearch.algolia.com/docs/api#initialquery)
>
> [#](https://v2.vuepress.vuejs.org/zh/reference/plugin/docsearch.html#translations)translations
>
> + ç±»å‹ï¼š `Partial<DocSearchTranslations>`
>
> + è¯¦æƒ…ï¼š
>
>   å…è®¸æ›¿æ¢ DocSearch æŒ‰é’®å’Œå¼¹çª—å†…çš„é»˜è®¤æ–‡å­—ã€‚
>
> + å‚è€ƒï¼š
>
>   + [DocSearch > Options > translationsåœ¨æ–°çª—å£æ‰“å¼€](https://docsearch.algolia.com/docs/api/#translations)
>
> [#](https://v2.vuepress.vuejs.org/zh/reference/plugin/docsearch.html#locales)locales
>
> + ç±»å‹ï¼š `Record<string, DocsearchPluginOptions>`
>
> + è¯¦æƒ…ï¼š
>
>   åœ¨ä¸åŒ locales ä¸‹å¯¹è¯¥æ’ä»¶è¿›è¡Œä¸åŒçš„é…ç½®ã€‚
>
>   è¯¥æ’ä»¶çš„æ‰€æœ‰å…¶ä»–é€‰é¡¹éƒ½å¯ä»¥åœ¨ locale ä¸­è¿›è¡Œé…ç½®ã€‚

**é…ç½®**

> æ³¨æ„é…ç½®æ–‡ä»¶ä¸­çš„apiåœ°å€ï¼š
>
> ![image-20221015210955407](http://sm.nsddd.top/smimage-20221015210955407.png?xxw@nsddd.top)

```json
 docsearchPlugin({
      apiKey: "661a2d8409a1b3e5ae62094dca33f10d",
      appId: "LIPIDXUN7V",
      indexName: "docker.nsddd.top",
      searchParameters: {
        attributesToSnippet: ["lvl1:30", "content:25"],
      },
      locales: {
        "/": {
          placeholder: "æœç´¢æ–‡æ¡£",
          translations: {
            button: {
              buttonText: "æœç´¢æ–‡æ¡£",
              buttonAriaLabel: "æœç´¢æ–‡æ¡£",
            },
            modal: {
              searchBox: {
                resetButtonTitle: "æ¸…é™¤æŸ¥è¯¢æ¡ä»¶",
                resetButtonAriaLabel: "æ¸…é™¤æŸ¥è¯¢æ¡ä»¶",
                cancelButtonText: "å–æ¶ˆ",
                cancelButtonAriaLabel: "å–æ¶ˆ",
              },
              startScreen: {
                recentSearchesTitle: "æœç´¢å†å²",
                noRecentSearchesText: "æ²¡æœ‰æœç´¢å†å²",
                saveRecentSearchButtonTitle: "ä¿å­˜è‡³æœç´¢å†å²",
                removeRecentSearchButtonTitle: "ä»æœç´¢å†å²ä¸­ç§»é™¤",
                favoriteSearchesTitle: "æ”¶è—",
                removeFavoriteSearchButtonTitle: "ä»æ”¶è—ä¸­ç§»é™¤",
              },
              errorScreen: {
                titleText: "æ— æ³•è·å–ç»“æœ",
                helpText: "ä½ å¯èƒ½éœ€è¦æ£€æŸ¥ä½ çš„ç½‘ç»œè¿æ¥",
              },
              footer: {
                selectText: "é€‰æ‹©",
                navigateText: "åˆ‡æ¢",
                closeText: "å…³é—­",
                searchByText: "æœç´¢æä¾›è€…",
              },
              noResultsScreen: {
                noResultsText: "æ— æ³•æ‰¾åˆ°ç›¸å…³ç»“æœ",
                suggestedQueryText: "ä½ å¯ä»¥å°è¯•æŸ¥è¯¢",
                reportMissingResultsText: "ä½ è®¤ä¸ºè¯¥æŸ¥è¯¢åº”è¯¥æœ‰ç»“æœï¼Ÿ",
                reportMissingResultsLinkText: "ç‚¹å‡»åé¦ˆ",
              },
            },
          },
        },
      },
    }),
```



### æ ·å¼

ä½ å¯ä»¥é€šè¿‡ [@docsearch/cssåœ¨æ–°çª—å£æ‰“å¼€](https://docsearch.algolia.com/docs/styling) æä¾›çš„ CSS å˜é‡æ¥è‡ªå®šä¹‰æ ·å¼ï¼š

```css
:root {
  --docsearch-primary-color: rgb(84, 104, 255);
  --docsearch-text-color: rgb(28, 30, 33);
  --docsearch-spacing: 12px;
  --docsearch-icon-stroke-width: 1.4;
  --docsearch-highlight-color: var(--docsearch-primary-color);
  --docsearch-muted-color: rgb(150, 159, 175);
  --docsearch-container-background: rgba(101, 108, 133, 0.8);
  --docsearch-logo-color: rgba(84, 104, 255);

  /* modal */
  --docsearch-modal-width: 560px;
  --docsearch-modal-height: 600px;
  --docsearch-modal-background: rgb(245, 246, 247);
  --docsearch-modal-shadow: inset 1px 1px 0 0 rgba(255, 255, 255, 0.5), 0 3px
      8px 0 rgba(85, 90, 100, 1);

  /* searchbox */
  --docsearch-searchbox-height: 56px;
  --docsearch-searchbox-background: rgb(235, 237, 240);
  --docsearch-searchbox-focus-background: #fff;
  --docsearch-searchbox-shadow: inset 0 0 0 2px var(--docsearch-primary-color);

  /* hit */
  --docsearch-hit-height: 56px;
  --docsearch-hit-color: rgb(68, 73, 80);
  --docsearch-hit-active-color: #fff;
  --docsearch-hit-background: #fff;
  --docsearch-hit-shadow: 0 1px 3px 0 rgb(212, 217, 225);

  /* key */
  --docsearch-key-gradient: linear-gradient(
    -225deg,
    rgb(213, 219, 228) 0%,
    rgb(248, 248, 248) 100%
  );
  --docsearch-key-shadow: inset 0 -2px 0 0 rgb(205, 205, 230), inset 0 0 1px 1px
      #fff, 0 1px 2px 1px rgba(30, 35, 90, 0.4);

  /* footer */
  --docsearch-footer-height: 44px;
  --docsearch-footer-background: #fff;
  --docsearch-footer-shadow: 0 -1px 0 0 rgb(224, 227, 232), 0 -3px 6px 0 rgba(69, 98, 155, 0.12);
}
```



### å®‰è£…

scraper æ˜¯ä¸€ä¸ª[åŸºäº scrapy](https://scrapy.org/)çš„ python å·¥å…·ã€‚æˆ‘ä»¬æ¨èä½¿ç”¨[pipenv](https://github.com/pypa/pipenv)æ¥å®‰è£… python ç¯å¢ƒã€‚

+ [å…‹éš†scraperå­˜å‚¨åº“](https://github.com/algolia/docsearch-scraper)ã€‚
+ [å®‰è£… pipenv](https://pipenv.readthedocs.io/en/latest/install/#installing-pipenv)
+ `pipenv install`
+ `pipenv shell`

```bash
git clone https://github.com/algolia/docsearch-scraper
pip install --user pipenv
pipenv install
pipenv shell
```

å¦‚æœè®¡åˆ’ä½¿ç”¨æµè§ˆå™¨ä»¿çœŸ[ï¼ˆjs_renderè®¾ç½®ä¸º trueï¼‰ï¼Œ](https://docsearch.algolia.com/docs/legacy/config-file)åˆ™éœ€è¦æ‰§è¡Œæ­¤é¢å¤–æ­¥éª¤ã€‚å¦‚æœä¸è¿™æ ·åšï¼Œåˆ™å¯ä»¥å…³é—­æ­¤æ­¥éª¤ã€‚



### å®‰è£…æµè§ˆå™¨é©±åŠ¨ç¨‹åº

æŸäº›ç½‘ç«™å‘ˆç°éœ€è¦è„šæœ¬ã€‚æˆ‘ä»¬çš„å±¥å¸¦ä¾èµ–äºæ— å¤´é•€é“¬ä»¿çœŸã€‚æ‚¨éœ€è¦è®¾ç½®ä¸€ä¸ªæµè§ˆå™¨é©±åŠ¨ç¨‹åºã€‚

+ [å®‰è£…é€‚åˆæ‚¨çš„](http://chromedriver.chromium.org/getting-started)æ“ä½œç³»ç»Ÿå’Œ Chrome ç‰ˆæœ¬çš„é©±åŠ¨ç¨‹åºã€‚æˆ‘ä»¬å»ºè®®ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ã€‚
+ åœ¨ `.env` `CHROMEDRIVER_PATH`ç¯å¢ƒå˜é‡CHROMEDRIVER_PATHã€‚æ­¤è·¯å¾„å¿…é¡»ä»¥ä¸‹è½½çš„è§£å‹ç¼©é©±åŠ¨ç¨‹åºä¸ºç›®æ ‡ã€‚

ä½ å‡†å¤‡å¥½äº†ã€‚



### è¿è¡Œçˆ¬ç½‘ç¨‹åº

è¿è¡Œ`pipenv shell`å°†å¯ç”¨æ‚¨çš„è™šæ‹Ÿç¯å¢ƒã€‚ä»é‚£é‡Œï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿è¡Œä¸€ä¸ªçˆ¬ç½‘ï¼š

```sh
./docsearch run /path/to/your/config.json
```

æˆ–è€…ä» Docker æ˜ åƒä¸­ï¼š

```sh
./docsearch docker:run /path/to/your/config.json
```

è¿™å°†å¯åŠ¨çˆ¬ç½‘ã€‚å®ƒä»è§£æçš„é¡µé¢ä¸­æå–å†…å®¹ï¼Œå¹¶å°†æ„å»ºçš„è®°å½•æ¨é€åˆ°Algoliaã€‚



## åˆ›å»ºæ–°é…ç½®

è¦åˆ›å»ºé…ç½®ï¼Œè¯·è¿è¡Œ `./docsearch bootstrap`ã€‚æç¤ºå°†è¦æ±‚æ‚¨æä¾›ä¸€äº›ä¿¡æ¯ï¼Œå¹¶å°†åˆ›å»ºå¯ç”¨ä½œåŸºç¡€çš„ JSON é…ç½®ã€‚

```sh
$ ./docsearch bootstrap
# Enter your documentation url
start url: http://www.example.com/docs/
# Pick another name, or press enter
index_name is example [enter to confirm]: <Enter>

=================
{
  "index_name": "example",
  "start_urls": [
    "http://www.example.com/docs/"
  ],
  "stop_urls": [],
  "selectors": {
    "lvl0": "FIXME h1",
    "lvl1": "FIXME h2",
    "lvl2": "FIXME h3",
    "lvl3": "FIXME h4",
    "lvl4": "FIXME h5",
    "lvl5": "FIXME h6",
    "text": "FIXME p, FIXME li"
  }
}
=================
```

å°†æ­¤æ–‡æœ¬åˆ›å»ºä¸€ä¸ªæ–‡ä»¶åˆ°æ–‡ä»¶å `example.json` ä¸­ï¼Œæˆ‘ä»¬ç¨åå°†ä½¿ç”¨å®ƒæ¥å¯åŠ¨çˆ¬ç½‘ã€‚æ‚¨å¯ä»¥æµè§ˆ[å®æ—¶é…ç½®åˆ—è¡¨](https://github.com/algolia/docsearch-configs/tree/master/configs).



## æµ‹è¯•ç»“æœ

æ‚¨å¯ä»¥é€šè¿‡è¿è¡Œ `./docsearch playground`æ¥æµ‹è¯•ç»“æœã€‚è¿™å°†æ‰“å¼€ä¸€ä¸ªåŒ…å«æœç´¢è¾“å…¥çš„ç½‘é¡µã€‚æ‚¨å¯ä»¥é’ˆå¯¹ç´¢å¼•ç»“æœæ‰§è¡Œå®æ—¶æµ‹è¯•ã€‚

![image-20221014231247963](http://sm.nsddd.top/smimage-20221014231247963.png?xxw@nsddd.top)

è¯·æ³¨æ„ï¼Œå¦‚æœå‘½ä»¤å¤±è´¥ï¼ˆå®ƒå¯èƒ½å‘ç”Ÿåœ¨é Mac è®¡ç®—æœºä¸Šï¼‰ï¼Œåˆ™å¯ä»¥é€šè¿‡åœ¨ `./playground` å­ç›®å½•ä¸­è¿è¡Œå®æ—¶æœåŠ¡å™¨æ¥è·å¾—ç›¸åŒçš„ç»“æœã€‚



## é›†æˆ

ä¸€æ—¦æ‚¨å¯¹é…ç½®æ„Ÿåˆ°æ»¡æ„ï¼Œå°±å¯ä»¥æŒ‰ç…§[æ­¤å¤„çš„è¯´æ˜](https://docsearch.algolia.com/docs/legacy/dropdown)å°†ä¸‹æ‹‰èœå•é›†æˆåˆ°æ‚¨çš„ç½‘ç«™ä¸­.

ä¸åŒä¹‹å¤„åœ¨äºï¼Œæ‚¨è¿˜å¿…é¡»å°† `appId` å¯†é’¥æ·»åŠ åˆ°`docsearch()` å®ä¾‹ä¸­ã€‚å¦å¤–ï¼Œä¸è¦å¿˜è®°åœ¨æ­¤å¤„ä½¿ç”¨**æœç´¢** API å¯†é’¥ï¼ˆæ¢å¥è¯è¯´ï¼Œä¸æ˜¯ç”¨äºçˆ¬ç½‘çš„**å†™å…¥** API å¯†é’¥ï¼‰ã€‚

```javascript
docsearch({
  appId: '<APP_ID>', // Add your own Application ID
  apiKey: '<API_KEY>', // Set it to your own *search* API key
  [â€¦] // Other parameters are the same
});
```



## å¸®åŠ©

æ‚¨å¯ä»¥åœ¨æ²¡æœ‰ä»»ä½•å‚æ•°çš„æƒ…å†µä¸‹è¿è¡Œ `./docsearch` æ¥æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤çš„åˆ—è¡¨ã€‚

è¯·æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨***Algolia***å†…éƒ¨ä½¿ç”¨æ­¤å‘½ä»¤è¡Œå·¥å…·æ¥è¿è¡Œå…è´¹æ‰˜ç®¡ç‰ˆæœ¬ï¼Œå› æ­¤æ‚¨å¯èƒ½ä¸éœ€è¦æ‰€æœ‰åˆ—å‡ºçš„å‘½ä»¤ã€‚

## END é“¾æ¥
+ [å›åˆ°ç›®å½•](../README.md)
+ [ä¸Šä¸€èŠ‚](28.md)
+ [ä¸‹ä¸€èŠ‚](30.md)
---
+ [å‚ä¸è´¡çŒ®â¤ï¸ğŸ’•ğŸ’•](https://github.com/3293172751/Block_Chain/blob/master/Git/git-contributor.md)